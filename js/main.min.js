function sendClientError(t){Net.send(GameEvent.sys.client_error,{msg:UM.gameid+":"+t},null,!1)}var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(a,r){function o(t){try{h(n.next(t))}catch(e){r(e)}}function s(t){try{h(n["throw"](t))}catch(e){r(e)}}function h(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(o,s)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(a)throw new TypeError("Generator is already executing.");for(;h;)try{if(a=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,r=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],r=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,r,o,s,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},game;!function(t){var e=function(t){function e(e){var i=t.call(this)||this;return e&&(i.skinName=e),i}return __extends(e,t),e.prototype.childrenCreated=function(){},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),i.id=e,i instanceof eui.Image?e.toLowerCase().indexOf("btn")>-1||(i.touchEnabled=!1):i instanceof eui.Label&&(i.touchEnabled=!1)},e.prototype.setHtml=function(t,e){t.textFlow=(new egret.HtmlTextParser).parser(e)},e.prototype.addBtnEvent=function(t,e,i){t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,e,i||this);var n=(t.id||"").toLocaleLowerCase();(-1!=n.indexOf("btn")||-1!=n.indexOf("button"))&&SoundManager.getInstance().addBtnClickEffect(t)},e.prototype.createHtml=function(t,e,i){return MyTool.createHtml(t,e,i)},e.prototype.removeBtnEvent=function(t,e,i){t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e,i||this)},e.prototype.clearList=function(t){var e=t;t instanceof eui.List&&(e=[t]);for(var i in e)try{e[i].dataProvider=null,e[i].dataProviderRefreshed()}catch(n){}this.validateNow()},e}(eui.Component);t.BaseContainer=e,__reflect(e.prototype,"game.BaseContainer");var i=function(t){function e(e){var i=t.call(this)||this;return i.isStartLoad=!1,i.BaseTypeList=[],i.isInitUI=!0,i.sizeList=[],i.isWindow=!1,i.noMV=!1,i.isHideFlag=!0,i.canBGClose=!1,i.loadData=null,i.loadUI=null,i.hideBehind=!0,i.showFinishFunList=[],i.panelEvents={},i.isWindow=e,i.isWindow||GameManager.stage.addEventListener(egret.Event.RESIZE,i.onResize,i),i}return __extends(e,t),e.prototype.childrenCreated=function(){this.isInitUI=!0,this.isWindow||this.onResize(null)},e.prototype.createComplete=function(t){this.removeEventListener(egret.Event.ENTER_FRAME,this.createComplete,this),this._arguments?this.onShow.apply(this,this._arguments):this.onShow(),this.runShowFinish()},e.prototype.runShowFinish=function(){for(;this.showFinishFunList.length>0;)this.showFinishFunList.shift()()},e.prototype.addShowFinishFun=function(t){this.showFinishFunList.push(t)},e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i)},e.prototype.addPanelOpenEvent=function(t,e){this.panelEvents[t]=e,EM.addEvent(t,e,this)},e.prototype.addListenerSizeY=function(t){for(;t.length>0;)this.sizeList.push({ui:t.pop(),type:"y"})},e.prototype.addListenerSizeH=function(t){for(;t.length>0;)this.sizeList.push({ui:t.pop(),type:"h"})},e.prototype.resizeFun=function(){},e.prototype.onVisibleChange=function(){},e.prototype.onResize=function(t){this.height=GameManager.uiHeight;for(var e=0;e<this.sizeList.length;e++);this.scrollRect=new egret.Rectangle(0,0,GameManager.uiWidth,GameManager.uiHeight),this.y=(GameManager.stage.stageHeight-GameManager.uiHeight)/2,this.parent&&this.resizeFun()},e.prototype.cacheFunArguments=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._arguments=t},e.prototype.onShow=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this},e.prototype.show=function(){if(this.LoadFiles&&this.LoadFiles.length>0){if(this.isStartLoad)return;return this.isStartLoad=!0,LoadingFile.getInstance().loadGroup(this.LoadFiles,this.showFun,this,this.loadUI,this.loadData),void(this.LoadFiles=[])}return this.showFun(),this},e.prototype.showFun=function(){if(this.isStartLoad=!1,this.BaseTypeList)for(var t=0;t<this.BaseTypeList.length;t++){var i=this.BaseTypeList[t];e.UIshowList[i]||(e.UIshowList[i]=[]),-1==e.UIshowList[i].indexOf(this)&&e.UIshowList[i].push(this)}PopUpManager.addPopUp(this,this.isWindow,this.noMV),this.isInitUI&&(this.isHideFlag=!1,this._arguments?this.onShow.apply(this,this._arguments):this.onShow(),this.runShowFinish()),e.setStopEevent()},e.prototype.isHide=function(){return this.isHideFlag},e.prototype.hide=function(){this.beforeHide();for(var t in this.panelEvents)EM.removeEvent(t,this.panelEvents[t],this);if(this.BaseTypeList)for(var i=0;i<this.BaseTypeList.length;i++){var n=this.BaseTypeList[i],a=e.UIshowList[n];if(a)for(var r=a.length-1;r>=0;r--)a[r]==self&&a.splice(r,1)}return this.isHideFlag=!0,PopUpManager.removePopUp(this),this},e.prototype.onAddToStage=function(t){console.log(222)},Object.defineProperty(e,"isStopEevent",{get:function(){return Date.now()-e.openTime<400},enumerable:!0,configurable:!0}),e.setStopEevent=function(){e.openTime=Date.now()},e.prototype.paySound=function(t,e){},e.prototype.beforeHide=function(){},e.UIshowList={},e.hideType=function(t){var i=e.UIshowList[t];if(i)for(var n=i.length-1;n>=0;n--)i[n].hide()},e}(t.BaseContainer);t.BaseUI=i,__reflect(i.prototype,"game.BaseUI");var n=function(t){function e(){var e=t.call(this,!0)||this;return e.canBGClose=!0,e}return __extends(e,t),e.prototype.setTitle=function(t,e){var i=this.getChildAt(0);i.setTitle(t),e&&i.setBottomHeight(e)},e}(t.BaseUI);t.BaseWindow=n,__reflect(n.prototype,"game.BaseWindow");var a=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.partAdded=function(e,i){t.prototype.partAdded.call(this,e,i),i.id=e,i instanceof eui.Image?e.toLowerCase().indexOf("btn")>-1||(i.touchEnabled=!1):i instanceof eui.Label&&(i.touchEnabled=!1)},e.prototype.setHtml=function(t,e){t.textFlow=(new egret.HtmlTextParser).parser(e)},e.prototype.addBtnEvent=function(t,e,i){if(t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,e,this),!i){var n=(t.id||"").toLocaleLowerCase();(-1!=n.indexOf("btn")||-1!=n.indexOf("button"))&&SoundManager.getInstance().addBtnClickEffect(t)}},e.prototype.createHtml=function(t,e,i){return MyTool.createHtml(t,e,i)},e.prototype.removeBtnEvent=function(t,e,i){t.removeEventListener(egret.TouchEvent.TOUCH_TAP,e,i||this)},e}(eui.ItemRenderer);t.BaseItem=a,__reflect(a.prototype,"game.BaseItem")}(game||(game={}));var MainPKUI=function(t){function e(){var e=t.call(this)||this;return e.finish=!1,e.lastRota=0,e.skinName="MainPKUISkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=PKVideoCon.getInstance();this.con.addChild(e),e.y=0,e.x=-(PKConfig.floorWidth+2*PKConfig.appearPos-640)/2},e.prototype.show=function(t){this.visible||(this.showData=t,this.visible=!0,this.finish=!1,this.winGroup.visible=!1,this.failGroup.visible=!1,PKVideoCon.getInstance().x=-(PKConfig.floorWidth+2*PKConfig.appearPos-640)/2,this.reset(),this.addEventListener(egret.Event.ENTER_FRAME,this.onStep,this),this.dispatchEventWith("visible_change"))},e.prototype.hide=function(){this.visible=!1,this.removeEventListener(egret.Event.ENTER_FRAME,this.onStep,this),PKVideoCon.getInstance().remove(),PKManager.getInstance().testSendResult(),this.dispatchEventWith("visible_change")},e.prototype.reView=function(){this.showData.passTime=0,this.reset()},e.prototype.reset=function(){var t={seed:this.showData.seed,players:[{id:1,gameid:"team1",team:1,force:this.showData.force1,hp:1,autolist:this.showData.list1},{id:2,gameid:"team2",team:2,force:this.showData.force2,hp:1,autolist:this.showData.list2}]};PKBulletManager.getInstance().freeAll();var e=PKData.getInstance();if(e.init(t),this.showData.passTime&&this.showData.passTime>0&&(e.quick=!0,e.quickTime=1e3*this.showData.passTime),PKVideoCon.getInstance().init(this.showData),e.start(),this.onStep(),e.isGameOver){PKVideoCon.getInstance().resetView();var i=PKVideoCon.getInstance(),n=e.getPKResult();if(1==n)var a=PKData.getInstance().getFirstItem(PKData.getInstance().myPlayer.teamData.id),r=PKData.getInstance().getBackItem(PKData.getInstance().myPlayer.teamData.id);else if(2==n)var a=PKData.getInstance().getFirstItem(PKData.getInstance().myPlayer.teamData.enemy.id),r=PKData.getInstance().getBackItem(PKData.getInstance().myPlayer.teamData.enemy.id);else var a=PKData.getInstance().getFirstItem(PKData.getInstance().myPlayer.teamData.id),r=PKData.getInstance().getFirstItem(PKData.getInstance().myPlayer.teamData.enemy.id);if(a&&r){var o=640,s=-((a.x+r.x)/2-o/2);s>0?s=0:s<o-i.width&&(s=o-i.width),i.x=s}}},e.prototype.onStep=function(){if(this.finish)return void PKVideoCon.getInstance().action();var t=PKData.getInstance(),e=PKCode.getInstance();if(e.onStep(),PKVideoCon.getInstance().action(),t.isGameOver){this.finish=!0,PKBulletManager.getInstance().freeAll();var i=t.getPKResult();if(this.showData.key&&(PKManager.getInstance().pkResult[this.showData.key]=t.getPKResult()),3==i)this.delayShowResult(this.failGroup),this.failText.text="平手，庄家通吃";else if(this.showData.cost1||this.showData.cost2)if(this.showData["cost"+i]){var n=PKManager.getInstance().getAddCoin(this.showData,i);this.winText.text="胜利",this.delayShowResult(this.winGroup),this.showData.isMain?this.des1.text="等待到帐":this.des1.text="恭喜获得",this.winText.text="x"+NumberUtil.addNumSeparator(n)}else this.delayShowResult(this.failGroup),this.failText.text="失败";else this.delayShowResult(this.winGroup),this.winText.text=i+"队获胜",this.desGroup.visible=!1;PKManager.getInstance().testSendResult()}else{var a=PKData.getInstance().getFirstItem(PKData.getInstance().myPlayer.teamData.id),r=PKData.getInstance().getFirstItem(PKData.getInstance().myPlayer.teamData.enemy.id);if(a&&r){var o=PKVideoCon.getInstance(),s=640,h=-((a.x+r.x)/2-s/2);h>0?h=0:h<s-o.width&&(h=s-o.width);var c=Math.abs(o.x-h),l=o.x>h?1:-1;if(c>80||this.lastRota==l){if(egret.Tween.removeTweens(o),c>10){var u=egret.Tween.get(o);u.to({x:h},Math.min(300,10*c))}else o.x=h;this.lastRota=l}}}},e.prototype.delayShowResult=function(t){var e=this;setTimeout(function(){t.visible=!0,t.scaleX=t.scaleY=0;var i=egret.Tween.get(t).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},300);e.showData.isMain&&e.showData.key!=PKManager.getInstance().getCurrentKey()&&i.wait(2e3).call(function(){e.hide()})},1e3)},e}(game.BaseItem);__reflect(MainPKUI.prototype,"MainPKUI");var TeamUI=function(t){function e(){var e=t.call(this)||this;return e.monsterArr=[],e.lastTalk=0,e.skinName="TeamUISkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this.addBtn1,this.onClick1),this.addBtnEvent(this.addBtn10,this.onClick10),this.addBtnEvent(this.addBtn100,this.onClick100),this.addBtnEvent(this.addBtn1000,this.onClick1000),this.addBtnEvent(this.con,this.onMClick)},e.prototype.onMClick=function(t){for(var e=t.stageX,i=t.stageY,n=this.monsterArr.length-1;n>=0;n--){var a=this.monsterArr[n];if(a.currentMV.hitTestPoint(e,i,!0)){console.log(a.id);break}}},e.prototype.onClick1=function(){this.addCost(1)},e.prototype.onClick10=function(){this.addCost(10)},e.prototype.onClick100=function(){this.addCost(100)},e.prototype.onClick1000=function(){this.addCost(1e3)},e.prototype.addCost=function(t){UM.coin<t||(1==this.teamID?(UM.lastGuess.cost1+=t,UM.lastGuess.teamCost1+=t):(UM.lastGuess.cost2+=t,UM.lastGuess.teamCost2+=t),AddCoinItem.showMV(t,this),PKManager.getInstance().costChange=!0,UM.addCoin(-t),PKManager.getInstance().callSendCost(),GameUI.getInstance().onTimer())},e.prototype.randomTalk=function(){if(!(Math.random()>.5)){var t=this.monsterArr[Math.floor(this.monsterArr.length*Math.random())];if(t&&!t.talkItm){if(egret.getTimer()<this.lastTalk)return;t.talk(),this.lastTalk=egret.getTimer()+3e3+Math.floor(2e3*Math.random())}}},e.prototype.showList=function(t){for(;this.monsterArr.length>0;)PKMonsterMV.freeItem(this.monsterArr.pop());for(var e=Math.min(500/(t.length-1),80),i=(640-e*(t.length-1))/2,n=0;n<t.length;n++){var a=t[n],r=MonsterVO.getObject(a),o=PKMonsterMV.createItem();this.con.addChild(o),o.load(a),o.stand(),o.scaleX=o.scaleY=1.2,o.bottom=80+1.2*r.height,o.w=r.width,o.x=i+n*e,this.monsterArr.push(o)}ArrayUtil.sortByField(this.monsterArr,["bottom","w"],[1,1]);for(var n=0;n<this.monsterArr.length;n++)this.con.addChild(this.monsterArr[n]);this.bg.source=PKManager.getInstance().getPKBG()},e.prototype.renewCost=function(t){var e=PKManager.getInstance();if(1==this.teamID)var i=t.cost1+UM.lastGuess.teamCost1,n=t.cost2+UM.lastGuess.teamCost2,a=UM.lastGuess.cost1;else var i=t.cost2+UM.lastGuess.teamCost2,n=t.cost1+UM.lastGuess.teamCost1,a=UM.lastGuess.cost2;this.addBtn1.skinName=UM.coin>=1?"Btn1Skin":"Btn3Skin",this.addBtn10.skinName=UM.coin>=10?"Btn1Skin":"Btn3Skin",this.addBtn100.skinName=UM.coin>=100?"Btn1Skin":"Btn3Skin",this.addBtn1000.skinName=UM.coin>=1e3?"Btn1Skin":"Btn3Skin",this.setHtml(this.totalText,this.createHtml("总投资：",16764044)+NumberUtil.addNumSeparator(parseInt(i))),this.setHtml(this.myText,this.createHtml("我的：",16764044)+this.createHtml(NumberUtil.addNumSeparator(a),a>0?65280:16777215));var r=e.getMoneyRate(i,n);this.setHtml(this.rateText,this.createHtml("赔率：",16764044)+this.createHtml(r+"%",r>150?65280:16777215));var o=e.getForceAdd(i);o?(this.forceGroup.addChild(this.addGroup),this.forceText1.text="+"+o+"）"):MyTool.removeMC(this.addGroup),this.forceText.text="战力："+(1e4+o)},e}(game.BaseItem);__reflect(TeamUI.prototype,"TeamUI");var PKStateListener=function(){function t(t){this.endTime=0,this.mvID=0,this.stopDieRemove=!1,this.x=0}return t.prototype.actionFun=function(t){},t.prototype.onRemove=function(){},t}();__reflect(PKStateListener.prototype,"PKStateListener");var MBase=function(){function t(){this.type="monster"}return t.getData=function(t){if(!this.baseData[t]){var e=this.getClass(t);this.baseData[t]=new e,this.baseData[t].id=t}return this.baseData[t]},t.getClass=function(t){switch(t){case 1:return M1;case 2:return M2;case 3:return M3;case 4:return M4;case 5:return M5;case 6:return M6;case 7:return M7;case 8:return M8;case 9:return M9;case 10:return M10;case 11:return M11;case 12:return M12;case 13:return M13;case 14:return M14;case 15:return M15;case 16:return M16;case 17:return M17;case 18:return M18;case 31:return M31;case 32:return M32;case 33:return M33;case 34:return M34;case 35:return M35;case 36:return M36;case 37:return M37;case 38:return M38;case 39:return M39;case 40:return M40;case 41:return M41;case 42:return M42;case 43:return M43;case 44:return M44;case 45:return M45;case 46:return M46;case 47:return M47;case 48:return M48;case 61:return M61;case 62:return M62;case 63:return M63;case 64:return M64;case 65:return M65;case 66:return M66;case 67:return M67;case 68:return M68;case 69:return M69;case 70:return M70;case 71:return M71;case 72:return M72;case 73:return M73;case 74:return M74;case 75:return M75;case 76:return M76;case 77:return M77;case 78:return M78}},t.prototype.isHeroSkillCDOK=function(t,e){var i=t.skillTemp["hs"+e]||0,n=t.getVO().getHeroSkill(e).skillcd;return 102==t.mid&&t.level>=5&&(n=1e3*t.getVO().getHeroSkillValue(5,1)),PKData.getInstance().actionTime>i+n?!0:!1},t.prototype.setHeroSkillUse=function(t,e,i){t.skillTemp["hs"+e]=Math.max(i||PKData.getInstance().actionTime,t.skillTemp["hs"+e]||0)},t.prototype.onHpChange=function(t){},t.prototype.onCreate=function(t){},t.prototype.onDie=function(t){},t.prototype.onRemove=function(t){},t.prototype.onBuff=function(t){},t.prototype.beAtkAction=function(t,e){},t.prototype.onKill=function(t,e){},t.prototype.preload=function(){this.mvID1&&AtkMVCtrl.getInstance().preLoadMV(this.mvID1),this.mvID2&&AtkMVCtrl.getInstance().preLoadMV(this.mvID2),this.mvID3&&AtkMVCtrl.getInstance().preLoadMV(this.mvID3)},t.prototype.initMonster=function(t){},t.prototype.getSkillTarget=function(t){return[]},t.prototype.getSkillArriveCD=function(t,e){return 0},t.prototype.skillMV=function(t,e,i,n){AtkMVCtrl.getInstance().mSkillMV(this.id,t,e,i,n)},t.prototype.skill=function(t,e){},t.prototype.getAtkTargets=function(t){return[t.target]},t.prototype.getAtkArriveCD=function(t,e){return 0},t.prototype.atkMV=function(t,e,i,n){AtkMVCtrl.getInstance().mAtkMV(this.id,t,e,i,n)},t.prototype.skillBefore=function(t,e){for(var i=e+this.getAtkMVCD(t),n=t.skillTargets,a=0;a<n.length;a++)this.sendSkillBefore(t,n[a],e,i)},t.prototype.skillAction=function(t,e,i){var n=i+this.getSkillArriveCD(t,e);this.sendSkillAction(t,e,i,n)},t.prototype.atkBefore=function(t,e){for(var i=e+this.getAtkMVCD(t),n=this.getAtkTargets(t),a=0;a<n.length;a++)this.sendAtkBefore(t,n[a],e,i)},t.prototype.getAtkMVCD=function(t){return t.getAtkBeforeCD()},t.prototype.atkAction=function(t,e,i){var n=i+this.getAtkArriveCD(t,e);t.doubleRate&&PKData.getInstance().random()<t.doubleRate?(t.doubleAction=!0,PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_DOUBLE,user:t,value:t.atk*t.doubleValue})):t.doubleAction=!1,this.sendAtkAction(t,e,i,n)},t.prototype.atk=function(t,e){if(!t.doubleAction&&e.missRate&&PKData.getInstance().random()<e.missRate)return e.die?!1:(PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_MISS,user:e}),!1);var i=this.getAtkHp(t,e);return e.beAtkAction({hp:i,atker:t}),t.atkAction({hp:i}),!0},t.prototype.getAtkerAtk=function(t,e){var i=t.atk*t.getAtkRate(e);return t.doubleAction&&(i*=t.doubleValue),Math.ceil(i)},t.prototype.getAtkHp=function(t,e){var i=this.getAtkerAtk(t,e),n=e.getOwner().teamData.getTeamDef(),a=Math.floor(i*Math.max(1-(e.def+n)/100,0));return 1>a&&(a=1),Math.ceil(a)},t.prototype.sendAtkBefore=function(t,e,i,n){PKMonsterAction.getInstance().addAtkList({type:"atk_before",model:this,user:t,target:e,actionTime:i,endTime:n})},t.prototype.sendSkillBefore=function(t,e,i,n){PKMonsterAction.getInstance().addAtkList({type:"skill_before",model:this,user:t,target:e,actionTime:i,endTime:n})},t.prototype.sendAtkAction=function(t,e,i,n){PKMonsterAction.getInstance().addAtkList({type:"atk",user:t,target:e,actionTime:i,endTime:n}),PKData.getInstance().quick||this.atkMV(t,e,i,n)},t.prototype.sendSkillAction=function(t,e,i,n){PKMonsterAction.getInstance().addAtkList({type:"skill",user:t,target:e,actionTime:i,endTime:n}),PKData.getInstance().quick||this.skillMV(t,e,i,n)},t.baseData={},t}();__reflect(MBase.prototype,"MBase");var M7=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.doubleValue=t.getSkillValue(2)/100},e.prototype.atkAction=function(e,i,n){e.getHpRate()<e.getSkillValue(1)/100&&(e.doubleRate=1),t.prototype.atkAction.call(this,e,i,n),e.doubleRate=0},e}(MBase);__reflect(M7.prototype,"M7");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function a(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var h=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Config=function(){function t(){}return t.init=function(){},t.createImg=function(t,e){return void 0===e&&(e=""),{name:t.replace(".","_"),type:"image",url:e+t}},t.createJSON=function(t,e){return void 0===e&&(e=""),{name:t.replace(".","_"),type:"json",url:e+t}},t.initURLRequest=function(){var t=location.hash||location.search||"",e=location.hash?"#":"?";if(-1!=t.indexOf(e))for(var i=t.substr(1),n=i.split("&"),a=0;a<n.length;a++)_get[n[a].split("=")[0]]=decodeURIComponent(n[a].split("=")[1])},t.isDebug=!0,t.userHost="hangegame.com",t.host="hangegame.com",t.pkServerHost="172.17.196.195",t.pkServerPose=9029,t.serverID=1,t.user_version=1,t.version=1,t.displayVersion="1.0.0",t.pk_version=1,t.cdn="",t.localResRoot="resource/game_assets/",t.slaveLevel=10,t.activeLevel=20,t.pvpLevel=15,t.heroLevel=50,t.platform="",t.platformGameidAdd="",t.equalValue=1e3,t}();__reflect(Config.prototype,"Config");var _get=function(){function t(){}return t}();__reflect(_get.prototype,"_get");var GameEvent=function(){function t(){}return t.client={COIN_CHANGE:"COIN_CHANGE",INFO_CHANGE:"INFO_CHANGE",red_change:"red_change",pass_day:"pass_day",timer:"timer",timerE:"timerE"},t.sys={login:"login",client_error:"sys.client_error"},t.game={buy_skin:"game.buy_skin",create_rank:"rank.create_rank",get_rank2:"rank.get_rank2"},t.rank={get_rank:"rank.get_rank",create_rank:"rank.create_rank",get_rank2:"rank.get_rank2"},t}();__reflect(GameEvent.prototype,"GameEvent");var MovieSimpleMC=function(t){function e(e,i,n,a){var r=t.call(this)||this;return r.current=0,r.sleepFrame=0,r.icon=e,r.setList(i),r.sleepFrame=a||0,r.currSleep=0,r.timeID=new egret.Timer(n||42,0),r.timeID.addEventListener(egret.TimerEvent.TIMER,r.updateTime,r),r}return __extends(e,t),Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.timeID.running},enumerable:!0,configurable:!0}),e.prototype.setList=function(t){this.list=t,this.max=t.length},e.prototype.play=function(){return 1==this.list.length?(this.icon.source=this.list[0],void this.stop()):(this.currSleep=0,this.timeID.start(),this)},e.prototype.stop=function(){this.timeID.stop()},e.prototype.gotoAndPlay=function(t){void 0===t&&(t=0),this.current=t,this.isOnce=!1,this.times=0,this.icon.source=this.list[this.current],this.play()},e.prototype.gotoAndPlayOnce=function(t){void 0===t&&(t=0),this.current=t,this.isOnce=!0,this.times=0,this.icon.source=this.list[this.current],this.play()},e.prototype.gotoAndPlayTimes=function(t){void 0===t&&(t=1),this.current=0,this.isOnce=!1,this.times=t,this.icon.source=this.list[this.current],this.play()},e.prototype.updateTime=function(){return 0!=this.sleepFrame&&this.currSleep>0?void(++this.currSleep==this.sleepFrame&&(this.currSleep=0)):(this.icon.source=this.list[this.current],void(++this.current==this.max&&(this.current=0,this.currSleep=1,this.isOnce?(this.dispatchEventWith("complete"),this.stop()):this.times>0&&(this.times--,0==this.times&&(this.dispatchEventWith("complete"),this.stop())))))},e.prototype.dispose=function(){this.stop()},e.prototype.setAutoDispose=function(){this.icon.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.dispose,this)},e}(egret.EventDispatcher);__reflect(MovieSimpleMC.prototype,"MovieSimpleMC");var MovieSimpleMC2=function(t){function e(){var e=t.call(this)||this;return e.current=0,e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.setData=function(t,e,i,n,a,r){return this.icon=t,"string"==typeof t&&(this.icon=new eui.Image(t)),this.addChild(this.icon),this.iconWidth=e,this.iconHeight=i,this.max=n,this.timeID||(this.timeID=new egret.Timer(a||42,0),this.timeID.addEventListener(egret.TimerEvent.TIMER,this.updateTime,this)),this.playTimes=r||0,this.isLoop=0==this.playTimes?!0:!1,this.reSet(),this},e.prototype.reSetSource=function(t){this.icon&&(this.icon.source=t)},e.prototype.setXY=function(t){t.x&&(this.x=t.x),t.y&&(this.y=t.y),t.scaleX&&(this.scaleX=t.scaleX),t.scaleY&&(this.scaleY=t.scaleY)},e.prototype.play=function(){this.timeID.start()},e.prototype.stop=function(){this.timeID.stop()},e.prototype.reSet=function(){this.now_playTimes=0},e.prototype.gotoAndPay=function(t){this.current=t-1,this.icon.scrollRect=new egret.Rectangle(this.current*this.iconWidth,0,this.iconWidth,this.iconHeight),this.play()},e.prototype.gotoAndStop=function(t){this.current=t-1,this.icon.scrollRect=new egret.Rectangle(this.current*this.iconWidth,0,this.iconWidth,this.iconHeight)},e.prototype.updateTime=function(){this.icon.scrollRect=new egret.Rectangle(this.current*this.iconWidth,0,this.iconWidth,this.iconHeight),++this.current==this.max&&(this.current=0,this.isLoop||++this.now_playTimes==this.playTimes&&(this.stop(),this.dispatchEventWith("stop")))},e.prototype.dispose=function(){this.stop(),this.timeID.removeEventListener(egret.TimerEvent.TIMER,this.updateTime,this),this.timeID=null},e}(egret.DisplayObjectContainer);__reflect(MovieSimpleMC2.prototype,"MovieSimpleMC2");var MyTimer=function(t){function e(e){var i=t.call(this)||this;return i.cd=0,i.lastTime=0,i.cd=e,i.timer=new egret.Timer(e),i.timer.addEventListener(egret.TimerEvent.TIMER,i.onE,i),i}return __extends(e,t),e.prototype.onE=function(){for(var t=Math.floor((egret.getTimer()-this.lastTime)/this.cd);t--;)this.dispatchEventWith(egret.TimerEvent.TIMER),this.lastTime+=this.cd},e.prototype.start=function(){this.timer.start(),this.lastTime=egret.getTimer()},e.prototype.stop=function(){this.timer.stop()},e}(egret.EventDispatcher);__reflect(MyTimer.prototype,"MyTimer");var MyTool=function(){function t(){}return t.getRes=function(t,e){return void 0===e&&(e=!0),e?"stage2/images/"+t:t},t.clearList=function(t){t.dataProvider=null,t.dataProviderRefreshed(),t.validateNow()},t.renewList=function(t){for(var e=0;e<t.numChildren;e++)t.getChildAt(e).dataChanged()},t.runListFun=function(t,e){for(var i=0;i<t.numChildren;i++)t.getChildAt(i)[e]()},t.removeMC=function(t){t&&t.parent&&t.parent.removeChild(t)},t.upMC=function(t){t&&t.parent&&t.parent.addChild(t)},t.getDis=function(t,e){return Math.pow(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2),.5)},t.getMiddleXY=function(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}},t.addColor=function(t,e){if(-1==e)return void(t.filters=null);var i=.8,n=35,a=35,r=2,o=3,s=!1,h=!1,c=new egret.GlowFilter(e,i,n,a,r,o,s,h);t.filters=[c]},t.changeGray=function(t,e,i){if(void 0===e&&(e=!0),i&&(t.touchChildren=t.touchEnabled=!e),!e)return void(t.filters=null);var n=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],a=new egret.ColorMatrixFilter(n);t.filters=[a]},t.setImgSource=function(t,e){t.source!=e&&(t.visible=!1,t.once(egret.Event.COMPLETE,this.onImgComplete,this),t.source=e)},t.onImgComplete=function(t){t.currentTarget.visible=!0},t.toFixed=function(t,e){for(var i=t.toFixed(e),n=i.charAt(i.length-1);("0"==n||"."==n)&&(i=i.substr(0,i.length-1),"."!=n);)n=i.charAt(i.length-1);return i},t.resetScrollV=function(t){if(t.viewport.scrollV<0)t.viewport.scrollV=0;else{if(!(t.viewport.scrollV+t.viewport.height>t.viewport.contentHeight))return;t.viewport.scrollV=Math.max(0,t.viewport.contentHeight-t.viewport.height)}t.stopAnimation()},t.getValueChangeArray=function(t,e,i,n){void 0===n&&(n=!1);for(var a=[],r=0;i>r;r++){var o=t+(e-t)/i*(r+1);n||(o=Math.floor(o)),a.push(o)}return a},t.addLongTouch=function(t,e,i){function n(t){var n=t.stageX,o=t.stageY;GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_END,a,i),GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,a,i),GameManager.stage.once(egret.TouchEvent.TOUCH_END,a,i),GameManager.stage.once(egret.TouchEvent.TOUCH_CANCEL,a,i),clearTimeout(r),r=setTimeout(function(){return Math.abs(GameManager.stageX-n)>20||Math.abs(GameManager.stageY-o)>20?(GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_END,a,i),void GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,a,i)):void e.apply(i)},400)}function a(t){GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_END,a,i),GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,a,i),clearTimeout(r)}var r;t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n,i)},t.addDoubleTouch=function(t,e,i){function n(t){egret.getTimer()-a<500&&(t.stopPropagation(),e.apply(i)),a=egret.getTimer()}t.addEventListener(egret.TouchEvent.TOUCH_TAP,n,i,!1,100);var a=-1},t.setHtml=function(t,e){t.textFlow=(new egret.HtmlTextParser).parser(e)},t.setColorText=function(t,e,i){i=i||"#FFDE93",e=e.replace(/\[/g,'<font color="'+i+'">'),e=e.replace(/\]/g,"</font>"),this.setHtml(t,e)},t.myHitTest=function(t,e,i){var n=t.localToGlobal(0,0),a=t.localToGlobal(t.width,t.height);return n.x<e&&e<a.x&&n.y<i&&i<a.y},t.changeToChinese=function(t){for(var e=String(t),i=["","一","二","三","四","五","六","七","八","九"],n=["十","百","千","万"],a="",r=e.split(""),o=0,s=r.length-1;s>=0;s--)a=i[r[s]]+a,0!=s&&(a=n[o]+a,o++);return a},t.addTestBlock=function(t){var e=new egret.Sprite;return t.addChild(e),e.graphics.beginFill(0),e.graphics.drawRect(0,0,10,10),e.graphics.endFill(),e},t.str2Num=function(t){var e=t.charCodeAt(0);return 58>e?e-48:91>e?e-55:e-61},t.replaceEmoji=function(t){var e=["�[�-�]","�[�-�]","�[�-�]"];return t.replace(new RegExp(e.join("|"),"g"),"")},t.getBtnPath=function(t){if(!t)return"";var e=[];for(t.id&&e.push(t.id);t.parent;)t.parent.id?e.unshift(t.parent.id):t.parent.skinName&&e.unshift(t.parent.skinName),t=t.parent;return e.join(".")},t.refresh=function(){location.reload()},t.createHtml=function(t,e,i){var n="";return void 0!=e&&(n+='color="'+e+'"'),void 0!=i&&(n+=' size="'+i+'"'),"<font "+n+">"+t+"</font>"},t.stopClick=function(t){GameManager.container.touchChildren=GameManager.container.touchEnabled=!1,setTimeout(function(){GameManager.container.touchChildren=GameManager.container.touchEnabled=Net.getInstance().modeNum<=0},t)},t.getSector=function(t,e,i,n,a,r){void 0===t&&(t=100),void 0===e&&(e=0),void 0===i&&(i=360),void 0===n&&(n=16711680),void 0===a&&(a=1),r||(r=new egret.Shape);var o=0,s=0;r.graphics.clear(),r.graphics.beginFill(n,a),r.graphics.moveTo(o,s),i=Math.abs(i)>360?360:i;var h=Math.ceil(Math.abs(i)/45),c=i/h;c=c*Math.PI/180,e=e*Math.PI/180,r.graphics.lineTo(o+t*Math.cos(e),s+t*Math.sin(e));for(var l=1;h>=l;l++){e+=c;var u=e-c/2,d=o+t/Math.cos(c/2)*Math.cos(u),p=s+t/Math.cos(c/2)*Math.sin(u),g=o+t*Math.cos(e),f=s+t*Math.sin(e);r.graphics.curveTo(d,p,g,f)}return 360!=i&&r.graphics.lineTo(o,s),r.graphics.endFill(),r},t}();__reflect(MyTool.prototype,"MyTool");var MyWindow=function(){function t(){}return t.Alert=function(t,e,i){if(100==_get.debug)return void(document.body.style.background="#000000");var n=new AlertUI;n.show(t,e,i)},t.AlertRelogin=function(t){if(100==_get.debug)return void(document.body.style.background="#000000");var e=new AlertUI;e.show(t,function(){MyTool.refresh()}),GameManager.getInstance().stopTimer()},t.Confirm=function(t,e,i,n){void 0===i&&(i=["取消","确定"]);
var a=new ConfirmUI;return a.show(t,e,i,n),a},t.ShowTips=function(t,e){void 0===e&&(e=0),e||(e=Math.max(1e3,150*t.length)),TipsUI.getInstance().show(t,e)},t.addBtnTips=function(t,e,i){function n(i){var n=i.stageX,o=i.stageY;t.stage.removeEventListener(egret.TouchEvent.TOUCH_END,a,t.thisObj||t),t.stage.once(egret.TouchEvent.TOUCH_END,a,t.thisObj||t),t.stage.once(egret.TouchEvent.TOUCH_CANCEL,a,t.thisObj||t),egret.clearTimeout(r),r=egret.setTimeout(function(){return Math.abs(GameManager.stageX-n)>20||Math.abs(GameManager.stageY-o)>20?(t.stage.removeEventListener(egret.TouchEvent.TOUCH_END,a,t.thisObj||t),void t.stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,a,t.thisObj||t)):void("string"==typeof e?TouchTipsUI.getInstance().show(i,e):TouchTipsUI.getInstance().show(i,e.apply(t.thisObj||t)))},this,300)}function a(){t.stage.removeEventListener(egret.TouchEvent.TOUCH_END,a,t.thisObj||t),t.stage.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,a,t.thisObj||t),TouchTipsUI.getInstance().stage&&(t.stopClickTimer=egret.getTimer()),egret.clearTimeout(r),TouchTipsUI.getInstance().hide()}var r;t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,n,t.thisObj||t),i&&GameManager.stage.once(egret.Event.REMOVED_FROM_STAGE,function(){t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,n,t.thisObj||t)},this)},t}();__reflect(MyWindow.prototype,"MyWindow");var Net=function(t){function e(){var e=t.call(this)||this;return e.msgIndex=0,e.modeNum=0,e.outPut=!0,e.actionRecord=[],e.modeNum=0,e}return __extends(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.send=function(t,i,n,a,r,o){void 0===a&&(a=!0),void 0===r&&(r=1),void 0===o&&(o=!1),e.getInstance().send(t,i,n,a,r,o)},e.addUser=function(t){t.gameid=UM.gameid},e.prototype.getVariables=function(t,e,i){var n=new egret.URLVariables("a=1"),a={};return a.head=t,e.gameid&&(a.msg_index=this.msgIndex,this.msgIndex++),a.msg=JSON.stringify(e),a.debug_client=Config.isDebug,1==i?a.version=Config.version:a.version=Config.user_version,_get.debug_server&&(a.debug_server=1),_get.game_version&&(a.game_version=_get.game_version),n.variables=a,n},e.prototype.pushRecord=function(t){for(this.actionRecord.push(t);this.actionRecord.length>10;)this.actionRecord.shift()},e.prototype.send=function(t,e,i,n,a,r){void 0===n&&(n=!0),void 0===a&&(a=1),void 0===r&&(r=!1);var o=new egret.URLLoader;if(o.dataFormat=egret.URLLoaderDataFormat.TEXT,o.isMode=n,o.fun=i,o.head=t,o.msg=e,o.isRepeat=r,1==a)var s=new egret.URLRequest(Config.host);else var s=new egret.URLRequest(Config.userHost);s.method=egret.URLRequestMethod.POST,s.data=this.getVariables(t,e,a),Config.isDebug&&this.outPut&&(console.log("send===>      "+t),console.log(JSON.stringify(e)+"   "+TM.now())),n&&(this.modeNum++,this.addLoading()),this.pushRecord("send:"+t+"#"+this.modeNum),o.load(s),o.addEventListener(egret.Event.COMPLETE,this.onComplete,this),o.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this)},e.prototype.onComplete=function(t){var e=t.currentTarget,i=e.isMode,n=e.fun,a=e.head,r=e.msg;i&&this.modeNum--,this.modeNum<=0&&this.removeLoading(),this.pushRecord("receive:"+a+"#"+this.modeNum),e.removeEventListener(egret.Event.COMPLETE,this.onComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),Config.isDebug&&this.outPut&&(console.log("====receive>        "+a),console.log(t.target.data+"   "+TM.now()));try{var o=JSON.parse(t.target.data);Config.isDebug&&this.outPut&&console.log(o.msg)}catch(t){return void(Config.isDebug?MyWindow.Alert("通信数据异常"):MyWindow.Alert("通信数据异常",this.refresh,"重新登陆"))}if(o.error)switch(this.removeLoading(),o.error){case 1:_get.app?MyWindow.Alert("游戏已更新，请重新下载"):MyWindow.Alert("游戏已更新，请退出重进",this.refresh,"重新登陆"),GameManager.getInstance().stopTimer();break;case 2:MyWindow.Alert("该用户已在其它地方登录",this.refresh,"重新登陆"),GameManager.getInstance().stopTimer();break;case 3:MyWindow.Alert("通信出错",this.refresh,"重新登陆");break;case 4:MyWindow.Alert("用户数据写入失败",this.refresh,"重新登陆"),GameManager.getInstance().stopTimer();break;case 5:MyWindow.Alert("服务器正在维护中，请稍后再试",this.refresh),GameManager.getInstance().stopTimer();break;case 99:MyWindow.Alert(o.error_str,this.refresh),GameManager.getInstance().stopTimer();break;default:MyWindow.Alert("未知错误",this.refresh),GameManager.getInstance().stopTimer()}else{TM.init(o.server_time);var s={};s.sendData=r,s.msg=o.msg,n&&n(s),this.dispatchEventWith(a,!1,s)}},e.prototype.onError=function(t){var e=this,i=t.currentTarget;i.removeEventListener(egret.Event.COMPLETE,this.onComplete,this),i.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),i.isRepeat?MyWindow.Confirm("数据提交失败，与服务器失去连接！",function(t){1==t?e.send(i.head,i.msg,i.fun,i.isMode,1,!0):e.refresh()},["刷新","重试"]):(MyWindow.Alert("与服务器失去连接！",this.refresh),GameManager.getInstance().stopTimer()),this.pushRecord("error"+this.modeNum),this.removeLoading()},e.prototype.refresh=function(){location.reload()},e.prototype.addLoading=function(){MsgingUI.getInstance().show()},e.prototype.removeLoading=function(){MsgingUI.getInstance().hide()},e}(egret.EventDispatcher);__reflect(Net.prototype,"Net");var VScrollerGroup=function(t){function e(){var e=t.call(this)||this;return e.desTop=10,e.margin=10,e.marginLeft=0,e.marginBottom=0,e.pool=[],e.itemArr=[],e.heightObj={},e}return __extends(e,t),e.prototype.childrenCreated=function(){},e.prototype.initScroller=function(t){this.scroller=t,this.scroller.addEventListener(egret.Event.CHANGE,this.onScrollEvent,this),this.scroller.addEventListener(eui.UIEvent.CHANGE_END,this.onScrollEndEvent,this)},e.prototype.onScrollEvent=function(){this.dataArr&&(MyTool.resetScrollV(this.scroller),this.onScroll(this.scroller.viewport.scrollV),this.scrollTime=egret.getTimer())},e.prototype.onScrollEndEvent=function(){this.dataArr&&egret.getTimer()-this.scrollTime<500&&this.onScrollEvent()},e.prototype.getItem=function(){var t=this.pool.pop();return t||(t=new this.itemRenderer,t.x=this.marginLeft||0),this.addChild(t),t},e.prototype.feeItem=function(t){this.pool.push(t),MyTool.removeMC(t)},e.prototype.getFirstItem=function(t){for(var e=null,i=0;i<this.itemArr.length;i++)this.itemArr[i].y>=t&&(!e||this.itemArr[i].y<e.y)&&(e=this.itemArr[i]);return e},e.prototype.setData=function(t){this.clean(),this.heightObj={},this.dataArr=t,this.height=100},e.prototype.clean=function(){for(;this.itemArr.length>0;)this.feeItem(this.itemArr.pop())},e.prototype.addItem=function(t){this.dataArr.push(t)},e.prototype.scrollToLast=function(){this.dataArr.length>0&&this.scrollToItem(this.dataArr[this.dataArr.length-1])},e.prototype.scrollToItem=function(t){var e=this.dataArr.indexOf(t);if(-1!=e){if(0==e)return void this.scrollTo(0);for(var i=0,n=0;e>n;n++)this.heightObj[n]||(this.heightObj[n]=this.getHeight(this.dataArr[n])),i+=this.heightObj[n];this.scrollTo(i)}},e.prototype.scrollTo=function(t){this.scroller.stopAnimation(),this.scroller.viewport.scrollV=t,this.onScroll(t),this.scroller.viewport.scrollV+this.scroller.height>this.height&&(this.scroller.viewport.scrollV=Math.max(0,this.height-this.scroller.height)),t!=this.scroller.viewport.scrollV&&this.onScroll(this.scroller.viewport.scrollV)},e.prototype.onScroll=function(t){for(var e=this.scroller.height,i=!1,n=!1,a=this.desTop,r=0;t-50>a;){if(!this.heightObj[r]){if(!this.dataArr[r])break;this.heightObj[r]=this.getHeight(this.dataArr[r]),n=!0}a+=this.heightObj[r],r++}r--,0>r?r=0:a-=this.heightObj[r];for(var o=0;o<this.itemArr.length;o++)this.itemArr[o].y<a&&(this.feeItem(this.itemArr[o]),this.itemArr.splice(o,1),o--,i=!0);for(;t+e+50>a&&this.dataArr[r];){if(!this.isItemShow(this.dataArr[r])){var s=this.getItem();this.itemArr.push(s),this.addChild(s),s.data=this.dataArr[r],s.y=a,this.heightObj[r]||(s.validateNow(),this.heightObj[r]=s.height+this.margin,n=!0),i=!0}a+=this.heightObj[r],r++}for(var o=0;o<this.itemArr.length;o++)this.itemArr[o].y>a&&(this.feeItem(this.itemArr[o]),this.itemArr.splice(o,1),o--,i=!0);n&&this.resetHeight()},e.prototype.isItemShow=function(t){for(var e=0;e<this.itemArr.length;e++)if(this.itemArr[e].data==t)return!0;return!1},e.prototype.getHeight=function(t){var e=this.getItem();this.addChild(e),e.data=t,e.validateNow();var i=e.height+this.margin;return this.feeItem(e),i},e.prototype.resetHeight=function(){for(var t=this.dataArr.length,e=0,i=0;t>i&&this.heightObj[i];i++)e+=this.heightObj[i];this.height=e+e/i*(t-i)+this.desTop+this.marginBottom},e}(eui.Group);__reflect(VScrollerGroup.prototype,"VScrollerGroup");var WXDB=function(){function t(){}return t.updata=function(t,e,i){var n=window.wx;if(!n)return void(i&&i());var a=n.cloud.database();a.collection(t).doc(UM.dbid).update({data:e,success:function(t){i&&i()}})},t}();__reflect(WXDB.prototype,"WXDB");var BasePanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="BasePanelSkin",e}return __extends(e,t),e.prototype.setTitle=function(t){this.nameText.text=t},e.prototype.setBottomHeight=function(t){this.bottomGroup.height=t},e}(game.BaseContainer);__reflect(BasePanel.prototype,"BasePanel");var AlertUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="AlertSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.canBGClose=!1,t.prototype.childrenCreated.call(this),this.addBtnEvent(this.okBtn,this.onClick),MyTool.removeMC(this.closeBtn),MyTool.removeMC(this.cancelBtn)},e.prototype.show=function(e,i,n){this.textIn=e,this.fun=i,this.btnLabel=n,t.prototype.show.call(this)},e.prototype.onShow=function(){MyTool.setColorText(this.text,this.textIn),this.okBtn.label=this.btnLabel||"确认",this.text.numLines>1&&(this.text.textAlign="left");var t=GameManager.container.width,e=GameManager.container.height;this.x=(t-this.width)/2,this.y=(e-this.height)/2},e.prototype.onClick=function(){this.hide(),this.fun&&this.fun()},e}(game.BaseWindow);__reflect(AlertUI.prototype,"AlertUI");var BottomUI=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.addBtnEvent(this.closeBtn,this.backBtnClick)},e.prototype.setHide=function(t,e){this.hideFun=t,this.thisObj=e},e.prototype.backBtnClick=function(t){this.hideFun&&this.hideFun.apply(this.thisObj)},e}(game.BaseContainer);__reflect(BottomUI.prototype,"BottomUI");var CommonNumInput=function(t){function e(){var e=t.call(this)||this;return e._maxNum=999,e.minNum=1,e.stepNum=1,e.addStr="",e.skinName="CommonNumInputSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStart,this),this.addBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.addBtn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this),this.reduceBtn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this),this.reduceBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStart,this),this.reduceBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this.input.addEventListener(egret.TextEvent.FOCUS_OUT,this.onOut,this),this.input.addEventListener(egret.TextEvent.FOCUS_IN,this.onIn,this),this.input.addEventListener(egret.TextEvent.CHANGE,this.onChange,this)},Object.defineProperty(e.prototype,"maxNum",{get:function(){return this._maxNum},set:function(t){this._maxNum=t,this.input.maxChars=String(t).length+1},enumerable:!0,configurable:!0}),e.prototype.onStart=function(t){t.preventDefault(),this.startTime=TM.now(),this.timer=egret.setInterval(this.onTimer,this,500),this.addNum=(t.currentTarget==this.addBtn?1:-1)*this.stepNum,MyTool.changeGray(this.addBtn,!1,!0),MyTool.changeGray(this.reduceBtn,!1,!0),this.onTimer(!0)},e.prototype.onTimer=function(t){this._nowNum+=this.addNum,this._nowNum>=this._maxNum?(this._nowNum=this._maxNum,this.addNum=0,MyTool.changeGray(this.addBtn,!0,!0)):this._nowNum<=this.minNum&&(this._nowNum=this.minNum,this.addNum=0,MyTool.changeGray(this.reduceBtn,!0,!0)),t||0==this.addNum||(this.timer=egret.setInterval(this.onTimer,this,30)),this.input.text=this._nowNum+this.addStr,this.renewCoin()},e.prototype.onEnd=function(t){egret.clearInterval(this.timer)},e.prototype.onIn=function(){this.input.text=parseInt(this.input.text)+""},e.prototype.onOut=function(){var t=parseInt(this.input.text);this.input.text=t+this.addStr,t%this.stepNum!=0&&(this.nowNum=Math.ceil(t/this.stepNum)*this.stepNum),MyTool.changeGray(this.addBtn,!1,!0),MyTool.changeGray(this.reduceBtn,!1,!0),t>=this._maxNum?(this.nowNum=this._maxNum,MyTool.changeGray(this.addBtn,!0,!0)):t<=this.minNum?(this.nowNum=this.minNum,MyTool.changeGray(this.reduceBtn,!0,!0)):this._nowNum=t,this.renewCoin()},e.prototype.onChange=function(){if(""==this.input.text)return this._nowNum=0,void this.renewCoin();var t=parseInt(this.input.text);t%this.stepNum!=0&&(this.nowNum=Math.ceil(t/this.stepNum)*this.stepNum),t>this._maxNum?this.nowNum=this._maxNum:this._nowNum=t,this.renewCoin()},e.prototype.renewCoin=function(){this.dispatchEventWith(e.RENEW)},Object.defineProperty(e.prototype,"nowNum",{get:function(){return this._nowNum<this.minNum&&(this.nowNum=this.minNum),this._nowNum},set:function(t){this._nowNum=t,this.input.text=t+this.addStr;var e=parseInt(this.input.text);MyTool.changeGray(this.addBtn,e>=this._maxNum,!0),MyTool.changeGray(this.reduceBtn,e<=this.minNum,!0)},enumerable:!0,configurable:!0}),e.prototype.init=function(t,e,i,n){this.minNum=t,this.maxNum=e,this.stepNum=i||1,this.input.maxChars=String(e).length+1,this.addBtn&&(MyTool.changeGray(this.addBtn,!1,!0),MyTool.changeGray(this.reduceBtn,!1,!0)),void 0!=n&&(this.nowNum=n,MyTool.changeGray(this.addBtn,this.nowNum>=this._maxNum,!0),MyTool.changeGray(this.reduceBtn,this.nowNum<=this.minNum,!0))},e.prototype.setEnabled=function(t){this.addBtn.visible=this.reduceBtn.visible=t,this.input.touchEnabled=t},e.RENEW="renew",e}(game.BaseItem);__reflect(CommonNumInput.prototype,"CommonNumInput");var ConfirmUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="AlertSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.canBGClose=!1,this.addBtnEvent(this.okBtn,this.onClick),this.addBtnEvent(this.cancelBtn,this.onCancelClick),this.addBtnEvent(this.closeBtn,this.onCloseClick)},e.prototype.show=function(e,i,n,a){this.textIn=e,this.fun=i,this.btnWord=n,this.sp=a||{},t.prototype.show.call(this)},e.prototype.onShow=function(){MyTool.setColorText(this.text,this.textIn),this.text.validateNow(),this.text.numLines>1&&!this.sp.middle&&(this.text.textAlign="left"),this.btnWord&&(this.cancelBtn.label=this.btnWord[0],this.okBtn.label=this.btnWord[1]);var t=GameManager.container.width,e=GameManager.container.height;this.x=(t-this.width)/2,this.y=(e-this.height)/2,this.closeBtn.visible=!1},e.prototype.onClick=function(){this.hide(),this.fun&&this.fun(1)},e.prototype.onCancelClick=function(){this.hide(),this.fun&&this.fun(2)},e.prototype.onCloseClick=function(){this.hide(),this.fun&&this.fun(3)},e}(game.BaseWindow);__reflect(ConfirmUI.prototype,"ConfirmUI");var DebugUI=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this.backBtn,this.hide);var e=window.wx;e&&this.addB("数据库",function(){e.cloud.database()})},e.prototype.addB=function(t,e){var i=new eui.Button;i.skinName="Btn1Skin",this.con.addChild(i),this.addBtnEvent(i,e)},e}(game.BaseUI);__reflect(DebugUI.prototype,"DebugUI");var DownList=function(t){function e(){var e=t.call(this)||this;return e.defaultStr="全部",e.skinName="DownListSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this.btn,this.onOpen),this.scroller.viewport=this.list,this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelect,this),this.list.itemRenderer=DownListItem,this.openHeight=this.height,this.isOpen=!1,this.renew()},e.prototype.onOpen=function(t){t.stopImmediatePropagation(),this.isOpen=!this.isOpen,this.isOpen&&this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickStage,this),this.renew()},e.prototype.onClickStage=function(){GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickStage,this),this.isOpen=!1,this.renew()},e.prototype.renew=function(){this.isOpen&&!this.listCon.parent?this.addChild(this.listCon):!this.isOpen&&this.listCon.parent&&this.removeChild(this.listCon)},e.prototype.setData=function(t,e){void 0===e&&(e=0),this.dataArr=t,this.list.dataProvider=new eui.ArrayCollection(t),this.height=Math.min(this.openHeight,56*t.length-6+60-1),this.selectValue=e},Object.defineProperty(e.prototype,"selectValue",{get:function(){var t=this.list.selectedItem;return t?t.data:0},set:function(t){for(var e=this.dataArr,i=0;i<e.length;i++)if(e[i].data==t){this.list.selectedIndex=i;break}i>=e.length&&(t=0,this.list.selectedIndex=0),this.renewBtn(t)},enumerable:!0,configurable:!0}),e.prototype.renewBtn=function(t){for(var e=this.dataArr,i=0;i<e.length;i++)if(t==e[i].data)return this.titleText.text=e[i].label,void(this.img.source=e[i].icon);this.titleText.text=this.defaultStr},e.prototype.onSelect=function(){var t=this.list.selectedItem,i=t?t.data:0;this.dispatchEventWith(e.SELECT,!0,i),this.renewBtn(i)},e.SELECT="SELECT",e}(game.BaseContainer);__reflect(DownList.prototype,"DownList");var DownListItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="DownListItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this.data.icon?(this.img.source=this.data.icon,this.con.addChildAt(this.img,0)):MyTool.removeMC(this.img),this.text.text=this.data?""+this.data.label:"全部",this.data.label2&&(this.text.text+=this.data.label2)},e}(game.BaseItem);__reflect(DownListItem.prototype,"DownListItem");var LeftList=function(t){function e(){var e=t.call(this)||this;return e.defaultStr="全部",e.skinName="LeftListSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this.btn,this.onOpen),this.scroller.viewport=this.list,this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelect,this),this.list.itemRenderer=DownListItem,this.openHeight=this.height,this.isOpen=!1,this.renew()},e.prototype.onOpen=function(t){this.isOpen=!this.isOpen,this.isOpen&&egret.callLater(function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickStage,this,!0)},this),this.renew()},e.prototype.onClickStage=function(t){t.stopImmediatePropagation(),GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickStage,this,!0),this.isOpen=!1,this.renew()},e.prototype.renew=function(){this.isOpen&&!this.listCon.parent?this.addChild(this.listCon):!this.isOpen&&this.listCon.parent&&this.removeChild(this.listCon)},e.prototype.setData=function(t,e){void 0===e&&(e=0),this.dataArr=t,this.list.dataProvider=new eui.ArrayCollection(t),this.listCon.height=56*t.length,this.selectValue=e},Object.defineProperty(e.prototype,"selectValue",{get:function(){var t=this.list.selectedItem;return t?t.data:0},set:function(t){for(var e=this.dataArr,i=0;i<e.length;i++)if(e[i].data==t){this.list.selectedIndex=i;break}i>=e.length&&(t=0,this.list.selectedIndex=0),this.renewBtn(t)},enumerable:!0,configurable:!0}),e.prototype.renewBtn=function(t){for(var e=this.dataArr,i=0;i<e.length;i++)if(t==e[i].data)return void(this.img.source=e[i].icon)},e.prototype.onSelect=function(){var t=this.list.selectedItem,e=t?t.data:0;this.dispatchEventWith(DownList.SELECT,!0,e),this.renewBtn(e)},e.SELECT="SELECT",e}(game.BaseContainer);__reflect(LeftList.prototype,"LeftList");var TipsUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="TipsUISkin",e}return __extends(e,t),e.getInstance=function(){var t=this.instancePool.pop();return t||(t=new e),t},e.prototype.show=function(t,i){for(var n=0;n<e.showTips.length;n++){var a=e.showTips[n];a.toY-=70,egret.Tween.removeTweens(a);var r=egret.Tween.get(a);r.to({y:a.toY},2*Math.abs(a.toY-a.y))}e.showTips.push(this),egret.clearTimeout(this.timer),GameManager.stage.addChild(this),MyTool.setColorText(this.text,t),this.text.numLines>1&&(this.text.textAlign="left"),this.visible=!1,this.timer=egret.setTimeout(this.onTimer,this,i+100*(e.showTips.length-1)),egret.setTimeout(function(){this.visible=!0},this,100*(e.showTips.length-1)),this.validateNow(),this.x=(GameManager.stage.stageWidth-this.width)/2,this.y=.2*GameManager.stage.stageHeight,this.toY=this.y},e.prototype.onTimer=function(){this.hide()},e.prototype.hide=function(){egret.clearTimeout(this.timer),MyTool.removeMC(this),PopUpManager.testShape(),e.instancePool.push(this);var t=e.showTips.indexOf(this);-1!=t&&e.showTips.splice(t,1)},e.instancePool=[],e.showTips=[],e}(game.BaseContainer);__reflect(TipsUI.prototype,"TipsUI");var TouchTipsUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="TouchTipsSkin",e}return __extends(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.show=function(t,e){e&&(GameManager.container.addChild(this),MyTool.setHtml(this.text,e),this.validateNow(),this.y=t.stageY-this.height-100,this.y<0&&(this.y=t.stageY+120),this.x=t.stageX-this.width/2,this.x<10?this.x=10:this.x+this.width>630&&(this.x=630-this.width),GameManager.stage.once(egret.TouchEvent.TOUCH_CANCEL,this.hide,this))},e.prototype.hide=function(){MyTool.removeMC(this)},e}(game.BaseContainer);__reflect(TouchTipsUI.prototype,"TouchTipsUI");var UpList=function(t){function e(){var e=t.call(this)||this;return e.defaultStr="全部",e.skinName="UpListSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this.btn,this.onOpen),this.scroller.viewport=this.list,this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSelect,this),this.list.itemRenderer=DownListItem,this.openHeight=this.height,this.isOpen=!1,this.renew()},e.prototype.onOpen=function(t){this.isOpen=!this.isOpen,this.isOpen&&egret.callLater(function(){this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickStage,this,!0)},this),this.renew()},e.prototype.onClickStage=function(t){t.stopImmediatePropagation(),GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickStage,this,!0),this.isOpen=!1,this.renew()},e.prototype.renew=function(){this.isOpen&&!this.listCon.parent?this.addChild(this.listCon):!this.isOpen&&this.listCon.parent&&this.removeChild(this.listCon)},e.prototype.setData=function(t,e){void 0===e&&(e=0),this.dataArr=t,this.list.dataProvider=new eui.ArrayCollection(t),this.listCon.height=56*t.length,this.selectValue=e},Object.defineProperty(e.prototype,"selectValue",{get:function(){var t=this.list.selectedItem;return t?t.data:0},set:function(t){for(var e=this.dataArr,i=0;i<e.length;i++)if(e[i].data==t){this.list.selectedIndex=i;break}i>=e.length&&(t=0,this.list.selectedIndex=0),this.renewBtn(t)},enumerable:!0,configurable:!0}),e.prototype.renewBtn=function(t){for(var e=this.dataArr,i=0;i<e.length;i++)if(t==e[i].data)return void(this.titleText.text=e[i].label);this.titleText.text=this.defaultStr},e.prototype.onSelect=function(){var t=this.list.selectedItem,e=t?t.data:0;this.dispatchEventWith(DownList.SELECT,!0,e),this.renewBtn(e)},e.SELECT="SELECT",e}(game.BaseContainer);__reflect(UpList.prototype,"UpList");var UserInfoBtn=function(){function t(t,e,i,n){this.sourceBtn=t,this.parent=i,this.callFun=e,this.isNew=n}return t.prototype.initBtn=function(t,e,i,n,a){var r=this;if(console.log(1111),window.wx){console.log(222222);var o=screen.availWidth/640,s=screen.availHeight/GameManager.stage.stageHeight,h=o*i,c=s*n,l=o*t,u=o*e,d=window.wx.createUserInfoButton({type:"image",image:""+a,style:{left:h,top:c,width:l,height:u}});return d.onTap(function(t){r.callFun&&r.callFun(t)}),d}},Object.defineProperty(t.prototype,"visible",{set:function(t){if(console.log(t,this.isNew),t&&this.isNew&&!this.okBtn){var e=this.sourceBtn;isNaN(e.right)||(e.x=this.parent.width-e.right-e.width),isNaN(e.horizontalCenter)||(e.x=(this.parent.width-e.width)/2),isNaN(e.bottom)||(e.y=this.parent.height-e.bottom-e.height),this.okBtn=this.initBtn(e.width,e.height,e.x,e.y,this.isNew)}console.log(this.okBtn),this.okBtn&&(t?(this.sourceBtn.visible=!1,this.okBtn.show(),this.parent.once(egret.Event.REMOVED_FROM_STAGE,this.hide,this)):this.hide())},enumerable:!0,configurable:!0}),t.prototype.checkWindow=function(t){t.data!=this.parent&&this.parent.hide()},t.prototype.hide=function(){this.okBtn&&this.okBtn.hide(),this.sourceBtn.visible=!0},t}();__reflect(UserInfoBtn.prototype,"UserInfoBtn");var MonsterVO=function(){function t(t){this.isMonster=!0,this.haveLoad=!1,this.temp=0,t&&this.fill(t)}return t.getObject=function(t){return CM.table[this.dataKey][t]},Object.defineProperty(t,"data",{get:function(){return CM.table[this.dataKey]},enumerable:!0,configurable:!0}),t.prototype.fill=function(t){this.width=t.width,this.height=t.height,this.atk=t.atk,this.type=t.type,this.headoff=t.headoff,this.heightoff=t.heightoff,this.atkcd=1e3*t.atkcd,this.cost=t.cost,this.space=t.space,this.def=t.def,this.cd=1e3*t.cd,this.num=t.num,this.atkrage=t.atkrage,this.level=t.level,this.mcnum=t.mcnum,this.mcheight=t.mcheight,this.name=t.name,this.des=t.des,this.speed=t.speed,this.hp=t.hp,this.id=t.id,this.sv1=t.sv1,this.sv2=t.sv2,this.sv3=t.sv3,this.mcwidth=t.mcwidth,this.atk2=t.atk2,this.skillcd=1e3*t.skillcd,this.mv_atk=1e3*t.mv_atk,this.mv_atk2=t.mv_atk2},t.prototype.getImage=function(t){return t?Config.localResRoot+"card_gay/card_"+this.id+".jpg":Config.localResRoot+"card/card_"+this.id+".jpg"},t.prototype.getHeroBG=function(t){return"hero_bg"+t+"_png"},t.prototype.getBG=function(){return 1==this.type?"border_7_png":2==this.type?"border_6_png":"border_8_png"},t.prototype.getTypeIcon=function(){return"icon_type"+this.type+"_png"},t.prototype.preLoad=function(){this.haveLoad||(MBase.getData(this.id).preload(),this.haveLoad=!0)},t.prototype.getAdd=function(t,e){if(e)var i=this.type==e?PKConfig.typeAdd:0;else var i=0;var n=(1+t/100)*(1+i/100);return n},t.prototype.getSkillValue=function(t,e){void 0===e&&(e=0);var i=this["sv"+t];return e?Math.floor(i*(1+e/100)):i},t.prototype.getDes=function(t,e){return this.des.replace("#1",this.fillColor(this.sv1,e)).replace("#2",this.fillColor(this.sv2,e)).replace("#3",this.fillColor(this.sv3,e)).replace("$1",this.changeValue(this.sv1,t,e)).replace("$2",this.changeValue(this.sv2,t,e)+"").replace("$3",this.changeValue(this.sv3,t,e)).replace("#CD",MyTool.toFixed(this.cd/1e3,1)+"")},t.prototype.fillColor=function(t,e){return e?MyTool.createHtml(t,16766591):t},t.prototype.changeValue=function(t,e,i){return t?this.fillColor(Math.ceil(t*e),i):void 0},t.prototype.getAtkDis=function(){return this.width/2+this.atkrage},t.prototype.isNearAtk=function(){return this.atkrage<=PKConfig.nearRage},t.prototype.isHero=function(){return!1},t.dataKey="monster_base",t.key="id",t}();__reflect(MonsterVO.prototype,"MonsterVO");var AddCoinItem=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=e.touchEnabled=!1,e.skinName="AddCoinItemSkin",e}return __extends(e,t),e.createItem=function(){var t=this.pool.pop();return t||(t=new e),t},e.freeItem=function(t){t&&(t.remove(),this.pool.push(t))},e.showMV=function(t,e){var i=this,n=this.createItem();n.data="+"+t,n.horizontalCenter=0,n.verticalCenter=0,n.alpha=1,e.addChild(n),egret.Tween.get(n).wait(200).to({verticalCenter:-200,alpha:0},500).call(function(){i.freeItem(n)})},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this.addText.text=this.data},e.prototype.remove=function(){MyTool.removeMC(this),egret.Tween.removeTweens(this)},e.pool=[],e}(game.BaseItem);__reflect(AddCoinItem.prototype,"AddCoinItem");var GameUI=function(t){function e(){var e=t.call(this)||this;return e.showIndex=-1,e.skinName="GameUISkin",e}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this.settingBtn,this.onClick),this.addBtnEvent(this.mailBtn,this.onMail),this.addBtnEvent(this.shopBtn,this.onShop),this.team1.teamID=1,this.team2.teamID=2,this.mainPKUI.addEventListener("visible_change",this.onMainVisibleChange,this)},e.prototype.onClick=function(){this.playGame()},e.prototype.onMail=function(){this.mainPKUI.hide(),this.team1.visible=this.team2.visible=!this.mainPKUI.visible},e.prototype.onShop=function(){UM.addCoin(1e3),WXDB.updata("user",{coin:UM.coin})},e.prototype.show=function(){t.prototype.show.call(this)},e.prototype.callShow=function(){var t=this;this.loadText.text="初始化中",PKManager.getInstance().loadLevelData(PKManager.getInstance().getTodayIndex(),function(e){PKManager.getInstance().initData(e),t.initData()})},e.prototype.onShow=function(){var t=this;this.loadingGroup.visible=!0,egret.Tween.get(this.loadMC,{loop:!0}).to({rotation:360},3e3),t.loadText.text="0%";var e=window.wx;if(e){var i=e.loadSubpackage({name:"assets2",success:function(e){t.callShow()},fail:function(t){}});return void i.onProgressUpdate(function(e){t.loadText.text=e.progress+"%"})}this.callShow()},e.prototype.initData=function(){this.loadingGroup.visible=!1,egret.Tween.get(this.loadMC,{loop:!0}).to({rotation:360},3e3),this.mainPKUI.visible=!1,this.showIndex=-1,this.onTimer(),this.onCoinChange(),this.addPanelOpenEvent(GameEvent.client.timer,this.onTimer),this.addPanelOpenEvent(GameEvent.client.COIN_CHANGE,this.onCoinChange)},e.prototype.onCoinChange=function(){this.coinText.text=UM.coin+""},e.prototype.onTimer=function(){var t=PKManager.getInstance(),e=t.getCurrentIndex();if(e!=this.showIndex&&(-1!=this.showIndex&&this.mainPKUI.visible&&this.mainPKUI.finish&&this.mainPKUI.showData.isMain&&(this.mainPKUI.hide(),this.team1.visible=this.team2.visible=!this.mainPKUI.visible),this.showIndex=e,this.showData=t.getCurrentData(),this.showData?(this.team1.showList(this.showData.list1.split(",")),this.team2.showList(this.showData.list2.split(","))):(this.team1.showList([]),this.team2.showList([])),PKManager.getInstance().testSendResult()),!this.showData){var i=DateUtil.getNextDateTimeByHours(6)-TM.now();return void(i>=3600?this.cdText.text="修战中\n"+DateUtil.getStringBySeconds(i,!0,2):this.cdText.text="修战中\n"+DateUtil.getStringBySecond(i).substr(-5))}var n=t.getEndTime()-180-TM.now();if(0>=n)return this.playGame(),void(this.cdText.text="战斗中\n"+DateUtil.getStringBySecond(n+180).substr(-5));this.cdText.text="投注中\n"+DateUtil.getStringBySecond(n).substr(-5);var a=t.getCost(this.showData.seed,420-n);this.team1.renewCost(a),this.team2.renewCost(a),this.team1.randomTalk(),this.team2.randomTalk()},e.prototype.playGame=function(){if(!this.mainPKUI.visible){var t=PKManager.getInstance();t.callSendCost(!0);var e=t.getCost(this.showData.seed,600);this.mainPKUI.show({isMain:!0,key:t.getCurrentKey(),list1:this.showData.list1,list2:this.showData.list2,seed:this.showData.seed,passTime:TM.now()-(t.getEndTime()-180),force1:t.getForceAdd(e.cost1+UM.lastGuess.teamCost1)+t.baseForce,force2:t.getForceAdd(e.cost2+UM.lastGuess.teamCost2)+t.baseForce})}},e.prototype.onMainVisibleChange=function(){this.team1.visible=this.team2.visible=!this.mainPKUI.visible},e}(game.BaseUI);__reflect(GameUI.prototype,"GameUI");var UM,TM,EM,CM,DM,Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isThemeLoadEnd=!1,e.isResourceLoadEnd=!1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),console.log("_10");var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.setScaleMode(),this.loadingView=MainLoadingUI.getInstance(),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/"),UM=UserManager.getInstance(),TM=TimeManager.getInstance(),EM=EventManager.getInstance(),CM=CacheManager.getInstance(),DM=DebugManager.getInstance(),Config.initURLRequest(),console.log("_1a")
},e.prototype.setScaleMode=function(){},e.prototype.onConfigComplete=function(t){console.log("_1b"),RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this);var e=new eui.Theme("resource/default.thm.json",this.stage);e.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload_png")},e.prototype.onThemeLoadComplete=function(){this.isThemeLoadEnd=!0,console.log("_1c"),this.createScene()},e.prototype.onResourceLoadComplete=function(t){console.log("_1d"),"preload_png"==t.groupName&&(this.isResourceLoadEnd=!0,this.removeLoadEvent(),this.createScene())},e.prototype.removeLoadEvent=function(){this.loadingView.setFinish(),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)},e.prototype.createScene=function(){this.isThemeLoadEnd&&this.isResourceLoadEnd&&this.startCreateScene()},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},e.prototype.onResourceProgress=function(t){console.log(t.itemsLoaded,t.itemsTotal),"game"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},e.prototype.startCreateScene=function(){CM.initData(RES.getRes("data_json")),GameManager.stage=this.stage,GameManager.container=this,GameManager.getInstance().init(),console.log("_11"),_get.hide||UserManager.getInstance().getUserInfo(function(){GameUI.getInstance().show()})},e}(eui.UILayer);__reflect(Main.prototype,"Main");var MainLoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.createView=function(){this.shape=new eui.Rect,this.shape.width=640,this.shape.fillColor=0,this.shape.touchEnabled=!0,this.addChild(this.shape),this.textField=new eui.Label,this.addChild(this.textField),this.textField.x=80,this.textField.width=480,this.textField.height=100,this.textField.text="Loading...",this.textField.textAlign="center",this.icon=new eui.Image,this.addChild(this.icon),this.icon.x=230},e.prototype.show=function(t){t.addChild(this),this.width=640,this.height=t.stage.stageHeight,this.shape.height=t.stage.stageHeight,this.textField.y=this.height/2,this.icon.y=this.textField.y-230,this.textField.text="Loading..."},e.prototype.setFinish=function(){this.textField.text="加载完成，正在初始化...."},e.prototype.showLogin=function(){this.textField.text="登陆中...."},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e.prototype.hide=function(){MyTool.removeMC(this)},e}(egret.Sprite);__reflect(MainLoadingUI.prototype,"MainLoadingUI");var CardInfoUI=function(t){function e(){var e=t.call(this)||this;return e.upAble=!1,e.skinName="CardInfoUISkin",e}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this.okBtn,this.onClick),this.addBtnEvent(this.r0,this.onCB),this.addBtnEvent(this.r1,this.onCB),this.addBtnEvent(this.leftBtn,this.onLeft),this.addBtnEvent(this.rightBtn,this.onRight),this.addBtnEvent(this.closeBtn,this.hide),this.addBtnEvent(this.helpBtn,function(){})},e.prototype.onLeft=function(){var t=this.currentState,e=this.openList.indexOf(this.data);this.data=this.openList[e-1],this.renew(),this.currentState!=t&&this.validateNow(),PopUpManager.setMiddle(this)},e.prototype.onRight=function(){var t=this.currentState,e=this.openList.indexOf(this.data);this.data=this.openList[e+1],this.renew(),this.currentState!=t&&this.validateNow(),PopUpManager.setMiddle(this)},e.prototype.onCB=function(){SharedObjectManager.getInstance().setMyValue("show_card_base",this.r0.selected),this.renew()},e.prototype.onClick=function(){},e.prototype.show=function(e,i){this.data=e,this.sp=i||{},t.prototype.show.call(this)},e.prototype.hide=function(){t.prototype.hide.call(this)},e.prototype.onShow=function(){this.sp.list?this.openList=this.sp.list:this.openList=[],this.r0.selected=SharedObjectManager.getInstance().getMyValue("show_card_base")||!1,this.r1.selected=!this.r0.selected,this.renew()},e.prototype.renew=function(){if(this.sp.force)return void(this.currentState="view");this.data.isMonster&&(this.currentState="normal"),this.coinText.textColor=this.upAble?16777215:16711680;var t=this.openList.indexOf(this.data);this.leftBtn.visible=t>0,this.rightBtn.visible=t<this.openList.length-1},e}(game.BaseWindow);__reflect(CardInfoUI.prototype,"CardInfoUI");var AwardItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="AwardItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addBtnEvent(this,this.onClick)},e.prototype.onClick=function(){},e.prototype.dataChanged=function(){this.img.source=this.data.img,this.nameText.text=this.data.name,this.numText.text=this.data.num,this.data.isHero?(this.currentState="hero",this.bg.source=this.data.bgSource):(this.currentState="normal",this.bg.source="border2_png")},e}(game.BaseItem);__reflect(AwardItem.prototype,"AwardItem");var AwardUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="AwardUISkin",e}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.scroller.viewport=this.list,this.list.itemRenderer=AwardItem,this.addBtnEvent(this.okBtn,this.hide),this.addBtnEvent(this.btn2,this.onBtn2)},e.prototype.onBtn2=function(){this.secFun&&this.secFun(),this.hide()},e.prototype.show=function(e,i,n,a,r,o){e&&(this.dataIn=e,this.title=i,this.des=n,this.fun=a,this.secLabel=r,this.secFun=o,t.prototype.show.call(this))},e.prototype.hide=function(){t.prototype.hide.call(this),this.fun&&this.fun()},e.prototype.onShow=function(){this.renew()},e.prototype.renew=function(){this.titleText.text=this.title||"恭喜获得";var t=[];this.list.dataProvider=new eui.ArrayCollection(t),this.des?(this.currentState="des",this.desText.text=this.des):this.currentState="normal",this.secLabel?(this.btnGroup.addChild(this.btn2),this.btn2.label=this.secLabel):MyTool.removeMC(this.btn2)},e}(game.BaseWindow);__reflect(AwardUI.prototype,"AwardUI");var CardImg=function(t){function e(){var e=t.call(this)||this;return e.hideType=!1,e.skinName="CardImgSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this.changeGay(!1)},e.prototype.changeGay=function(t){var e=CM.getCardVO(this.data),i=e.getImage(t);i!=this.lastSource&&(this.img.source=i,this.lastSource=i,this.typeMC.visible=this.data>PKConfig.skillBeginID&&!this.hideType,this.typeMC.source=e.getTypeIcon())},e}(game.BaseItem);__reflect(CardImg.prototype,"CardImg");var HeadMC=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeadMCSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.onClick=function(){},e.prototype.dataChanged=function(){this.setData(this.data,0)},e.prototype.setData=function(t,e){this.rect.visible=!1,this.bg.visible=!0},e}(game.BaseItem);__reflect(HeadMC.prototype,"HeadMC");var MonsterAtkMV=function(t){function e(){var e=t.call(this)||this;return e.frameTotal=20,e.rota=0,e.index=0,e.mw=120,e.mh=120,e.frameNum=4,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.mc=new eui.Image,this.addChild(this.mc)},e.prototype.load=function(t,e,i,n,a){void 0===a&&(a=4),this.rota=e,this.frameNum=a,0==e?(this.mw=i/a,this.mh=n):(this.mw=i,this.mh=n/a),MyTool.setImgSource(this.mc,t),this.width=this.mw,this.height=this.mh,this.mc.scrollRect=new egret.Rectangle(0,0,this.mw,this.mh)},e.prototype.play=function(){this.reset(),this.addEventListener(egret.Event.ENTER_FRAME,this.onE,this)},e.prototype.stop=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onE,this)},e.prototype.reset=function(){this.index=0,this.onE()},e.prototype.onE=function(){var t=this.mw,e=this.mh,i=Math.round(1*this.frameTotal/this.frameNum);if(0==this.rota)var n=Math.floor(this.index/i)*t,a=0;else var a=Math.floor(this.index/i)*e,n=0;this.mc.scrollRect=new egret.Rectangle(n,a,t,e),this.index++,this.index>=this.frameNum*i&&(this.index=0,this.onEnd())},e.prototype.onEnd=function(){this.dispatchEventWith("mv_end")},e}(eui.Group);__reflect(MonsterAtkMV.prototype,"MonsterAtkMV");var MonsterMV=function(t){function e(){var e=t.call(this)||this;return e.frameTotal=40,e.state=2,e.index=0,e.mw=120,e.mh=120,e.speed=0,e.runing=!1,e.init(),e}return __extends(e,t),e.prototype.init=function(){this.mc=new eui.Image,this.addChild(this.mc)},e.prototype.initAtkMV=function(){this.atkMV||(this.atkMV=new MonsterAtkMV,this.addChild(this.atkMV),this.atkMV.visible=!1,this.atkMV.addEventListener("mv_end",this.onAtkMVEnd,this))},e.prototype.onAtkMVEnd=function(){this.atkMV.stop(),this.atkMV.visible=!1,this.play()},e.prototype.load=function(t,e){var i=this.vo=MonsterVO.getObject(t);this.mw=i.mcwidth/i.mcnum,this.mh=i.mcheight/4,this.mc.y=i.heightoff,MyTool.setImgSource(this.mc,"enemy"+t+"_png"),this.width=this.mw,this.height=this.mh,this.anchorOffsetX=this.mw/2,this.anchorOffsetY=this.mh,this.mc.scrollRect=new egret.Rectangle(0,0,this.mw,this.mh),this.speed=0},e.prototype.run=function(){this.state=e.STAT_RUN,this.reset()},e.prototype.stand=function(){this.state=e.STAT_STAND,-1!=[61,62,63,70,76].indexOf(this.vo.id)&&(this.state=e.STAT_RUN),this.reset()},e.prototype.die=function(){this.state=e.STAT_DIE,this.reset()},e.prototype.atk=function(){this.state=e.STAT_ATK,this.reset()},e.prototype.play=function(){this.runing=!0,EM.addEventListener(GameEvent.client.timerE,this.onE,this)},e.prototype.stop=function(){this.runing=!1,EM.removeEventListener(GameEvent.client.timerE,this.onE,this)},e.prototype.reset=function(){this.index=0,this.atkMV&&(this.atkMV.visible=!1,this.atkMV.stop()),this.onE(),this.runing||this.play()},e.prototype.onE=function(){var t=this.mw,i=this.mh,n=this.speed||0;if(n)if(n>0)var a=Math.round(this.frameTotal*(1-n/(100+n))/this.vo.mcnum);else var a=Math.round(this.frameTotal*(1-n/100)/this.vo.mcnum);else var a=Math.round(this.frameTotal/this.vo.mcnum);this.state==e.STAT_ATK&&99==this.vo.id&&(a=1);var r=Math.floor(this.index/a)*t,o=(this.state-1)*i;return this.mc.scrollRect=new egret.Rectangle(r,o,t,i),this.state==e.STAT_ATK&&1==this.vo.mv_atk2&&Math.floor(this.index/a)>=this.vo.mcnum-1?(this.index=0,void this.onEnd()):(this.index++,void(this.index>=this.vo.mcnum*a&&(this.index=0,this.onEnd())))},e.prototype.onEnd=function(){switch(this.state){case e.STAT_RUN:99==this.vo.id&&this.stand();break;case e.STAT_STAND:break;case e.STAT_ATK:1==this.vo.mv_atk2?this.stop():this.stand();break;case e.STAT_DIE:this.stop(),PKData.getInstance().actionRecord.push("die_mid|"+this.vo.id),this.dispatchEventWith("mv_die")}},e.prototype.getRect=function(){var t=this.localToGlobal(this.anchorOffsetX,this.anchorOffsetY);return new egret.Rectangle(t.x-this.mw/2,t.y-this.mh+this.vo.heightoff,this.mw,this.mh)},e.STAT_RUN=1,e.STAT_STAND=2,e.STAT_ATK=3,e.STAT_DIE=4,e}(eui.Group);__reflect(MonsterMV.prototype,"MonsterMV");var ResourceLoaderUI=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.show=function(e,i){this.LoadFiles=e,this.finishFun=i,t.prototype.show.call(this)},e.prototype.onShow=function(){this.finishFun&&this.finishFun(),egret.callLater(this.hide,this)},e}(game.BaseWindow);__reflect(ResourceLoaderUI.prototype,"ResourceLoaderUI");var AniManager=function(){function t(){this.mcFactorys={},this.mcPool=[],this.mvList=[],this.imgPool=[],this.imgList=[],this.mvConfig={14:{frameRate:24,scale:1},30:{scale:1.5},39:{scale:1.5},116:{frameRate:24}},this.mvSoundConfig={},this.aniList=[];var t={1:[],2:[5,6,16,136,137,162,166,167,15],3:[30,109,119,138,139,128,36,134],4:[7,107,108,117,125,145,151,157,158,177],5:[12,32,148,168,135],6:[],7:[176,31,33,111,133],8:[8,14,13,22,27,37,39,124,132,143,146,35,144,147,149,172],9:[],10:[],11:[],12:[23,38,105,110,126,129],13:[],14:[3,4,21,131],15:[102,103,104,160,163,164,170,113,114,127,130,153,154],16:[11,24,25,26,28,29,34,106,112,115,116,118,120,121,122,123,140,141,142,161,175]};for(var e in t)for(var i=t[e],n=0;n<i.length;n++){var a=i[n];this.mvSoundConfig[a]&&console.log("same"+e+"--"+a+"--"+this.mvSoundConfig[a]),this.mvSoundConfig[a]=e}}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.getImg=function(t){var e=this.imgPool.pop()||new eui.Image;return e.source=t,this.imgList.push(e),e},t.prototype.removeImg=function(t){var e=this.imgList.indexOf(t);-1!=e&&this.imgList.splice(e,1),e=this.imgPool.indexOf(t),-1==e&&this.imgPool.push(t),t.rotation=0,t.scaleX=1,t.scaleY=1,t.alpha=1,egret.Tween.removeTweens(t),MyTool.removeMC(t)},t.prototype.removeAllMV=function(){for(;this.mvList.length>0;)this.removeMV(this.mvList[0]);for(;this.imgList.length>0;)this.removeImg(this.imgList[0])},t.prototype.onSkillAni=function(t){"ani"==t.groupName&&(RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onSkillAni,this),console.log(t))},t.prototype.removeMV=function(t){var e=this.mvList.indexOf(t);-1!=e&&this.mvList.splice(e,1),t.stop(),t.removeEventListener(egret.Event.COMPLETE,this.onComp,this),this.mcPool.push(t),t.rotation=0,t.scaleX=1,t.scaleY=1,t.alpha=1,egret.Tween.removeTweens(t),MyTool.removeMC(t)},t.prototype.preLoadMV=function(t){var e=this.getMVKey(t);if(this.mcFactorys[e])return!0;var i=RES.getRes(e+"_json"),n=RES.getRes(e+"_png");if(i&&n)return!0;var a="mv"+e;return 0==RES.getGroupByName(a).length&&(RES.createGroup(a,[e+"_json",e+"_png"],!0),RES.loadGroup(a)),!1},t.prototype.getMV=function(t){var e=this.mcFactorys[t];if(!e){var i=RES.getRes(t+"_json"),n=RES.getRes(t+"_png");if(null==i){if(Config.isDebug)throw new Error("111");return this.mcPool.pop()||new egret.MovieClip}e=new egret.MovieClipDataFactory(i,n),this.mcFactorys[t]=e}var a=this.mcPool.pop()||new egret.MovieClip;if(a.movieClipData=e.generateMovieClipData(t),null==a.movieClipData){if(Config.isDebug)throw new Error("222");return a}return a.frameRate=12,a.scaleX=a.scaleY=1,a.rotation=0,a},t.prototype.getAni=function(t){var e=this.getMVKey(t),i=this.getMV(e);return i.gotoAndPlay(1,-1),this.mvList.push(i),i},t.prototype.getAniOnce=function(t,e,i){var n=this.getMVKey(t),a=this.getMV(n);return a.comFun=e,a.thisObj=i,a.gotoAndPlay(1,1),a.once(egret.Event.COMPLETE,this.onComp,this),this.mvList.push(a),a},t.prototype.onComp=function(t){t.currentTarget.comFun&&t.currentTarget.comFun.apply(t.currentTarget.thisObj),this.removeMV(t.currentTarget)},t.prototype.getMVKey=function(t){return"skill"+parseInt(t)},t.prototype.playOnItem=function(t,e,i){if(this.preLoadMV(t)){var n=this.getAniOnce(t);return i?(n.x=i.x,n.y=i.y):(n.x=e.x,n.y=e.y),e.parent.addChildAt(n,e.parent.getChildIndex(e)+1),n}},t.prototype.playInItem=function(t,e){if(this.preLoadMV(t)){var i=this.getAniOnce(t);return i.x=i.y=0,e.addChild(i),i}},t.prototype.drop=function(t,e){var i=this.getImg(t);i.y=e.y-500,i.x=e.x,e.parent.addChildAt(i,e.parent.getChildIndex(e)+1);var n=egret.Tween.get(i);return n.to({y:e.y},300).call(function(){this.removeImg(i)},this),i},t}();__reflect(AniManager.prototype,"AniManager");var PKCode=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.onStep=function(){var t=PKData.getInstance();if(!t.stopTime){if(!t.startTime)return void sendClientError("未开始就调用onStep");for(var e=t.getPassTime()-t.actionTime,i=TM.nowMS();t.quick||e>PKConfig.stepCD;){if(t.actionTime+=PKConfig.stepCD,t.disableKey={},e-=PKConfig.stepCD,t.actionTime%2e3==0&&this.autoAction(),this.monsterAction(),this.monsterMove(),PKMonsterAction.getInstance().actionAtk(t.actionTime),this.actionFinish(),t.isReplay&&t.actionTime>=t.replayEndTime&&(t.isGameOver=!0),t.isGameOver)return!0;if(t.actionTime>PKConfig.drawTime)return!0;t.quick&&t.actionTime>=t.quickTime&&(t.quick=!1,e=0,t.startTime=TM.nowMS()-t.actionTime+t.speedAddTime,t.startTime-=TM.nowMS()-i,PKVideoCon.getInstance().resetView())}return!1}},t.prototype.autoAction=function(){for(var t=PKData.getInstance(),e=1;e<=t.playerNum;e++){var i=t.playerObj[e];i&&i.addMonster()}},t.prototype.monsterAction=function(){for(var t=PKData.getInstance(),e=0;e<t.monsterList.length;e++){t.resetMonsterData();var i=t.monsterList[e],n=i.canSkill(t.actionTime);if(n&&n.length>0)PKMonsterAction.getInstance().skill(i,t.actionTime);else{var a=i.getAtkTarget();a&&PKMonsterAction.getInstance().atk(i,t.actionTime)}}},t.prototype.monsterMove=function(){for(var t=PKData.getInstance(),e=0;e<t.monsterList.length;e++){var i=t.monsterList[e];i.canMove(t.actionTime)?i.move():i.stopTime<t.actionTime&&99!=i.mid&&i.stand()}},t.prototype.actionFinish=function(){for(var t=PKData.getInstance(),e=0,i=0,n=0;n<t.monsterList.length;n++){var a=t.monsterList[n];if(a.die||a.dieTime&&a.dieTime<=t.actionTime)a.die=!0,t.monsterList.splice(n,1),t.addVideo({type:PKConfig.VIDEO_MONSTER_DIE,user:a}),n--,a.onDie(),t.monsterChange=!0;else if(a.x<PKConfig.appearPos||a.x>PKConfig.floorWidth+PKConfig.appearPos){if(a.die=!0,t.monsterList.splice(n,1),n--,a.passEnd=!0,a.onDie(),t.monsterChange=!0,a.dieTime){t.addVideo({type:PKConfig.VIDEO_MONSTER_DIE,user:a});continue}t.getPlayer(a.owner).teamData.enemy.hp-=1,t.getPlayer(a.owner).teamData.enemy.hp<=0&&(t.isGameOver=!0),t.addVideo({type:PKConfig.VIDEO_MONSTER_WIN,user:a})}else a.hpChange&&t.actionTime-a.lastHpChange>=500&&(a.addHp(Math.floor(a.hpChange/2)),a.lastHpChange=t.actionTime),a.cleanBuff(t.actionTime),a.stateChange&&(a.stateChange=!1,t.addVideo({type:PKConfig.VIDEO_MONSTER_STATE_CHANGE,user:a}));1==a.getOwner().teamData.id?e++:2==a.getOwner().teamData.id&&i++}t.team1.onStateTimer(),t.team2.onStateTimer(),t.isGameOver||(0==e&&0==t.getPlayer(1).autoList.length&&(t.getPlayer(1).teamData.hp=0,t.isGameOver=!0),0==i&&0==t.getPlayer(2).autoList.length&&(t.getPlayer(2).teamData.hp=0,t.isGameOver=!0))},t}();__reflect(PKCode.prototype,"PKCode");var PKConfig=function(){function t(){}return t.ROTA_LEFT=1,t.ROTA_RIGHT=-1,t.TYPENAME={1:"堡垒",2:"自然",3:"幽暗"},t.TYPECOLOR={1:4232118,2:4108138,3:11550013},t.SKILLTYPENAME={1:"伤害",2:"治疗",3:"辅助",4:"召唤",5:"特殊"},t.beforeShowTime=5e3,t.nearRage=20,t.stepCD=50,t.gameTime=300,t.maxMonsterSpace=30,t.floorWidth=800,t.appearPos=100,t.remainCD=3e3,t.mpInit=15,t.beforeCD=3e3,t.maxHandCard=6,t.maxPosCard=4,t.typeAdd=10,t.drawTime=18e4,t.skillBeginID=200,t.heroCD=3e3,t.VIDEO_MONSTER_DOUBLE=1,t.VIDEO_MONSTER_DIE=2,t.VIDEO_MONSTER_WIN=3,t.VIDEO_MONSTER_ADD=4,t.VIDEO_MONSTER_ATK=5,t.VIDEO_MONSTER_MOVE=6,t.VIDEO_MONSTER_HPCHANGE=7,t.VIDEO_MONSTER_MISS=8,t.VIDEO_TEAM_DEF=9,t.VIDEO_TEAM_DEF2=11,t.VIDEO_POS_SHOW=10,t.VIDEO_MONSTER_STATE_CHANGE=12,t.VIDEO_MONSTER_ADD_STATE=13,t.VIDEO_MONSTER_STAND=14,t.VIDEO_MONSTER_CHANGE_TEAM=15,t.VIDEO_POS_FAIL=16,t.VIDEO_TOTEM_ADD=17,t.VIDEO_TOTEM_REMOVE=18,t.VIDEO_POS_ADD=19,t.VIDEO_POS_REMOVE=20,t.VIDEO_MANAHP_CHANGE=21,t.VIDEO_MONSTER_NOHIT=22,t.VIDEO_MONSTER_CHANGE_SKIN=23,t.VIDEO_MYPLAYER_CHANGE=24,t.VIDEO_AUOT_ADD_CARD=25,t.VIDEO_TEAM_HP_CHANGE=26,t.VIDEO_CARD_WAITING_CHANGE=27,t.VIDEO_HERO_ADD=28,t.STATE_YUN=1,t.STATE_MOMIAN=2,t.STATE_MODUN=3,t.STATE_MIANSHANG=4,t.STATE_DIE=5,t.STATE_NOBEATK=6,t.STATE_SOUL=7,t.STATE_ILL=101,t.STATE_REBORN=102,t.LISTENER_NONE=0,t.LISTENER_CREATE=1,t.LISTENER_DIE=2,t.LISTENER_TIMER=3,t.LISTENER_CREATE_POS=4,t.LISTENER_ATK=5,t.LISTENER_BEATK=6,t}();__reflect(PKConfig.prototype,"PKConfig");var PKManager=function(){function t(){this.baseForce=1e4,this.costChange=!1,this.pkResult={},this.levelData={},this.pkWord=["投降，或者死亡","来战个痛快","小心你的背后","这招看你怎么躲","我要认真了","你就只会这几招吗","我要出大招了","我会赐予你死亡","你究竟想怎样...","我的魔法会撕碎你","我已饥渴难耐","你会记住我的名字的","品尝我的愤怒吧","你死期将至！","我要粉碎你！","你是我的猎物","尝尝我的厉害吧","你会后悔对上我的","希望你能多坚持一会吧","不要输得太难看哦","对面上来的是什么啊","我允许你认输","唯有一战了","胜利属于我们的","我们来做个了结吧","你的身体有破绽","你空门大开啊","尝尝这个吧","接下...\n这一招吧","用这招....\n来决胜负吧","马上将你解决掉","就用你的死来结束吧","别罗嗦了...来吧","来啊!\n互相相害啊","求一败","抬走，下一个","来个强点的","对面没人了吗","来让我战个痛快吧","哈哈哈","我的目标是要3杀","胜利是属于我的","你睡着了吗","你分心了","别小看我!","游戏结束了","满足了吗","到现在才来求饶吗","浪费时间!!","想逃吗!真无聊!","你可别小看我啊!","你还未够资格","别惹我....!","任务保证完成","赢的人，\n是我","你太脆弱了","哦，是的！\n我要胜利了","抱歉","打得不错","发生这种事我很抱歉","对此我很抱歉","你敢盯着我看","对面太弱了","威武","有希望了","想输都难","距离胜利又近一步了","看来我不用再出手了","燃烧吧！\n小宇宙！","我会让你后悔来到世上","严肃点，\n这是比赛","啦啦啦啦~","我的魔法会撕碎你","我已饥渴难耐","你会记住我的名字的","祈祷别对上我吧","我的怒火\n会毁灭一切","噢，亲爱的\n要坚持住","你死定了","你们这是自寻死路","品尝我的愤怒吧","你死期将至！","我要粉碎你！","你是我的猎物","你对力量一无所知","这就是王者之气啊","刚才你们说什么来着","看到我们有多强了吧","等会去哪庆功好呢","留几个给我杀啊","放轻点，别把对面吓跑了","蠢材！","让我来干掉你....","我要打呵欠了","让我好好抱抱你！","我准备好了","我已经等不及了","→_→","@_@","( ¯ □ ¯ )","（╯＾╰）",">_<","(╯▔▽▔)╯","(╬▔皿▔)凸","到此为止了","别烦我!","还没有结束的～","有点本事啊","我绝不认输","我只是变的更坚强了","我和你没完","不胜利毋宁死","死亡，没什么好怕的","为胜利献身","哈哈!","呀！！！","过来好好打一架","胆小鬼","品尝我的愤怒吧","这是个秘密","训练又开始了！","你不能通过这里","清算时间","嘿！伙计！","加入战斗","勇敢战斗","准备作战","来吧","接受挑战","接..招","目标已经标记出来了","我渴望胜利","是时候了！","是时候流点血了","你要让谁流血","啊，感觉真棒","你要我干啥？","杀啊！","休想逃走","尝尝我的利刃","给我个任务吧","接受任务","尝尝厉害吧，笨猪","狗崽子！！！","使劲打用力抽","我的眼睛洞察一切","愿祖先保佑你","放马过来","瞄准你啦","向前推进","你是谁！","痛苦降临","我预见了你的末日","不从者。。死","轮到你，流血啦","你马上就会人间蒸发","你死定了","你死期将至","无人能够阻拦我","没人可以通过","不留活口","为了荣耀","时间不多了，我们上吧","全体注意","下一个，轮到谁啦","冲锋陷阵","额，付出代价","把这个敌人留给我","我们该干什么","撕碎，扯烂","我们来干什么","要我攻击哪里？","我来给他点颜色瞧瞧","好疼啊","活着就要战斗","要打架了","所有人，都过来","死亡没什么好怕的","我，会让你安息","我可没时间陪你玩","死亡之神在召唤","待宰羔羊！","医生，我流血了","啊！医生！","我闻到血的味道","是吗？那就去死吧！","祝你好运！","赐予我力量！","你们这是自寻死路！","我快没有时间了！","哈，那家伙死定了！","你想玩个游戏吗","灵魂，躁动不安","恐惧，如影随形","不可饶恕","都是你的错","恐惧吧，哀嚎吧","放纵你内心的恐惧吧","死期将至","戳死你！","残酷的命运","$%&*&$@","@#$%&","( T___T ) ","( 3__3 ) ","zzz ZZZ","╭∩╮","..."]}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.getPKBG=function(t){t=t||this.getCurrentData();var e,i=7;return e=t?Math.ceil(this.random(t.seed)*i):this.getTodayIndex()%i||i,"map"+e+"_jpg"},t.prototype.getTodayIndex=function(){var t=1546012800,e=Math.ceil((TM.now()-t)/24/3600);return e=5},t.prototype.callSendCost=function(t){var e=this;clearTimeout(this.sendTimer),t?this.sendCost():this.sendTimer=setTimeout(function(){e.sendTimer=0,e.sendCost()},500)},t.prototype.initData=function(t){var e=t.split("\n");this.roundData=e},t.prototype.getCurrentKey=function(){return 1e3*this.getTodayIndex()+this.getCurrentIndex()},t.prototype.getCurrentIndex=function(){var t=DateUtil.getNextDateTimeByHours(0)-86400,e=TM.now(),i=e-t-21600;return 0>i?-1:Math.floor(i/10/60)},t.prototype.getCurrentData=function(){var t=this.getCurrentIndex();return this.roundData[t]?JSON.parse(this.roundData[t]):0},t.prototype.getEndTime=function(){var t=DateUtil.getNextDateTimeByHours(0)-86400,e=this.getCurrentIndex();return t+21600+10*(e+1)*60},t.prototype.random=function(t){var e=t||this.randomSeed;e=(9301*e+49297)%233280;var i=e/233280;return t||(this.randomSeed=1e8*i),i},t.prototype.getCost=function(t,e){this.randomSeed=2*t;for(var i=Math.min(e,420),n=15+20*this.random(),a=50-n,r={cost1:0,cost2:0},o=0;i>o;o++)r.cost1+=this.random()*n,r.cost2+=this.random()*a;var s=this.getCurrentIndex(),h=this.getIndexRate(s);return r.cost1*=h,r.cost2*=h,r},t.prototype.getIndexRate=function(t){var e=1,i=6,n=6,a=Math.abs((8-i)*n-t);return 10>a&&(e+=(10-a)/10),a=Math.abs((12.5-i)*n-t),8>a&&(e+=(8-a)/8*2),a=Math.abs((20.5-i)*n-t),20>a&&(e+=(20-a)/15*3),e+=t/150},t.prototype.getForceAdd=function(t){return Math.floor(Math.pow(t,.8))},t.prototype.getMoneyRate=function(t,e){var i=e/t;return Math.floor(100+50*i)},t.prototype.loadLevelData=function(t,e,i){var n=this;if(this.levelData[t])return void(e&&e(this.levelData[t]));var a=new egret.URLLoader;a.dataFormat=egret.URLLoaderDataFormat.TEXT,a.once(egret.Event.COMPLETE,function(){n.levelData[t]=a.data,i&&MsgingUI.getInstance().hide(),e&&e(a.data)},this);var r="resource/level/level_"+t+".txt";a.load(new egret.URLRequest(r)),i&&MsgingUI.getInstance().show()},t.prototype.testSendResult=function(){var t=this;if(this.getCurrentKey()!=UM.lastGuess.key){if(UM.lastGuess.key&&0==UM.lastGuess.isDeal&&(UM.lastGuess.cost1||UM.lastGuess.cost2)){var e=UM.lastGuess;return e.isDeal=1,this.getPKResult(e,function(i){e.isDeal=2;var n=t.getAddCoin(e,i);n&&MyWindow.ShowTips("你在上一轮竞猜中，获得了"+NumberUtil.addNumSeparator(n)+"金币"),UM.addCoin(n),WXDB.updata("user",{coin:UM.coin,lastGuess:e}),UM.lastGuess=UM.getGuessInitData(t.getCurrentKey())}),!1}if(1==UM.lastGuess.isDeal)return!1;UM.lastGuess=UM.getGuessInitData(this.getCurrentKey())}return!0},t.prototype.getAddCoin=function(t,e){var i=0,n=this.getRoundDataByKey(t.key),a=this.getCost(n.seed,999999),r=a.cost1+t.teamCost1,o=a.cost2+t.teamCost2;if(1==e){var s=this.getMoneyRate(r,o);i+=Math.round(t.cost1*s/100)}else if(2==e){var s=this.getMoneyRate(o,r);i+=Math.round(t.cost2*s/100)}return i},t.prototype.getPKResult=function(t,e){var i=this;if(this.pkResult[t.key])return void e(this.pkResult[t.key]);var n=Math.floor(t.key/1e3),a=Math.floor(t.key%1e3);this.loadLevelData(n,function(n){var r=n.split("\n"),o=JSON.parse(r[a]),s=i.getCost(o.seed,999999),h=i.getForceAdd(s.cost1+t.teamCost1)+i.baseForce,c=i.getForceAdd(s.cost2+t.teamCost2)+i.baseForce;PKData.instanceIndex=2;var l=PKData.getInstance();l.init({seed:o.seed,players:[{id:1,gameid:"team1",team:1,force:h,hp:1,autolist:o.list1},{id:2,gameid:"team2",team:2,force:c,hp:1,autolist:o.list2}]}),l.quick=!0,l.start(),PKCode.getInstance().onStep(),i.pkResult[t.key]=l.getPKResult(),e(l.getPKResult()),PKData.instanceIndex=1})},t.prototype.getRoundDataByKey=function(t){var e=Math.floor(t/1e3),i=Math.floor(t%1e3),n=this.levelData[e].split("\n");return JSON.parse(n[i])},t.prototype.sendCost=function(){if(this.costChange){var t=window.wx;t&&WXDB.updata("user",{coin:UM.coin,lastGuess:UM.lastGuess}),this.costChange=!1}},t.TYPE_HANG=1,t.TYPE_SLAVE=2,t.TYPE_PVP_OFFLINE=3,t.TYPE_PVP_ONLINE=4,t.TYPE_FIGHT=51,t.TYPE_ANSWER=52,t.TYPE_RANDOM=53,t.TYPE_CHOOSECARD=54,t.TYPE_ENDLESS=55,t.TYPE_TEST=101,t.TYPE_MAIN_HANG=102,t}();__reflect(PKManager.prototype,"PKManager");var PKMonsterAction=function(){function t(){this.atkList=[]}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.addAtkList=function(t){this.atkList.push(t)},t.prototype.init=function(){this.atkList.length=0},t.prototype.actionAtk=function(t){for(var e=0;e<this.atkList.length;e++){var i=this.atkList[e];if(i.endTime<=t){this.atkList.splice(e,1),e--;var n=i.user,a=i.target;if(a&&a.die&&!i.stopTestDie)continue;if("delay_run"==i.type)i.fun&&i.fun();else if("atk_before"==i.type){if(!n.canAction())continue;i.model.atkAction(n,a,t)}else if("atk"==i.type){if(a.isInState(PKConfig.STATE_NOBEATK))return;MBase.getData(n.mid).atk(n,a)}else if("skill_before"==i.type){if(!n.canAction()&&!i.stopTestDie)continue;n.setSkillUse(i.actionTime),i.model.skillAction(n,i.target,t)}else"skill"==i.type&&MBase.getData(n.mid).skill(n,i.target)}}},t.prototype.atk=function(t,e){var i=e+t.getAtkCD();t.stopTime=Math.max(t.stopTime,i),PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ATK,user:t,target:t.target}),MBase.getData(t.mid).atkBefore(t,e)},t.prototype.skill=function(t,e){var i=e+t.getAtkCD();t.stopTime=Math.max(t.stopTime,i),PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ATK,user:t,target:t.skillTargets[0]}),MBase.getData(t.mid).skillBefore(t,e)},t}();__reflect(PKMonsterAction.prototype,"PKMonsterAction");var PKTool=function(){function t(){}return t.getMPList=function(){if(!this.mpList)for(this.mpList=[0];;){var t=this.getMPTime(this.mpList.length);if(t>PKConfig.drawTime)break;this.mpList.push(t)}return this.mpList.concat()},t.getRound=function(t){if(0==t)return 1;for(var e=0,i=0;i<this.cdData.length;i++)if(e+=1e3*this.cdData[i].cd,e>t)return i;return this.cdData.length},t.decodeAutoList=function(t){for(var e=[],i=1,n=0,a=0;a<t.length;a++){var r=t[a],o=r.split(",");n+=1e3*this.cdData[a].cd;for(var s=0;s<o.length;s++)e.push({mid:o[s],time:n+PKConfig.stepCD*s*2+2*PKConfig.stepCD,id:i}),i++}return console.log(e),e},t.addMPTime=function(t,e,i){for(var n=0;n<t.length;n++)if(t[n]>=e){for(;i>0;)t.splice(n,0,e),i--;break}},t.decodeActionList=function(t){for(var e=[],i=1,n=0;n<t.length;n++){var a=t[n].split("#");e.push({mid:a[1],time:PKConfig.stepCD*a[0],id:i}),i++}return e},t.decodeHeroList=function(t){for(var e=[],i=1,n=0;n<t.length;n++){var a=t[n].split("|");e.push({mid:parseInt(a[0]),level:parseInt(a[1]),id:i}),i++}return e},t.getGroupMp=function(t){var e=0;if(0>t)e+=-t;else{var i=CM.getCardVO(t);e+=i.cost}return e},t.getMPTime=function(t){for(var e=0,i=0,n=0;n<this.cdData.length;n++)if(e+=this.cdData[n].mp,i+=this.cdData[n].cd,e>=t)return 1e3*i;return Number.MAX_VALUE},t.getAtkRate=function(t,e){if(0==e||0==t)return 1;var i=Math.abs(t-e);return 0==i?1:1==i?e>t?1.5:.8:t>e?1.5:.8},t.cdData=[{cd:0,mp:20},{cd:10,mp:20},{cd:15,mp:25},{cd:20,mp:25},{cd:25,mp:30},{cd:30,mp:30},{cd:30,mp:35},{cd:30,mp:35},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40},{cd:30,mp:40}],t}();__reflect(PKTool.prototype,"PKTool");var PKBuffData=function(){function t(t){this.isDebuff=!1,this.removeAble=!0,this.endTime=0,this.add={},this.state={},this.tempValue={},this.haveState=!1,this.haveValue=!1}return t.prototype.addValue=function(t,e){this.add[t]=e,this.haveValue=!0},t.prototype.addState=function(t){this.state[t]=!0,this.haveState=!0},t.prototype.enable=function(){if(!this.ing){this.ing=!0;for(var t in this.add)this.owner[t]+=this.add[t]}},t.prototype.disable=function(){if(this.ing){this.ing=!1;for(var t in this.add)this.owner[t]-=this.add[t]}},t.prototype.remove=function(){this.disable(),this.endFun&&this.endFun(this)},t}();__reflect(PKBuffData.prototype,"PKBuffData");var PKData=function(t){function e(){var e=t.call(this)||this;return e.currentState="def",e.quick=!1,e.quickTime=Number.MAX_VALUE,e.jumpMV=!1,e.isGameOver=!1,e.showTopNum=0,e.startTime=0,e.stopTime=0,e.actionTime=0,e.beginAuto=!1,e.playerNum=2,e.endless=0,e.needcd=0,e.monsterChange=!1,e.randomSeed=0,e.randomTimes=0,e.monsterList=[],e.playerObj={},e.history={},e.disableKey={},e.actionRecord=[],e.playSpeed=1,e.lastDealSpeedTime=0,e.speedAddTime=0,e}return __extends(e,t),e.getInstance=function(){return 1==this.instanceIndex?(this.instance||(this.instance=new e),this.instance):(this.instance2||(this.instance2=new e),this.instance2)},e.prototype.isView=function(){return this.isAuto||this.isReplay},e.prototype.canSpeed=function(){return!1},e.prototype.getPassTime=function(){var t=TM.nowMS(),e=t-(this.lastDealSpeedTime||this.startTime);return e&&(this.speedAddTime+=(this.playSpeed-1)*e),this.lastDealSpeedTime=t,TM.nowMS()-this.startTime+this.speedAddTime},e.prototype.stop=function(){this.stopTime=TM.nowMS()},e.prototype.play=function(){if(this.stopTime){var t=(TM.nowMS()-this.stopTime)*this.playSpeed;this.startTime+=t,this.stopTime=0}},e.prototype.init=function(t){this.startTime=0,this.round=1,this.heroStep=0,this.preLoadHeroStep=0,this.isReplay=!1,this.isAuto=!1,this.baseData=t,this.actionRecord=[],this.quick=!1,this.quickTime=Number.MAX_VALUE,this.history={},this.monsterList.length=0,this.playerObj={},this.myPlayer=null,this.actionTime=0,this.playSpeed=1,this.lastDealSpeedTime=0,this.speedAddTime=0,this.stopTime=0,this.monsterID=1,this.isGameOver=!1,this.monsterChange=!1,this.beginAuto=!1,this.currentState="pk",PKMonsterAction.getInstance().init(),this.randomTimes=0,this.randomSeed=t.seed,this.showTopNum=t.showTopNum||0,this.endless=t.endless||0,this.needcd=t.needcd||0,this.team1=new PKTeamData({id:1}),this.team2=new PKTeamData({id:2}),this.team1.enemy=this.team2,this.team2.enemy=this.team1;
for(var e=0;e<t.players.length;e++){var i=new PKPlayerData(t.players[e]);i.teamData=this.getTeamByID(t.players[e].team),i.teamData.autoDef=Math.max(t.players[e].def||0,i.teamData.autoDef),i.teamData.hp+=i.hp,this.playerObj[i.id]=i,i.gameid==UM.gameid?(this.myPlayer=i,i.teamData.atkRota=PKConfig.ROTA_LEFT,i.teamData.enemy.atkRota=PKConfig.ROTA_RIGHT,i.teamData.members.unshift(i)):i.teamData.members.push(i)}this.myPlayer||(this.team1.atkRota=PKConfig.ROTA_LEFT,this.team2.atkRota=PKConfig.ROTA_RIGHT,this.myPlayer=this.getPlayer(1)),this.team1.reInit(),this.team2.reInit()},e.prototype.getForceData=function(){var t={};for(var e in this.monsterList){var i=this.monsterList[e],n=i.getOwner().teamData.id;t[n]||(t[n]=0),t[n]+=i.getForce()}return t},e.prototype.random=function(){this.randomTimes++;var t=this.randomSeed;t=(9301*t+49297)%233280;var e=t/233280;return this.randomSeed=1e8*e,e},e.prototype.rand=function(t,e){return t+Math.floor(this.random()*(e-t+1))},e.prototype.randSort=function(t){function e(){return i.random()>.5?-1:1}var i=this;t.sort(e)},e.prototype.randomOne=function(t,e){void 0===e&&(e=!1);var i=Math.floor(t.length*this.random()),n=t[i];return e&&t.splice(i,1),n},e.prototype.nextRoundCD=function(){var t=1e3*PKTool.cdData[this.round].cd-this.actionTime;return t},e.prototype.start=function(){this.startTime=TM.nowMS(),this.stopTime=0},e.prototype.addDiamondMonster=function(){this.diamondData=this.addMonster({force:0,mid:99,owner:"sys",atkRota:1,x:PKConfig.floorWidth/2+PKConfig.appearPos,y:0,actionTime:0})},e.prototype.onPosEmpty=function(t){},e.prototype.addVideo=function(t){this.quick||this.dispatchEventWith("video",!1,t)},e.prototype.getTeamByID=function(t){return this.team1.id==t?this.team1:this.team2},e.prototype.getTeamByRota=function(t){return this.team1.atkRota==t?this.team1:this.team2},e.prototype.getPlayer=function(t){return this.playerObj[t]},Object.defineProperty(e.prototype,"otherPlayer",{get:function(){return this.getPlayer(1==this.myPlayer.id?2:1)},enumerable:!0,configurable:!0}),e.prototype.isWin=function(){var t=this.myPlayer.teamData,e=this.myPlayer.teamData.enemy;return this.endless&&this.actionTime>=this.endless?!0:this.needcd&&this.actionTime>=this.needcd?!1:t.hp>0&&e.hp<=0},e.prototype.isDraw=function(){var t=this.myPlayer.teamData,e=this.myPlayer.teamData.enemy;return this.needcd&&this.actionTime>=this.needcd?!1:t.hp>0&&e.hp>0||t.hp<=0&&e.hp<=0},e.prototype.getPKResult=function(){return this.isWin()?1:this.isDraw()?3:2},e.prototype.getMonsterByPlayer=function(t,e){void 0===e&&(e=0);for(var i=[],n=0;n<this.monsterList.length;n++){var a=this.monsterList[n];if(a.owner==t){if(e&&a.getVO().type!=e)continue;i.push(a)}}return i},e.prototype.getMonsterSpaceByPlayer=function(t){for(var e=0,i=0;i<this.monsterList.length;i++){var n=this.monsterList[i];n.owner==t&&(e+=n.getVO().space)}return e},e.prototype.getMonsterByID=function(t){for(var e=0;e<this.monsterList.length;e++){var i=this.monsterList[e];if(i.id==t)return i}return null},e.prototype.getMonsterByTeam=function(t,e,i){for(var n=[],a=0;a<this.monsterList.length;a++){var r=this.monsterList[a];if(r.getOwner().teamData==t){if(e&&!e(r,i))continue;n.push(r)}}return n},e.prototype.getMonsterByNoTeam=function(t,e,i){for(var n=[],a=0;a<this.monsterList.length;a++){var r=this.monsterList[a];if(r.getOwner().teamData!=t){if(e&&!e(r,i))continue;n.push(r)}}return n},e.prototype.getFirstItem=function(t){for(var i,n=e.getInstance().getTeamByID(t).atkRota,a=0;a<this.monsterList.length;a++){var r=this.monsterList[a];r.atkRota==n&&"sys"!=r.owner&&(i?n==PKConfig.ROTA_LEFT&&i.x<r.x?i=r:n==PKConfig.ROTA_RIGHT&&i.x>r.x&&(i=r):i=r)}return i},e.prototype.getBackItem=function(t){for(var i,n=e.getInstance().getTeamByID(t).atkRota,a=0;a<this.monsterList.length;a++){var r=this.monsterList[a];r.atkRota==n&&"sys"!=r.owner&&(i?n==PKConfig.ROTA_LEFT&&i.x<r.x?r.getVO().isNearAtk()||(i=r):n==PKConfig.ROTA_RIGHT&&i.x>r.x&&(r.getVO().isNearAtk()||(i=r)):r.getVO().isNearAtk()||(i=r))}return i},e.prototype.getFirstX=function(t){var e=this.getFirstItem(t);return e?e.x:this.getTeamByID(t).atkRota==PKConfig.ROTA_LEFT?PKConfig.appearPos:PKConfig.floorWidth+PKConfig.appearPos},e.prototype.addMonster=function(t){var e=this.getPlayer(t.owner),i=e.teamData.toFront;if(i>0){var n=this.getFirstItem(e.teamData.id);n&&(t.x=n.x,MonsterVO.getObject(t.mid).isNearAtk()||(t.x+=e.teamData.atkRota==PKConfig.ROTA_LEFT?-60:60))}var a=new PKMonsterData(t);return a.id=this.monsterID,this.monsterID++,this.monsterList.push(a),this.addVideo({type:PKConfig.VIDEO_MONSTER_ADD,user:a}),MBase.getData(a.mid).onCreate(a),a.getOwner().teamData.testState(PKConfig.LISTENER_CREATE,a),t.fromPos&&a.getOwner().teamData.testState(PKConfig.LISTENER_CREATE_POS,a),this.monsterChange=!0,this.history[a.id]={id:a.id,mid:a.mid,owner:a.owner,actionTime:this.actionTime},a.xxx=this.actionTime+"|"+a.id,this.actionRecord.push("create|"+this.actionTime+"|"+a.id+"|"+a.mid+"|"+a.owner),a},e.prototype.resetMonsterData=function(){if(this.monsterChange){this.monsterChange=!0;for(var t=0;t<this.monsterList.length;t++);}},e.prototype.changeMyPlayer=function(t){var e=this.getPlayer(t);e!=this.myPlayer&&(this.myPlayer=e,this.addVideo({type:PKConfig.VIDEO_MYPLAYER_CHANGE,user:this.myPlayer}))},e.prototype.onPKInfo=function(t){if(t.owner!=this.myPlayer.id){this.getPlayer(t.owner);if(Math.abs(t.actiontime-this.actionTime)>3e3)return void MyWindow.Alert("重置")}},e.instanceIndex=1,e}(egret.EventDispatcher);__reflect(PKData.prototype,"PKData");var PKMonsterData=function(){function t(t){this.die=!1,this.passEnd=!1,this.hp=0,this.atk=0,this.speed=0,this.def=0,this.maxHp=0,this.hpChange=0,this.lastHpChange=0,this.atkAble=!0,this.level=0,this.doubleRate=0,this.doubleValue=0,this.doubleAction=!1,this.missRate=0,this.momian=!1,this.skillTemp={},this.nohitTimes=0,this.baseHp=0,this.baseAtk=0,this.baseSpeed=0,this.addSpeed=0,this.manaHp=0,this.skillTimes=0,this.atkY=0,this.atkX=0,this.atkHurtCount=0,this.stopTime=0,this.lastSkill=0,this.dieTime=0,this.buff=[],this.currentState={},this.stateChange=!1,this.reborning=!1,this.stopReborn=!1,t&&this.fill(t)}return t.prototype.fill=function(t){for(var e in t)this[e]=t[e];var i=MonsterVO.getObject(this.mid),n=i.getAdd(t.force,this.getOwner().type),a=t.maxHpAdd||1;this.hp=Math.floor(i.hp*n*a),this.atk=Math.floor(i.atk*n),this.speed=i.speed,this.def=i.def,this.maxHp=this.hp,this.baseHp=this.hp,this.baseAtk=this.atk,this.baseSpeed=this.speed,t.hpRate&&(this.hp=Math.floor(this.hp*t.hpRate)||1),MBase.getData(this.mid).initMonster(this)},t.prototype.getForce=function(){var t=this.getVO();return Math.round((this.hp/t.hp*(1+this.def/100)+this.atk/t.atk*.8+this.speed/t.speed*.5)*t.cost*10)},t.prototype.getAtkRate=function(t){if(_get.debug)return 1;var e=this.getVO().type,i=t.getVO().type;return PKTool.getAtkRate(e,i)},t.prototype.getAtkBeforeCD=function(){return this.addSpeed?this.addSpeed<0?Math.floor(this.getVO().mv_atk*(1-this.addSpeed/100)):Math.floor(this.getVO().mv_atk*(1-this.addSpeed/(100+this.addSpeed))):this.getVO().mv_atk},t.prototype.getAtkCD=function(){return this.addSpeed?this.addSpeed<0?Math.floor(this.getVO().atkcd*(1-this.addSpeed/100)):Math.floor(this.getVO().atkcd*(1-this.addSpeed/(100+this.addSpeed))):this.getVO().atkcd},t.prototype.beSkillAble=function(){return 0==this.momian&&!this.isInState(PKConfig.STATE_MOMIAN)},t.prototype.addBuff=function(t){t.owner=this,this.buff.push(t),t.id?this.resetBuffID(t.id):t.enable(),t.ing&&t.haveState&&this.resetState()},t.prototype.haveBuff=function(t){for(var e=0;e<this.buff.length;e++){var i=this.buff[e];if(i.id==t)return!0}return!1},t.prototype.cleanBuff=function(t,e,i){void 0===i&&(i=0);for(var n=!1,a=null,r=0;r<this.buff.length;r++){var o=this.buff[r],s=o.endTime&&t&&o.endTime<=t;e&&e==o.user&&(s=!0),o.removeAble&&(-1==i&&o.isDebuff&&(s=!0),1!=i||o.isDebuff||(s=!0)),s&&(this.buff.splice(r,1),r--,o.ing&&(o.haveState&&(n=!0),o.id&&(a||(a={}),a[o.id]||(a[o.id]=!0))),o.remove())}if(a)for(var h in a)this.resetBuffID(h);n&&this.resetState()},t.prototype.isInState=function(t){return t==PKConfig.STATE_MOMIAN&&this.momian?!0:this.currentState[t]},t.prototype.resetState=function(){var t=this.currentState;this.currentState={};for(var e=0;e<this.buff.length;e++){var i=this.buff[e];if(i.ing&&i.haveState)for(var n in i.state)this.currentState[n]=!0,t[n]||(this.stateChange=!0)}if(!this.stateChange)for(var n in t)if(!this.currentState[n]){this.stateChange=!0;break}},t.prototype.resetBuffID=function(t){for(var e,i=[],n=0;n<this.buff.length;n++){var a=this.buff[n];a.id==t&&(i.push(a),a.ing&&(e=a))}if(i.length&&(1!=i.length||!e)){for(var r,n=0;n<i.length;n++){var a=i[n];(!r||Math.abs(a.value)>Math.abs(r.value))&&(r=a)}return e?void(r!=e&&r.value!=e.value&&(r.enable(),e.disable())):void r.enable()}},t.prototype.getVO=function(){return MonsterVO.getObject(this.mid)},t.prototype.getOwner=function(){return PKData.getInstance().getPlayer(this.owner)},t.prototype.canMove=function(t){if("sys"==this.owner)return!1;if(this.getVO().speed<=0)return!1;if(!this.canAction())return!1;if(!this.atkAble&&"def"==PKData.getInstance().currentState){if(this.atkRota==PKConfig.ROTA_LEFT&&this.x>PKConfig.floorWidth/2+PKConfig.appearPos-100)return!1;if(this.atkRota==PKConfig.ROTA_RIGHT&&this.x<PKConfig.floorWidth/2+PKConfig.appearPos+100)return!1}return this.stopTime<t},t.prototype.canAction=function(){return!this.die&&!this.isInState(PKConfig.STATE_YUN)},t.prototype.canAtk=function(){var t=PKData.getInstance();return this.atkAble&&this.canAction()&&this.stopTime<t.actionTime},t.prototype.canBeAtk=function(t){return!this.die&&t.getOwner().teamData!=this.getOwner().teamData&&!this.isInState(PKConfig.STATE_NOBEATK)},t.prototype.canSkill=function(t){if(this.stopTime>=t)return null;var e=this.getVO();return e.skillcd?this.lastSkill&&this.lastSkill+e.skillcd>=t?null:this.canAction()?(this.skillTargets=MBase.getData(this.mid).getSkillTarget(this),this.skillTargets):null:null},t.prototype.isHero=function(){return this.getVO().isHero()},t.prototype.setSkillUse=function(t){this.getVO().isHero()&&(this.callHeroSkill&&(this.useingHeroSkill=this.callHeroSkill),this.callHeroSkill=0,MBase.getData(this.mid).setHeroSkillUse(this,this.useingHeroSkill)),this.getVO().skillcd<0?(this.skillTimes+=1e3,this.getVO().skillcd+this.skillTimes>=0?this.lastSkill=Number.MAX_VALUE:this.lastSkill=t):this.lastSkill=t},t.prototype.move=function(){if(this.addSpeed)if(this.addSpeed>0)var t=1+this.addSpeed/100;else var t=1+this.addSpeed/(100-this.addSpeed);else var t=1;this.x+=this.atkRota*Math.round(this.speed*t)/10,PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_MOVE,user:this})},t.prototype.stand=function(){PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_STAND,user:this})},t.prototype.getAtkTarget=function(){if("sys"==this.owner)return null;var t=PKData.getInstance();if(!this.canAtk())return null;var e=this.getVO().getAtkDis();if(this.target){if(this.target.canBeAtk(this)&&Math.abs(this.target.x-this.x)<e+this.target.getVO().width/2)return this.target;this.target=null}for(var i=0,n=t.monsterList,a=t.getPlayer(this.owner),r=0;r<n.length;r++){var o=n[r],s=t.getPlayer(o.owner);if(a.teamData.id!=s.teamData.id){var h=Math.abs(o.x-this.x);h<e+o.getVO().width/2&&o.canBeAtk(this)&&(!this.target||i>h)&&(this.target=o,i=h)}}return this.target},t.prototype.addAtkHurt=function(t){t>0&&(this.atkHurtCount+=t)},t.prototype.atkAction=function(t){this.listenerData=t,t.hp&&this.addAtkHurt(t.hp),this.getOwner().teamData.testState(PKConfig.LISTENER_ATK,this)},t.prototype.beAtkAction=function(t){this.addHp(-t.hp),MBase.getData(this.mid).beAtkAction(this,t),this.listenerData=t,this.getOwner().teamData.testState(PKConfig.LISTENER_BEATK,this),this.die&&t.atker&&MBase.getData(t.atker.mid).onKill(t.atker,this)},t.prototype.setDie=function(){this.hp=0,this.die=!0},t.prototype.addHp=function(t){if(0>t){if(this.nohitTimes)return this.nohitTimes--,void PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_NOHIT,user:this});if(this.manaHp&&(this.manaHp+=t,this.manaHp<0?(t=this.manaHp,this.manaHp=0):t=0,0==this.manaHp&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MANAHP_CHANGE,user:this})),!t)return}this.hp+=t,this.hp<=0?this.die=!0:this.hp>this.maxHp&&(this.hp=this.maxHp),PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_HPCHANGE,user:this}),MBase.getData(this.mid).onHpChange(this)},t.prototype.getHpRate=function(){return this.hp/this.maxHp},t.prototype.onDie=function(){if(!this.passEnd){for(var t=0;t<this.buff.length;t++){var e=this.buff[t];if(e.ing&&e.haveState&&e.state[PKConfig.STATE_DIE]){var i=parseInt((e.id+"").split("_").shift());MBase.getData(i).onBuff(e)}}MBase.getData(this.mid).onDie(this)}this.getOwner().teamData.testState(PKConfig.LISTENER_DIE,this),MBase.getData(this.mid).onRemove(this),PKData.getInstance().actionRecord.push("die|"+PKData.getInstance().actionTime+"|"+this.id+"|"+this.passEnd)},t.prototype.getSkillValue=function(t,e){void 0===e&&(e=!1);var i=PKData.getInstance();return CM.getCardVO(this.mid).getSkillValue(t,e?i.getPlayer(this.owner).force:0)},t}();__reflect(PKMonsterData.prototype,"PKMonsterData");var PKPlayerData=function(){function t(t){t&&this.fill(t),this.nick?this.nick=Base64.decode(this.nick):this.nick="守卫者"+this.id}return t.prototype.fill=function(t){t=ObjectUtil.clone(t);for(var e in t)this[e]=t[e];this.autoList=t.autolist.split(","),MonsterVO.getObject(this.autoList[0]).preLoad()},t.prototype.getMonsterForce=function(t){return this.force},t.prototype.addMonster=function(){if(0!=this.autoList.length){var t=this.autoList.shift();this.autoList[0]&&MonsterVO.getObject(this.autoList[0]).preLoad();var e=this.teamData.atkRota,i=e==PKConfig.ROTA_LEFT?PKConfig.appearPos:PKConfig.floorWidth+PKConfig.appearPos;PKData.getInstance().addMonster({force:this.force,mid:t,owner:this.id,atkRota:e,fromPos:!0,x:i,y:-25+50*Math.random(),actionTime:PKData.getInstance().actionTime})}},t}();__reflect(PKPlayerData.prototype,"PKPlayerData");var MsgingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Config.isDebug&&MyWindow.Alert(Net.getInstance().actionRecord.join("\n"))},e),e}return __extends(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.getInstance2=function(){return this.instance2||(this.instance2=new e),this.instance2},e.prototype.createView=function(){this.shape=new eui.Rect,this.shape.width=640,this.shape.fillColor=0,this.shape.fillAlpha=.3,this.shape.touchEnabled=!0,this.addChild(this.shape),this.loadingMC=new eui.Image,this.loadingMC.source="ui_loading_png",this.addChild(this.loadingMC),this.loadingMC.x=320,this.loadingMC.anchorOffsetX=35,this.loadingMC.anchorOffsetY=35},e.prototype.show=function(){this.showTimer=egret.getTimer(),GameManager.container.addChild(this),this.width=640,this.height=GameManager.stage.stageHeight,this.shape.height=GameManager.stage.stageHeight,this.loadingMC.y=this.height/2-100,egret.Tween.removeTweens(this.loadingMC);var t=egret.Tween.get(this.loadingMC,{loop:!0});t.to({rotation:0}).to({rotation:360},1e3),this.alpha=0,egret.clearTimeout(this.timer),this.timer=egret.setTimeout(function(){this.alpha=1},this,200)},e.prototype.hide=function(){egret.Tween.removeTweens(this.loadingMC),MyTool.removeMC(this)},e}(egret.Sprite);__reflect(MsgingUI.prototype,"MsgingUI");var PKTeamData=function(){function t(t){this.atkRota=0,this.hp=0,this.def=0,this.autoDef=0,this.toFront=0,this.killNum=0,this.bornNum=0,this.members=[],this.posList=[],this.stateObj={},t&&this.fill(t)}return t.prototype.fill=function(t){for(var e in t)this[e]=t[e]},t.prototype.reInit=function(){},t.prototype.getTeamDef=function(){return Math.floor(this.def/5)+this.autoDef},t.prototype.addStateLister=function(t){this.stateObj[t.type]||(this.stateObj[t.type]=[]),this.stateObj[t.type].push(t)},t.prototype.testState=function(t,e){if(this.stateObj[t]&&0!=this.stateObj[t].length)for(var i=0;i<this.stateObj[t].length;i++){var n=this.stateObj[t][i];n.actionFun(e)}},t.prototype.removeStateListener=function(t){var e=t.type;e&&this.stateObj[e]&&0!=this.stateObj[e].length&&(ArrayUtil.removeItem(this.stateObj[e],t),t.onRemove())},t.prototype.removeStateListerByOwner=function(t){for(var e in this.stateObj)for(var i=0;i<this.stateObj[e].length;i++){var n=this.stateObj[e][i];n.stopDieRemove||n.owner!=t||(this.stateObj[e].splice(i,1),i--,n.onRemove())}},t.prototype.onStateTimer=function(){for(var t in this.stateObj)for(var e=0;e<this.stateObj[t].length;e++){var i=this.stateObj[t][e];i.endTime&&i.endTime<=PKData.getInstance().actionTime?(this.stateObj[t].splice(e,1),e--,i.onRemove()):parseInt(t)==PKConfig.LISTENER_TIMER&&this.stateObj[t][e].actionFun()}},t}();__reflect(PKTeamData.prototype,"PKTeamData");var M99=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onCreate=function(t){t.momian=!0},e.prototype.beAtkAction=function(t,e){e.atker.getOwner().teamData.def++,PKData.getInstance().addVideo({type:PKConfig.VIDEO_TEAM_DEF,user:e.atker}),PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ATK,user:t}),t.die&&(PKData.getInstance().currentState="pk",PKData.getInstance().addVideo({type:PKConfig.VIDEO_TEAM_DEF2,user:e.atker}))},e}(MBase);__reflect(M99.prototype,"M99");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.shareMessage=function(t,e,i,n,a){},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var M1=function(t){function e(){var e=t.call(this)||this;return e.mvID1=103,e}return __extends(e,t),e.prototype.skill=function(t,e){var i=Math.ceil(t.getSkillValue(2,!0));e.beAtkAction({hp:i,atker:t}),t.atkAction({hp:i})},e.prototype.testTarget=function(t,e){if(!t.beSkillAble())return!1;var i=Math.abs(e[0].x-t.x);return i<=e[1]?(t.temp=i,!0):void 0},e.prototype.getSkillTarget=function(t){var e=PKData.getInstance(),i=t.getVO().getAtkDis()+50,n=e.getMonsterByTeam(t.getOwner().teamData.enemy,this.testTarget,[t,i]),a=t.getSkillValue(1);return n.length>a&&(n.length=a),n},e}(MBase);__reflect(M1.prototype,"M1");var M10=function(t){function e(){var e=t.call(this)||this;return e.mvID1=128,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkAble=!1},e.prototype.skill=function(t,e){e.addHp(t.getSkillValue(1,!0))},e.prototype.getSkillTarget=function(t){for(var e,i=PKData.getInstance(),n=i.getMonsterByTeam(t.getOwner().teamData),a=t.getVO().getAtkDis()+100,r=0;r<n.length;r++){var o=n[r];if(!(o.hp>=o.maxHp)){var s=Math.abs(t.x-o.x);a>=s&&(o.temp=o.getHpRate(),(!e||e.temp>o.temp)&&(e=o))}}return e?[e]:[]},e}(MBase);__reflect(M10.prototype,"M10");var M11=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onCreate=function(t){t.momian=!0},e}(MBase);__reflect(M11.prototype,"M11");var M12=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(n&&i.beSkillAble()){var a=e.getSkillValue(1),r=new PKBuffData;r.id=12,r.isDebuff=!0,r.value=a,r.addValue("atk",-Math.floor(i.baseAtk*a/100)),r.addValue("def",-a),r.user=e,r.endTime=PKData.getInstance().actionTime+1e3*e.getSkillValue(2),i.addBuff(r),r.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:i,keys:["atk-","def-"]})}return n},e}(MBase);__reflect(M12.prototype,"M12");var M13=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkAble=!1},e.prototype.onCreate=function(t){var e=new M13StateListener;e.owner=t,t.getOwner().teamData.addStateLister(e)},e.prototype.onRemove=function(t){t.getOwner().teamData.removeStateListerByOwner(t)},e}(MBase);__reflect(M13.prototype,"M13");var M13StateListener=function(t){function e(){var e=t.call(this)||this;return e.type=PKConfig.LISTENER_TIMER,e.actionTime=PKData.getInstance().actionTime,e}return __extends(e,t),e.prototype.actionFun=function(t){if(!(PKData.getInstance().actionTime-this.actionTime<500)){this.actionTime=PKData.getInstance().actionTime;for(var e=this.owner,i=PKData.getInstance(),n=i.getMonsterByTeam(e.getOwner().teamData.enemy),a=e.getSkillValue(1),r=[],o=0;o<n.length;o++){var s=n[o];if(s.beSkillAble()){var h=Math.abs(e.x-s.x);a>=h&&s.addHp(-Math.ceil(e.getSkillValue(2,!0)*e.getAtkRate(s)*.5))}}return r}},e}(PKStateListener);__reflect(M13StateListener.prototype,"M13StateListener");var M14=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.beAtkAction=function(t,e){if(e.atker&&e.atker.getVO().isNearAtk()){var i=Math.ceil(e.hp*t.getSkillValue(1)/100);e.atker.addHp(-i),t.addHp(i)}},e}(MBase);__reflect(M14.prototype,"M14");var M15=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);return n&&(e.atk+=Math.ceil(e.baseAtk*e.getSkillValue(1)/100)),n},e}(MBase);__reflect(M15.prototype,"M15");var M16=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);return n&&this.addBuff(e,i),n},e.prototype.beAtkAction=function(t,e){var i=e.atker;i&&i.getVO().isNearAtk()&&this.addBuff(t,i)},e.prototype.addBuff=function(t,e){if(e.beSkillAble()){var i=t.getSkillValue(1,!0),n=new PKBuffData;n.id=16,n.isDebuff=!0,n.value=i,n.addValue("hpChange",-i),n.user=t,n.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),e.addBuff(n),n.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:e,keys:["hp-"]})}},e}(MBase);__reflect(M16.prototype,"M16");var M17=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.beAtkAction=function(t,e){e.atker&&e.atker.addHp(-Math.ceil(t.getSkillValue(1,!0)*t.getAtkRate(e.atker)))},e}(MBase);__reflect(M17.prototype,"M17");var M18=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.hpChange+=t.getSkillValue(1,!0)},e}(MBase);__reflect(M18.prototype,"M18");var M2=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.missRate=t.getSkillValue(1)/100},e}(MBase);__reflect(M2.prototype,"M2");var M3=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.preload=function(){AtkMVCtrl.getInstance().preLoadPNG("monster/enemy3_attack.png")},e.prototype.atkAction=function(e,i,n){t.prototype.atkAction.call(this,e,i,n);var a=n+this.getAtkArriveCD(e,i)+50;this.sendAtkAction(e,i,n,a);var a=a+50;this.sendAtkAction(e,i,n,a)},e.prototype.getAtkArriveCD=function(t,e){return Math.abs(t.x-e.x)+200},e}(MBase);__reflect(M3.prototype,"M3");var M4=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(n&&PKData.getInstance().random()<e.getSkillValue(1)/100){var a=new PKBuffData;a.user=e,a.isDebuff=!0,a.addState(PKConfig.STATE_YUN),a.endTime=PKData.getInstance().actionTime+1e3*e.getSkillValue(2),i.addBuff(a)}return n},e}(MBase);__reflect(M4.prototype,"M4");var M5=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.doubleRate=t.getSkillValue(1)/100,t.doubleValue=t.getSkillValue(2)/100},e}(MBase);__reflect(M5.prototype,"M5");var M6=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(!n)return!1;for(var a=e.x<i.x,r=PKData.getInstance(),o=r.getMonsterByTeam(e.getOwner().teamData.enemy),s=e.getVO().getAtkDis()+e.getSkillValue(2),h=e.getSkillValue(1)/100,c=0;c<o.length;c++){var l=o[c];if(l!=i){if(a){if(e.x>l.x)continue}else if(e.x<l.x)continue;if(l.canBeAtk(e)){var u=Math.abs(e.x-l.x);if(!(u>s+l.getVO().width/2)){var d=Math.ceil(this.getAtkHp(e,l)*h);l.beAtkAction({hp:d}),e.addAtkHurt(d)}}}}return!0},e}(MBase);__reflect(M6.prototype,"M6");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var M8=function(t){function e(){var e=t.call(this)||this;return e.mvID1=119,e}return __extends(e,t),e.prototype.initMonster=function(t){t.doubleValue=t.getSkillValue(1)/100},e.prototype.atkAction=function(e,i,n){i.dieTime&&(e.doubleRate=1),t.prototype.atkAction.call(this,e,i,n),e.doubleRate=0},e.prototype.skill=function(t,e){e.owner=t.owner,e.atkRota=t.atkRota,PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_CHANGE_TEAM,user:e})},e.prototype.getSkillTarget=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData.enemy),n=300,a=0;a<i.length;a++){var r=i[a];if(r.dieTime&&!(r.hp>=t.getSkillValue(2,!0))&&r.beSkillAble()){var o=Math.abs(t.x-r.x);if(n>=o)return[r]}}return[]},e}(MBase);__reflect(M8.prototype,"M8");var M9=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onCreate=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData),n=t.getSkillValue(1)/100,a=0;a<i.length;a++){var r=i[a],o=new PKBuffData;o.id=9,o.user=t,o.addValue("atk",Math.max(1,Math.floor(r.baseAtk*n))),r.addBuff(o),o.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:r,keys:["atk+"]})}var s=new M9StateListener;s.owner=t,t.getOwner().teamData.addStateLister(s)},e.prototype.onRemove=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData),n=0;n<i.length;n++){var a=i[n];a.cleanBuff(0,t)}t.getOwner().teamData.removeStateListerByOwner(t)},e}(MBase);__reflect(M9.prototype,"M9");var M9StateListener=function(t){function e(){var e=t.call(this)||this;return e.type=PKConfig.LISTENER_CREATE,e}return __extends(e,t),e.prototype.actionFun=function(t){var e=this.owner.getSkillValue(1)/100,i=new PKBuffData;i.id=9,i.user=this.owner,i.addValue("atk",Math.max(1,Math.floor(t.baseAtk*e))),t.addBuff(i),i.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:t,keys:["atk+"]})},e}(PKStateListener);__reflect(M9StateListener.prototype,"M9StateListener");var M31=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkY=-30},e.prototype.getAtkArriveCD=function(t,e){return Math.abs(t.x-e.x)+100},e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(n&&PKData.getInstance().random()<e.getSkillValue(1)/100){var a=new PKBuffData;a.user=e,a.isDebuff=!0,a.addState(PKConfig.STATE_YUN),a.endTime=PKData.getInstance().actionTime+1e3*e.getSkillValue(2),i.addBuff(a)}return n},e}(MBase);__reflect(M31.prototype,"M31");var M32=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkY=-30},e.prototype.getAtkArriveCD=function(t,e){return Math.abs(t.x-e.x)+100},e.prototype.onCreate=function(t){var e=new M32StateListener;e.owner=t,t.getOwner().teamData.addStateLister(e)},e.prototype.onRemove=function(t){t.getOwner().teamData.removeStateListerByOwner(t)},e}(MBase);__reflect(M32.prototype,"M32");var M32StateListener=function(t){function e(){var e=t.call(this)||this;return e.type=PKConfig.LISTENER_TIMER,e.actionTime=PKData.getInstance().actionTime,e}return __extends(e,t),e.prototype.actionFun=function(t){if(!(PKData.getInstance().actionTime-this.actionTime<1e3)){this.actionTime=PKData.getInstance().actionTime;for(var e=this.owner,i=PKData.getInstance(),n=i.getMonsterByTeam(e.getOwner().teamData),a=e.getSkillValue(1),r=[],o=e.getSkillValue(2,!0),s=0;s<n.length;s++){var h=n[s],c=Math.abs(e.x-h.x);if(a>=c){if(h.skillTemp[32]||(h.skillTemp[32]=[]),h.skillTemp[32].length>=3)for(;h.skillTemp[32][0]&&PKData.getInstance().actionTime-h.skillTemp[32][0]>1e3;)h.skillTemp[32].shift();if(h.skillTemp[32].length>=3)continue;h.skillTemp[32].push(this.actionTime),h.addHp(o)}}return r}},e}(PKStateListener);__reflect(M32StateListener.prototype,"M32StateListener");var M33=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkY=-30},e.prototype.getAtkArriveCD=function(t,e){return Math.abs(t.x-e.x)+100},e.prototype.atk=function(e,i){var n=Math.floor((1-i.getHpRate())*i.maxHp*.15),a=t.prototype.atk.call(this,e,i);return a&&99!=i.mid&&n>0&&(n=Math.min(n,e.getSkillValue(1,!0)),i.beAtkAction({hp:n}),e.addAtkHurt(n),PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_DOUBLE,user:e,value:n})),a},e}(MBase);__reflect(M33.prototype,"M33");var M34=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkY=-30},e.prototype.getAtkArriveCD=function(t,e){return Math.abs(t.x-e.x)+100},e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(n&&i.beSkillAble()){var a=e.getSkillValue(1),r=new PKBuffData;r.id=34,r.isDebuff=!0,r.value=a,r.addValue("addSpeed",-a),r.user=e,r.endTime=PKData.getInstance().actionTime+1e3*e.getSkillValue(2),i.addBuff(r),r.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:i,keys:["speed-"]})}return n},e}(MBase);__reflect(M34.prototype,"M34");var M35=function(t){function e(){var e=t.call(this)||this;return e.mvID1=103,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkY=-30},e.prototype.getAtkArriveCD=function(t,e){return Math.abs(t.x-e.x)+100},e.prototype.skill=function(t,e){for(var i=PKData.getInstance(),n=35,a=i.getPlayer(t.owner),r=a.teamData.atkRota,o=1,s=0;o>s;s++){var h={force:a.getMonsterForce(n),mid:n,owner:t.owner,atkRota:r,x:t.x,y:-25+50*Math.random(),lastSkill:Number.MAX_VALUE,dieTime:i.actionTime+1e3*t.getSkillValue(1),actionTime:i.actionTime};i.addMonster(h)}},e.prototype.getSkillTarget=function(t){return t.getAtkTarget(),t.target?[null]:[]},e}(MBase);__reflect(M35.prototype,"M35");var M36=function(t){function e(){var e=t.call(this)||this;return e.mvID1=119,e}return __extends(e,t),e.prototype.onDie=function(t){if(!t.skillTemp[36]&&!t.reborning){t.reborning=!0;var e=PKData.getInstance();PKMonsterAction.getInstance().addAtkList({type:"skill_before",model:this,user:t,target:t,stopTestDie:!0,actionTime:e.actionTime,endTime:e.actionTime+1e3*t.getSkillValue(1)})}},e.prototype.sendSkillAction=function(t,e,i,n){PKMonsterAction.getInstance().addAtkList({type:"skill",user:t,target:e,stopTestDie:!0,actionTime:i,endTime:n})},e.prototype.skill=function(t,e){var i=PKData.getInstance(),n=36,a=i.getPlayer(t.owner),r=a.teamData.atkRota,o={force:a.getMonsterForce(n),mid:n,owner:t.owner,atkRota:r,x:t.x,y:t.y,lastSkill:Number.MAX_VALUE,actionTime:i.actionTime},s=i.addMonster(o);s.skillTemp[36]=!0;var h=AtkMVCtrl.getInstance().playAniOn(s.id,this.mvID1);h&&(h.y-=30)},e}(MBase);__reflect(M36.prototype,"M36");var M37=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(!n)return!1;for(var a=e.x<i.x,r=PKData.getInstance(),o=r.getMonsterByTeam(e.getOwner().teamData.enemy),s=e.getVO().getAtkDis()+e.getSkillValue(2),h=e.getSkillValue(1)/100,c=0;c<o.length;c++){var l=o[c];if(l!=i){if(a){if(e.x>l.x)continue}else if(e.x<l.x)continue;if(l.canBeAtk(e)){var u=Math.abs(e.x-l.x);if(!(u>s+l.getVO().width/2)){var d=Math.ceil(this.getAtkHp(e,l)*h);l.beAtkAction({hp:d}),e.addAtkHurt(d)}}}}return!0},e}(MBase);__reflect(M37.prototype,"M37");
var M38=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkY=10,t.atkX=30},e.prototype.getAtkArriveCD=function(t,e){return 2*Math.abs(t.x-e.x)+100},e.prototype.getSkillArriveCD=function(t,e){return 2*Math.abs(t.x-e.x)+100},e.prototype.skill=function(t,e){var i=Math.ceil(this.getAtkHp(t,e));e.beAtkAction({hp:i,atker:t}),t.atkAction({hp:i});var n=t.getSkillValue(1),a=new PKBuffData;a.isDebuff=!0,a.value=n,a.addValue("def",-n),a.addValue("addSpeed",-n),a.addValue("atk",-Math.floor(n/100*e.baseAtk)),a.user=t,a.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),e.addBuff(a),a.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:e,keys:["def-","speed-","atk-"]})},e.prototype.getSkillTarget=function(t){t.getAtkTarget();var e=t.target;return e&&e.beSkillAble()?[e]:[]},e}(MBase);__reflect(M38.prototype,"M38");var M39=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.beAtkAction=function(t,e){var i=e.atker;if(i&&i.getVO().isNearAtk()&&PKData.getInstance().random()<t.getSkillValue(1)/100){var n=new PKBuffData;n.user=t,n.isDebuff=!0,n.addState(PKConfig.STATE_YUN),n.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),i.addBuff(n)}},e}(MBase);__reflect(M39.prototype,"M39");var M40=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.beAtkAction=function(t,e){var i=e.atker;if(i&&i.getVO().isNearAtk()&&i.beSkillAble()){var n=t.getSkillValue(1),a=new PKBuffData;a.id=40,a.isDebuff=!0,a.value=n,a.addValue("def",-n),a.user=t,a.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),i.addBuff(a),a.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:i,keys:["def-"]})}},e}(MBase);__reflect(M40.prototype,"M40");var M41=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.beAtkAction=function(t,e){var i=e.atker;if(i&&i.getVO().isNearAtk()&&i.beSkillAble()){var n=t.getSkillValue(1),a=new PKBuffData;a.id=41,a.isDebuff=!0,a.value=n,a.addValue("addSpeed",-n),a.user=t,a.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),i.addBuff(a),a.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:i,keys:["speed-"]})}},e}(MBase);__reflect(M41.prototype,"M41");var M42=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onDie=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByNoTeam(t.getOwner().teamData),n=t.getSkillValue(1),a=t.getSkillValue(2,!0),r=1e3*t.getSkillValue(3),o=0;o<i.length;o++){var s=i[o];if(s.beSkillAble()){var h=Math.abs(t.x-s.x);if(h<=n+s.getVO().width/2){var c=new PKBuffData;c.id=16,c.isDebuff=!0,c.value=a,c.addValue("hpChange",-a),c.user=t,c.endTime=PKData.getInstance().actionTime+r,s.addBuff(c),c.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:s,keys:["hp-"]})}}}},e}(MBase);__reflect(M42.prototype,"M42");var M43=function(t){function e(){var e=t.call(this)||this;return e.mvID2=8,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=20,t.atkY=40},e.prototype.getAtkArriveCD=function(t,e){return 2*Math.abs(t.x-e.x)+200},e.prototype.skill=function(t,e){var i=new PKBuffData,n=t.getSkillValue(2,!0);i.id=43,i.value=n,i.user=t,i.addValue("hpChange",n),i.addState(PKConfig.STATE_MOMIAN),i.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(1),e.addBuff(i),PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:e,keys:["hp+","momian"]})},e.prototype.getSkillTarget=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData),n=t.getVO().getAtkDis()+100,a=0;a<i.length;a++){var r=i[a];if(!r.haveBuff(43)){var o=Math.abs(t.x-r.x);if(n>=o)return[r]}}return[]},e}(MBase);__reflect(M43.prototype,"M43");var M44=function(t){function e(){var e=t.call(this)||this;return e.mvID1=112,e.mvID2=8,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=20,t.atkY=40},e.prototype.getAtkArriveCD=function(t,e){return 2*Math.abs(t.x-e.x)+200},e.prototype.onKill=function(t,e){var i=PKData.getInstance(),n=i.getMonsterByTeam(t.getOwner().teamData.enemy),a=t.getSkillValue(1),r=t.getSkillValue(2,!0);e.stopReborn=!0;for(var o=0;o<n.length;o++){var s=n[o];if(s!=e&&s.canBeAtk(t)){var h=Math.abs(e.x-s.x);h>a||(s.beAtkAction({hp:r}),t.addAtkHurt(r))}}var c=AtkMVCtrl.getInstance().playAniOn(e.id,this.mvID1);c&&(c.scaleX=c.scaleY=1,c.y-=40)},e}(MBase);__reflect(M44.prototype,"M44");var M45=function(t){function e(){var e=t.call(this)||this;return e.mvID2=8,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=20,t.atkY=40},e.prototype.getAtkArriveCD=function(t,e){return 2*Math.abs(t.x-e.x)+200},e.prototype.skill=function(t,e){var i=t.getSkillValue(1),n=new PKBuffData;n.id=45,n.value=i,n.addValue("addSpeed",i),n.user=t,n.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),e.addBuff(n),n.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:e,keys:["speed+"]})},e.prototype.getSkillTarget=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData),n=t.getVO().getAtkDis()+100,a=0;a<i.length;a++){var r=i[a];if(!r.haveBuff(45)){var o=Math.abs(t.x-r.x);if(n>=o)return[r]}}return[]},e}(MBase);__reflect(M45.prototype,"M45");var M46=function(t){function e(){var e=t.call(this)||this;return e.mvID2=8,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=20,t.atkY=40},e.prototype.getAtkArriveCD=function(t,e){return 2*Math.abs(t.x-e.x)+200},e.prototype.skill=function(t,e){var i=t.getSkillValue(1),n=new PKBuffData;n.id=46,n.value=i,n.addValue("def",i),n.user=t,n.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),e.addBuff(n),n.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:e,keys:["def+"]})},e.prototype.getSkillTarget=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData),n=t.getVO().getAtkDis()+100,a=0;a<i.length;a++){var r=i[a];if(!r.haveBuff(46)){var o=Math.abs(t.x-r.x);if(n>=o)return[r]}}return[]},e}(MBase);__reflect(M46.prototype,"M46");var M47=function(t){function e(){var e=t.call(this)||this;return e.mvID1=104,e}return __extends(e,t),e.prototype.skill=function(t,e){var i=t.getSkillValue(1,!0);e.manaHp+=i,PKData.getInstance().addVideo({type:PKConfig.VIDEO_MANAHP_CHANGE,user:e})},e.prototype.getSkillTarget=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData),n=t.getVO().getAtkDis()+100,a=0;a<i.length;a++){var r=i[a];if(!(r.manaHp>0)){var o=Math.abs(t.x-r.x);if(n>=o)return[r]}}return[]},e}(MBase);__reflect(M47.prototype,"M47");var M48=function(t){function e(){var e=t.call(this)||this;return e.mvID1=200,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=40},e.prototype.getAtkArriveCD=function(t,e){return 100},e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(!n)return!1;for(var a=PKData.getInstance(),r=a.getMonsterByTeam(e.getOwner().teamData.enemy),o=e.getSkillValue(1),s=e.getSkillValue(2,!0),h=0;h<r.length;h++){var c=r[h];if(c!=i&&c.canBeAtk(e)){var l=Math.abs(i.x-c.x);l>o+c.getVO().width/2||(c.beAtkAction({hp:s}),e.addAtkHurt(s))}}return!0},e}(MBase);__reflect(M48.prototype,"M48");var M61=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atkBefore=function(t,e){var i=e+this.getAtkMVCD(t);this.sendAtkBefore(t,t,e,i)},e.prototype.getAtkArriveCD=function(t,e){return 300},e.prototype.atk=function(t,e){t.setDie();for(var i=PKData.getInstance(),n=i.getMonsterByNoTeam(t.getOwner().teamData),a=t.getSkillValue(1),r=0;r<n.length;r++){var o=n[r],s=Math.abs(t.x-o.x);if(s<=a+o.getVO().width/2){var h=this.getAtkHp(t,o);o.beAtkAction({hp:h,atker:t}),t.addAtkHurt(h);var c=new PKBuffData;c.user=t,c.isDebuff=!0,c.addState(PKConfig.STATE_YUN),c.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(2),o.addBuff(c)}}return!0},e}(MBase);__reflect(M61.prototype,"M61");var M62=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atkBefore=function(t,e){var i=e+this.getAtkMVCD(t);this.sendAtkBefore(t,t,e,i)},e.prototype.getAtkArriveCD=function(t,e){return 300},e.prototype.atk=function(t,e){t.setDie();for(var i=PKData.getInstance(),n=i.getMonsterByNoTeam(t.getOwner().teamData),a=t.getSkillValue(1),r=0;r<n.length;r++){var o=n[r],s=Math.abs(t.x-o.x);if(s<=a+o.getVO().width/2){var h=this.getAtkHp(t,o);if(o.beAtkAction({hp:h,atker:t}),t.addAtkHurt(h),o.beSkillAble()){var c=t.getSkillValue(2),l=new PKBuffData;l.id=62,l.isDebuff=!0,l.value=c,l.addValue("def",-c),l.user=t,l.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(3),o.addBuff(l),l.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:o,keys:["def-"]})}}}return!0},e}(MBase);__reflect(M62.prototype,"M62");var M63=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atkBefore=function(t,e){var i=e+this.getAtkMVCD(t);this.sendAtkBefore(t,t,e,i)},e.prototype.getAtkArriveCD=function(t,e){return 300},e.prototype.atk=function(t,e){t.setDie();for(var i=PKData.getInstance(),n=i.getMonsterByNoTeam(t.getOwner().teamData),a=t.getSkillValue(1),r=0;r<n.length;r++){var o=n[r],s=Math.abs(t.x-o.x);if(s<=a+o.getVO().width/2){var h=this.getAtkHp(t,o);if(o.beAtkAction({hp:h,atker:t}),t.addAtkHurt(h),o.beSkillAble()){var c=new PKBuffData;c.id=63,c.isDebuff=!0,c.user=t,c.addState(PKConfig.STATE_DIE),c.addState(PKConfig.STATE_ILL),c.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(3),c.value=t.getSkillValue(2,!0),o.addBuff(c)}}}return!0},e.prototype.onBuff=function(t){for(var e=PKData.getInstance(),i=t.user,n=t.owner,a=e.getMonsterByTeam(n.getOwner().teamData),r=i.getSkillValue(1),o=0;o<a.length;o++){var s=a[o],h=Math.abs(n.x-s.x);h<=r+s.getVO().width/2&&(s.beAtkAction({hp:t.value}),i.addAtkHurt(t.value))}},e}(MBase);__reflect(M63.prototype,"M63");var M64=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getAtkArriveCD=function(t,e){return Math.abs(t.x-e.x)+200},e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(n&&99!=i.mid){var a=e.getSkillValue(1,!0);i.beAtkAction({hp:a}),e.addAtkHurt(a),PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_DOUBLE,user:e,value:a})}return n},e}(MBase);__reflect(M64.prototype,"M64");var M65=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getSkillTarget=function(t){return[null]},e.prototype.skill=function(t,e){var i=PKData.getInstance(),n=65,a=i.getPlayer(t.owner),r=a.teamData.atkRota,o={force:a.getMonsterForce(n),mid:n,owner:t.owner,atkRota:r,x:t.x,y:-30+60*Math.random(),lastSkill:Number.MAX_VALUE,actionTime:i.actionTime};i.addMonster(o)},e}(MBase);__reflect(M65.prototype,"M65");var M66=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onKill=function(t,e){var i=PKData.getInstance(),n=65,a=i.getPlayer(t.owner),r=a.teamData.atkRota,o=t.getSkillValue(1);e.stopReborn=!0;for(var s=0;o>s;s++){var h={force:a.getMonsterForce(n),mid:n,owner:t.owner,atkRota:r,x:e.x,y:-30+60*Math.random(),lastSkill:Number.MAX_VALUE,dieTime:i.actionTime+1e3*t.getSkillValue(2),actionTime:i.actionTime};i.addMonster(h)}},e}(MBase);__reflect(M66.prototype,"M66");var M67=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.nohitTimes+=t.getSkillValue(1)},e}(MBase);__reflect(M67.prototype,"M67");var M68=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.preload=function(){AtkMVCtrl.getInstance().preLoadPNG("monster/enemy68_attack.png")},e.prototype.getAtkerAtk=function(e,i){var n=t.prototype.getAtkerAtk.call(this,e,i);return i.skillTemp[66]||(i.skillTemp[66]={}),i.skillTemp[66][e.id]||(i.skillTemp[66][e.id]=1),n*=i.skillTemp[66][e.id]},e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);return n&&(i.skillTemp[66][e.id]=i.skillTemp[66][e.id]*e.getSkillValue(1)),n},e}(MBase);__reflect(M68.prototype,"M68");var M69=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onDie=function(t){for(var e=PKData.getInstance(),i=e.getMonsterByTeam(t.getOwner().teamData),n=t.getSkillValue(1),a=0;a<i.length;a++){var r=i[a],o=Math.abs(t.x-r.x);if(o<=n+r.getVO().width/2){var s=t.getSkillValue(2),h=new PKBuffData;h.id=69,h.value=s,h.addValue("atk",Math.floor(r.baseAtk*s/100)),h.user=t,h.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(3),r.addBuff(h),h.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:r,keys:["atk+"]})}}},e}(MBase);__reflect(M69.prototype,"M69");var M70=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atkBefore=function(t,e){var i=e+this.getAtkMVCD(t);this.sendAtkBefore(t,t,e,i)},e.prototype.getAtkArriveCD=function(t,e){return 300},e.prototype.atk=function(t,e){t.setDie();for(var i=PKData.getInstance(),n=i.getMonsterByNoTeam(t.getOwner().teamData),a=t.getSkillValue(1),r=0;r<n.length;r++){var o=n[r],s=Math.abs(t.x-o.x);if(s<=a+o.getVO().width/2){var h=this.getAtkHp(t,o);if(o.beAtkAction({hp:h,atker:t}),t.addAtkHurt(h),o.beSkillAble()){var c=t.getSkillValue(2),l=new PKBuffData;l.isDebuff=!0,l.id=70,l.value=c,l.addValue("addSpeed",-c),l.user=t,l.endTime=PKData.getInstance().actionTime+1e3*t.getSkillValue(3),o.addBuff(l),l.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:o,keys:["speed-"]})}}}return!0},e}(MBase);__reflect(M70.prototype,"M70");var M71=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.getAtkHp=function(e,i){return 99==i.mid?1:t.prototype.getAtkHp.call(this,e,i)+Math.ceil(i.maxHp/100*e.getSkillValue(1))},e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(n&&99!=i.mid){var a=this.getAtkHp(e,i);PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_DOUBLE,user:e,value:a})}return n},e}(MBase);__reflect(M71.prototype,"M71");var M72=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=20,t.atkY=65},e.prototype.preload=function(){AtkMVCtrl.getInstance().preLoadPNG("monster/enemy72_attack.png")},e.prototype.getAtkArriveCD=function(t,e){return 1.5*Math.abs(t.x-e.x)+200},e.prototype.getSkillTarget=function(t){return[null]},e.prototype.skill=function(t,e){for(var i=PKData.getInstance(),n=65,a=i.getPlayer(t.owner),r=a.teamData.atkRota,o=t.getSkillValue(1),s=0;o>s;s++){var h={force:a.getMonsterForce(n),mid:n,owner:t.owner,atkRota:r,x:t.x,y:-25+50*Math.random(),lastSkill:Number.MAX_VALUE,dieTime:i.actionTime+1e3*t.getSkillValue(2),actionTime:i.actionTime};i.addMonster(h)}},e}(MBase);__reflect(M72.prototype,"M72");var M73=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atk=function(e,i){var n=t.prototype.atk.call(this,e,i);if(n){var a=this.getAtkHp(e,i);e.addHp(Math.ceil(a/100*e.getSkillValue(1)))}return n},e}(MBase);__reflect(M73.prototype,"M73");var M74=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=20,t.atkY=65},e.prototype.preload=function(){AtkMVCtrl.getInstance().preLoadPNG("monster/enemy72_attack.png")},e.prototype.getAtkArriveCD=function(t,e){return 1.5*Math.abs(t.x-e.x)+200},e.prototype.getSkillTarget=function(t){return[null]},e.prototype.skill=function(t,e){for(var i=PKData.getInstance(),n=64,a=i.getPlayer(t.owner),r=a.teamData.atkRota,o=t.getSkillValue(1),s=0;o>s;s++){var h={force:a.getMonsterForce(n),mid:n,owner:t.owner,atkRota:r,x:t.x,y:-25+50*Math.random(),lastSkill:Number.MAX_VALUE,dieTime:i.actionTime+1e3*t.getSkillValue(2),actionTime:i.actionTime};i.addMonster(h)}},e}(MBase);__reflect(M74.prototype,"M74");var M75=function(t){function e(){var e=t.call(this)||this;return e.bulleteID=1,e}return __extends(e,t),e.prototype.initMonster=function(t){t.atkX=80},e.prototype.getAtkArriveCD=function(t,e){return 1e3},e.prototype.atk=function(t,e){return!1},e.prototype.sendAtkBefore=function(t,e,i,n){PKMonsterAction.getInstance().addAtkList({type:"atk_before",model:this,stopTestDie:!0,user:t,target:e,actionTime:i,endTime:n})},e.prototype.sendAtkAction=function(e,i,n,a){t.prototype.sendAtkAction.call(this,e,i,n,a);var r=new M75StateListener;r.owner=e,r.stopDieRemove=!0,r.endTime=n+this.getAtkArriveCD(e,i),r.id=this.bulleteID,r.beginX=e.x,i.x>e.x?(r.beginX+=e.atkX,r.targetX=r.beginX+e.getSkillValue(1)):(r.beginX-=e.atkX,r.targetX=r.beginX-e.getSkillValue(1)),this.bulleteID++,e.getOwner().teamData.addStateLister(r)},e}(MBase);__reflect(M75.prototype,"M75");var M75StateListener=function(t){function e(){var e=t.call(this)||this;return e.type=PKConfig.LISTENER_TIMER,e.actionTime=PKData.getInstance().actionTime,e}return __extends(e,t),e.prototype.actionFun=function(t){for(var e=PKData.getInstance(),i=this.owner,n=e.getMonsterByNoTeam(i.getOwner().teamData),a=0,r=this.beginX+(this.targetX-this.beginX)*(e.actionTime-this.actionTime)/(this.endTime-this.actionTime),o=0;o<n.length;o++){var s=n[o];if(s.skillTemp[75]||(s.skillTemp[75]={}),!s.skillTemp[75][this.id]&&Math.abs(r-s.x)<=a+s.getVO().width/2){s.skillTemp[75][this.id]=!0;var h=MBase.getData(75).getAtkHp(i,s);s.beAtkAction({hp:h,atker:i}),i.addAtkHurt(h)}}},e}(PKStateListener);__reflect(M75StateListener.prototype,"M75StateListener");var M76=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.atkBefore=function(t,e){var i=e+this.getAtkMVCD(t);this.sendAtkBefore(t,t,e,i)},e.prototype.getAtkArriveCD=function(t,e){return 300},e.prototype.atk=function(t,e){t.setDie();for(var i=PKData.getInstance(),n=i.getMonsterByNoTeam(t.getOwner().teamData),a=t.getSkillValue(1),r=t.getSkillValue(2,!0),o=1e3*t.getSkillValue(3),s=0;s<n.length;s++){var h=n[s],c=Math.abs(t.x-h.x);if(c<=a+h.getVO().width/2){var l=this.getAtkHp(t,h);if(h.beAtkAction({hp:l,atker:t}),t.addAtkHurt(l),h.beSkillAble()){var u=new PKBuffData;u.id=76,u.value=r,u.addValue("hpChange",-r),u.user=t,u.endTime=PKData.getInstance().actionTime+o,h.addBuff(u),u.ing&&PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_ADD_STATE,user:h,keys:["hp-"]})}}}return!0},e}(MBase);__reflect(M76.prototype,"M76");var M77=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.preload=function(){AtkMVCtrl.getInstance().preLoadPNGLocal("enemy78_png")},e.prototype.initMonster=function(t){t.atkAble=!1},e.prototype.onHpChange=function(t){!t.skillTemp[77]&&t.getHpRate()<.5&&(t.skillTemp[77]=!0,t.addSpeed+=100,PKData.getInstance().addVideo({type:PKConfig.VIDEO_MONSTER_CHANGE_SKIN,user:t,skin:78}))},e}(MBase);__reflect(M77.prototype,"M77");var M78=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(MBase);__reflect(M78.prototype,"M78");var AtkMVCtrl=function(){function t(){}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.preLoadMV=function(t){AniManager.getInstance().preLoadMV(t)},t.prototype.preLoadPNG=function(t){},t.prototype.preLoadPNGLocal=function(t){},t.prototype.playAniOn=function(t,e){return PKVideoCon.getInstance().stage?PKVideoCon.getInstance().playAniOn(t,e):void 0},t.prototype.mAtkMV=function(t,e,i,n,a){PKVideoCon.getInstance().stage&&this["atkMV"+t]&&this["atkMV"+t](e,i,n,a)},t.prototype.mSkillMV=function(t,e,i,n,a){PKVideoCon.getInstance().stage&&this["skillMV"+t]&&this["skillMV"+t](e,i,n,a)},t.prototype.sSkillMV=function(t,e){PKVideoCon.getInstance().stage&&this["skillMV"+t]&&this["skillMV"+t](e)},t.prototype.atkMV1=function(t,e,i,n){var a=MBase.getData(1);this.playAniOn(e.id,a.mvID1)},t.prototype.atkMV3=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id),o=PKBulletManager.getInstance().createBullet(a,r,i,n),s=o.mc;s.source="enemy3_attack_png",s.anchorOffsetX=27.5,s.anchorOffsetY=15;var h=egret.Tween.get(s,{loop:!0});h.to({rotation:360},300)},t.prototype.atkMV31=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createBullet(a,r,i,n,5)},t.prototype.atkMV32=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createBullet(a,r,i,n,7)},t.prototype.atkMV33=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createBullet(a,r,i,n,1)},t.prototype.atkMV34=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createBullet(a,r,i,n,3)},t.prototype.atkMV35=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createBullet(a,r,i,n,2)},t.prototype.atkMV38=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createBullet(a,r,i,n,9)},t.prototype.atkMV43=function(t,e,i,n){var a=MBase.getData(43),r=PKVideoCon.getInstance().getItemByID(t.id),o=PKVideoCon.getInstance().getItemByID(e.id),s=PKBulletManager.getInstance().createBulletAni(r,o,i,n,a.mvID2);s.needRota=!1,s.targetOffsetY=e.getVO().height/2,s.mc.scaleX=s.mc.scaleY=.6},t.prototype.atkMV44=function(t,e,i,n){var a=MBase.getData(44),r=PKVideoCon.getInstance().getItemByID(t.id),o=PKVideoCon.getInstance().getItemByID(e.id),s=PKBulletManager.getInstance().createBulletAni(r,o,i,n,a.mvID2);s.needRota=!1,s.targetOffsetY=e.getVO().height/2,s.mc.scaleX=s.mc.scaleY=.6},t.prototype.atkMV45=function(t,e,i,n){var a=MBase.getData(45),r=PKVideoCon.getInstance().getItemByID(t.id),o=PKVideoCon.getInstance().getItemByID(e.id),s=PKBulletManager.getInstance().createBulletAni(r,o,i,n,a.mvID2);s.needRota=!1,s.targetOffsetY=e.getVO().height/2,s.mc.scaleX=s.mc.scaleY=.6},t.prototype.atkMV46=function(t,e,i,n){var a=MBase.getData(46),r=PKVideoCon.getInstance().getItemByID(t.id),o=PKVideoCon.getInstance().getItemByID(e.id),s=PKBulletManager.getInstance().createBulletAni(r,o,i,n,a.mvID2);s.needRota=!1,s.targetOffsetY=e.getVO().height/2,s.mc.scaleX=s.mc.scaleY=.6},t.prototype.atkMV47=function(t,e,i,n){var a=MBase.getData(47);this.playAniOn(e.id,a.mvID1)},t.prototype.atkMV48=function(t,e,i,n){var a=MBase.getData(48),r=PKVideoCon.getInstance().getItemByID(t.id),o=PKVideoCon.getInstance().getItemByID(e.id),s=this.playAniOn(t.id,a.mvID1);s&&(s.scaleY=1,r.x>o.x?(s.scaleX=-1,s.x-=30):(s.scaleX=1,s.x+=30),s.y-=70)},t.prototype.atkMV61=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id);egret.Tween.get(a).to({x:a.x+50*t.atkRota},300)},t.prototype.atkMV62=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id);egret.Tween.get(a).to({x:a.x+50*t.atkRota},300)},t.prototype.atkMV63=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id);egret.Tween.get(a).to({x:a.x+50*t.atkRota},300)},t.prototype.atkMV64=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createArrow(a,r,i,n)},t.prototype.atkMV68=function(t,e,i,n){var a=AniManager.getInstance(),r=a.getImg("enemy68_attack_png");r.anchorOffsetX=32.5,r.anchorOffsetY=30;var o=egret.Tween.get(r);o.to({rotation:720},200).set({rotation:0}).to({rotation:720,scaleX:.1,scaleY:.1},100).call(function(){a.removeImg(r)});var s=PKVideoCon.getInstance().getItemByID(t.id);r.x=s.x+20*t.atkRota,r.y=s.y-40,s.parent.addChildAt(r,s.parent.getChildIndex(s)+1)},t.prototype.atkMV70=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id);egret.Tween.get(a).to({x:a.x+50*t.atkRota},300)},t.prototype.atkMV72=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id),o=PKBulletManager.getInstance().createBulletAni2(a,r,i,n);o.mc.anchorOffsetX=70,o.mc.anchorOffsetY=90,o.targetOffsetY=e.getVO().height/2,a.x>r.x?o.mc.scaleX=1:o.mc.scaleX=-1,o.mc.load("enemy72_attack_png",0,560,90),o.mc.play()},t.prototype.atkMV74=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id),o=PKBulletManager.getInstance().createBulletAni2(a,r,i,n);o.mc.anchorOffsetX=70,o.mc.anchorOffsetY=90,o.targetOffsetY=e.getVO().height/2,a.x>r.x?o.mc.scaleX=1:o.mc.scaleX=-1,o.mc.load("enemy72_attack_png",0,560,90),o.mc.play()},t.prototype.atkMV75=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r={x:t.x+t.atkRota*t.getSkillValue(1),y:t.y};PKBulletManager.getInstance().createBulletLine(a,r,i,n,"pk_arrow_1_png")},t.prototype.atkMV76=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id);egret.Tween.get(a).to({x:a.x+50*t.atkRota},300)},t.prototype.atkMV111=function(t,e,i,n){var a=MBase.getData(111),r=PKVideoCon.getInstance().getItemByID(t.id),o=PKVideoCon.getInstance().getItemByID(e.id),s=this.playAniOn(t.id,a.mvID1);s&&(s.scaleY=1,r.x>o.x?(s.scaleX=-1,s.x-=t.atkX):(s.scaleX=1,s.x+=t.atkX),s.y-=90)},t.prototype.atkMV112=function(t,e,i,n){var a=MBase.getData(112),r=PKVideoCon.getInstance().getItemByID(t.id),o=PKVideoCon.getInstance().getItemByID(e.id),s=this.playAniOn(t.id,a.mvID1);s&&(s.scaleY=1,r.x>o.x?(s.scaleX=-1,s.x-=t.atkX):(s.scaleX=1,s.x+=t.atkX),s.y-=90)},t.prototype.skillMV1=function(t,e,i,n){this.atkMV1(t,e,i,n)},t.prototype.skillMV3=function(t,e,i,n){this.atkMV3(t,e,i,n)},t.prototype.skillMV8=function(t,e,i,n){var a=MBase.getData(8);this.playAniOn(e.id,a.mvID1)},t.prototype.skillMV10=function(t,e,i,n){var a=MBase.getData(10),r=this.playAniOn(e.id,a.mvID1);r&&(r.y-=40)},t.prototype.skillMV38=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(t.id),r=PKVideoCon.getInstance().getItemByID(e.id);PKBulletManager.getInstance().createBullet(a,r,i,n,10)},t.prototype.skillMV101=function(t,e,i,n){var a=MBase.getData(101);4==t.useingHeroSkill&&this.playAniOn(e.id,a.mvID1)},t.prototype.skillMV102=function(t,e,i,n){var a=PKVideoCon.getInstance().getItemByID(e.id),r=[1,6,3,2,5][Math.min(4,t.level)];PKBulletManager.getInstance().createBullet(null,a,i,n,r)},t.prototype.skillMV108=function(t,e,i,n){var a=MBase.getData(108);(3==t.useingHeroSkill||2==t.useingHeroSkill)&&this.playAniOn(e.id,a.mvID1)},t.prototype.skillMV116=function(t,e,i,n){var a=MBase.getData(116);if(3==t.useingHeroSkill||4==t.useingHeroSkill){var r=this.playAniOn(e.id,a.mvID1);r&&(r.y-=40)}},t.prototype.skillMV114=function(t,e,i,n){var a=MBase.getData(114),r=this.playAniOn(e.id,a.mvID1);r.y-=e.getVO().height/2},t}();__reflect(AtkMVCtrl.prototype,"AtkMVCtrl");var PKBulletManager=function(){function t(){this.arrowPool=[],this.bulletPool=[],this.bulletAniPool=[],this.bulletAniPool2=[],this.bulletLinePool=[],this.useItem=[]}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.createArrow=function(t,e,i,n,a){var r=this.arrowPool.pop();r||(r=new ArrowMC),r.init(t,e,i,n,a);var o=t.parent;return o.addChildAt(r,o.getChildIndex(t)+1),this.useItem.push(r),r},t.prototype.createBullet=function(t,e,i,n,a){var r=this.bulletPool.pop();r||(r=new BulletMC),r.init(t,e,i,n,a),t||(t=e);var o=t.parent;return o.addChildAt(r,o.getChildIndex(t)+1),this.useItem.push(r),r},t.prototype.createBulletAni=function(t,e,i,n,a){var r=this.bulletAniPool.pop();r||(r=new BulletAniMC),r.init(t,e,i,n,a);var o=t.parent;return o.addChildAt(r,o.getChildIndex(t)+1),this.useItem.push(r),r},t.prototype.createBulletLine=function(t,e,i,n,a,r){var o=this.bulletLinePool.pop();o||(o=new BulletMCLine),o.init(t,e,i,n,a,r);var s=t.parent;return s.addChildAt(o,s.getChildIndex(t)+1),this.useItem.push(o),o},t.prototype.createBulletAni2=function(t,e,i,n){var a=this.bulletAniPool2.pop();a||(a=new BulletAniMC2),a.init(t,e,i,n);var r=e.parent;return r.addChildAt(a,r.getChildIndex(e)+1),this.useItem.push(a),a},t.prototype.freeItem=function(t){t&&(t.remove(),"arrow"==t.type?this.arrowPool.push(t):"bullet"==t.type?this.bulletPool.push(t):"bullet_ani"==t.type?this.bulletAniPool.push(t):"bullet_ani2"==t.type?this.bulletAniPool2.push(t):"bullet_line"==t.type&&this.bulletLinePool.push(t),ArrayUtil.removeItem(this.useItem,t))},t.prototype.actionAll=function(){for(var t=PKData.getInstance(),e=[],i=0;i<this.useItem.length;i++){var n=this.useItem[i];n.onAction(t.actionTime)||e.push(n)}for(var i=0;i<e.length;i++)this.freeItem(e[i])},t.prototype.freeAll=function(){for(;this.useItem.length;)this.freeItem(this.useItem[0])},t}();__reflect(PKBulletManager.prototype,"PKBulletManager");var ArrowMC=function(t){function e(){var e=t.call(this)||this;return e.type="arrow",e.mc=new eui.Image,e.mc.source="pk_arrow_png",e.mc.anchorOffsetX=30,e.mc.anchorOffsetY=25,e.addChild(e.mc),e}return __extends(e,t),e.prototype.init=function(t,e,i,n,a){this.fromMC=t,this.toMC=e,this.beginTime=i,this.endTime=n},e.prototype.onAction=function(t){if(t>this.endTime)return!1;var e=(t-this.beginTime)/(this.endTime-this.beginTime),i=Math.abs(this.toMC.x-this.fromMC.x),n=this.fromMC.y-this.fromMC.data.getVO().height/2,a=this.toMC.y-this.toMC.data.getVO().height/2;if(.5>=e)var r=i*e;else var r=i*(1-e);r=Math.pow(r,.6);var o=Math.pow(.5*i,.6);if(.5>=e)var s=o-r;else var s=-(o-r);return this.x=this.fromMC.x+(this.toMC.x-this.fromMC.x)*e,this.y=n+(a-n)*e-r,this.rotation=this.fromMC.x<this.toMC.x?-s:s,this.mc.scaleX=this.fromMC.x<this.toMC.x?1:-1,!0},e.prototype.remove=function(){MyTool.removeMC(this)},e}(egret.DisplayObjectContainer);__reflect(ArrowMC.prototype,"ArrowMC");var BulletMC=function(t){function e(){var e=t.call(this)||this;return e.type="bullet",e.mc=new eui.Image,e.rota=0,e.config={1:{w:25,h:75,rota:90},2:{w:25,h:120,rota:90},3:{w:25,h:120,rota:90},4:{w:25,h:80,rota:90},5:{w:25,h:120,rota:90},6:{w:25,h:120,rota:90},7:{w:25,h:120,rota:90},8:{w:20,h:57,rota:90},9:{w:18,h:18},10:{w:18,h:18}},e.mc.source="pk_arrow_png",e.mc.anchorOffsetX=30,e.mc.anchorOffsetY=25,e.addChild(e.mc),e}return __extends(e,t),e.prototype.init=function(t,e,i,n,a){this.id=a,this.fromMC=t,this.toMC=e,this.beginTime=i,this.endTime=n,this.rota=0,this.mc.rotation=0,this.scaleY=1,a&&(this.mc.source="bullet"+a+"_png",this.mc.anchorOffsetX=this.config[a].w/2,this.mc.anchorOffsetY=20,this.config[a].rota&&(this.rota=this.config[a].rota))},e.prototype.onAction=function(t){if(t>this.endTime)return!1;var e=(t-this.beginTime)/(this.endTime-this.beginTime),i=this.toMC.y-this.toMC.data.getVO().height/2;if(this.fromMC){var n=this.fromMC.y-this.fromMC.data.getVO().height/2+this.fromMC.data.atkY,a=this.fromMC.data.atkX*(this.toMC.x>this.fromMC.x?1:-1);if(this.x=this.fromMC.x+(this.toMC.x-this.fromMC.x-a)*e+a,this.y=n+(i-n)*e,this.rotation=this.getRota({x:this.fromMC.x,y:n},{x:this.toMC.x,y:i}),this.id&&this.config[this.id].rota){var r=1;this.id&&Math.abs(this.toMC.x-this.fromMC.x)<this.config[this.id].h&&(r=Math.abs(this.toMC.x-this.fromMC.x)/this.config[this.id].h),.5>e?this.scaleY=2*e*r:this.scaleY=2*(1-e)*r}}else this.x=this.toMC.x,this.y=i-300*(1-e),this.rotation=this.rota+90;return!0},e.prototype.getRota=function(t,e){return 180*Math.atan2(e.y-t.y,e.x-t.x)/3.14+this.rota},e.prototype.remove=function(){MyTool.removeMC(this),egret.Tween.removeTweens(this.mc)},e}(egret.DisplayObjectContainer);__reflect(BulletMC.prototype,"BulletMC");var BulletMCLine=function(t){function e(){var e=t.call(this)||this;return e.type="bullet_line",e.mc=new eui.Image,e.mc.source="",e.mc.anchorOffsetX=30,e.mc.anchorOffsetY=25,e.addChild(e.mc),e}return __extends(e,t),e.prototype.init=function(t,e,i,n,a,r){this.id=a,this.fromMC=t,this.toMC=e,this.beginTime=i,this.endTime=n,this.fun=r,this.mc.source=a},e.prototype.onAction=function(t){if(t>this.endTime)return!1;var e=(t-this.beginTime)/(this.endTime-this.beginTime),i=this.fromMC.y-this.fromMC.data.getVO().height/2+this.fromMC.data.atkY,n=(this.toMC.y,this.fromMC.data.atkX*(this.toMC.x>this.fromMC.x?1:-1));return this.x=this.fromMC.x+(this.toMC.x-this.fromMC.x-n)*e+n,this.y=i,this.fun&&this.fun(),!0
},e.prototype.remove=function(){MyTool.removeMC(this),egret.Tween.removeTweens(this.mc)},e}(egret.DisplayObjectContainer);__reflect(BulletMCLine.prototype,"BulletMCLine");var BulletAniMC=function(t){function e(){var e=t.call(this)||this;return e.type="bullet_ani",e.needRota=!0,e.targetOffsetY=0,e}return __extends(e,t),e.prototype.init=function(t,e,i,n,a){this.fromMC=t,this.toMC=e,this.beginTime=i,this.endTime=n;var r=AniManager.getInstance();this.mc&&r.removeMV(this.mc),this.mc=r.getAni(a),this.mc.scaleX=this.mc.scaleY=.3,this.mc.x=0,this.mc.y=0,this.addChild(this.mc),this.needRota=!0,this.targetOffsetY=0},e.prototype.onAction=function(t){if(t>this.endTime)return!1;var e=egret.Ease.sineIn((t-this.beginTime)/(this.endTime-this.beginTime)),i=this.fromMC.y-this.fromMC.data.getVO().height/2+this.fromMC.data.atkY,n=this.toMC.y-this.toMC.data.getVO().height/2+this.targetOffsetY,a=this.fromMC.data.atkX*(this.toMC.x>this.fromMC.x?1:-1);return this.x=this.fromMC.x+(this.toMC.x-this.fromMC.x-a)*e+a,this.y=i+(n-i)*e,this.rotation=this.getRota({x:this.fromMC.x,y:i},{x:this.toMC.x,y:n}),!0},e.prototype.getRota=function(t,e){return this.needRota?180*Math.atan2(e.y-t.y,e.x-t.x)/3.14+90:0},e.prototype.remove=function(){MyTool.removeMC(this),AniManager.getInstance().removeMV(this.mc),this.mc=null},e}(egret.DisplayObjectContainer);__reflect(BulletAniMC.prototype,"BulletAniMC");var BulletAniMC2=function(t){function e(){var e=t.call(this)||this;return e.type="bullet_ani2",e.mc=new MonsterAtkMV,e.targetOffsetY=0,e.addChild(e.mc),e}return __extends(e,t),e.prototype.init=function(t,e,i,n){this.fromMC=t,this.toMC=e,this.beginTime=i,this.endTime=n,this.mc.x=0,this.mc.y=0,this.targetOffsetY=0},e.prototype.onAction=function(t){if(t>this.endTime)return!1;var e=(t-this.beginTime)/(this.endTime-this.beginTime),i=this.fromMC.y-this.fromMC.data.getVO().height/2+this.fromMC.data.atkY,n=this.toMC.y-this.toMC.data.getVO().height/2+this.targetOffsetY,a=this.fromMC.data.atkX*(this.toMC.x>this.fromMC.x?1:-1);return this.x=this.fromMC.x+(this.toMC.x-this.fromMC.x-a)*e+a,this.y=i+(n-i)*e,!0},e.prototype.remove=function(){MyTool.removeMC(this),this.mc.stop()},e}(egret.DisplayObjectContainer);__reflect(BulletAniMC2.prototype,"BulletAniMC2");var PKAddState=function(t){function e(){var e=t.call(this)||this;return e.skinName="PKAddStateSkin",e}return __extends(e,t),e.createItem=function(){var t=this.pool.pop();return t||(t=new e),t},e.freeItem=function(t){t&&(t.remove(),-1==this.pool.indexOf(t)&&this.pool.push(t))},e.fillStateMC=function(t,e){switch(e){case"atk+":t.source="buff_1_png";break;case"atk-":t.source="buff_11_png";break;case"speed+":t.source="buff_2_png";break;case"speed-":t.source="buff_12_png";break;case"def+":t.source="buff_3_png";break;case"def-":t.source="buff_13_png";break;case"hp+":t.source="buff_5_png";break;case"hp-":t.source="buff_15_png";break;case"momian":t.source="buff_31_png";break;case"ill":t.source="buff_25_png";break;case"reborn":t.source="buff_41_png";break;default:throw new Error("1111")}},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.anchorOffsetX=16},e.prototype.dataChanged=function(){},e.prototype.remove=function(){egret.Tween.removeTweens(this),MyTool.removeMC(this)},e.prototype.show=function(t,i,n){var a=this;this.alpha=0,e.fillStateMC(this.stateMC,t),egret.Tween.get(this).wait(n).to({y:this.y-40},800),egret.Tween.get(this).wait(n).to({alpha:1}).wait(500).to({alpha:0},300).call(function(){i.removeAddState(a)})},e.pool=[],e}(game.BaseItem);__reflect(PKAddState.prototype,"PKAddState");var PKMonsterItem=function(t){function e(){var e=t.call(this)||this;return e.addStateList=[],e.monsterMV=new PKMonsterMV,e.needRemove=!1,e.stateMV={},e.skinName="PKMonsterItemSkin",e.monsterMV.addEventListener("mv_die",e.onDieFinish,e),e}return __extends(e,t),e.createItem=function(){var t=this.pool.pop();return t||(t=new e),t.needRemove=!1,t},e.freeItem=function(t){t&&(t.remove(),-1==this.pool.indexOf(t)&&this.pool.push(t))},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addChildAt(this.monsterMV,0),this.monsterMV.x=50,this.monsterMV.y=300,this.anchorOffsetX=50,this.anchorOffsetY=300,this.stateDataArr=this.list.dataProvider=new eui.ArrayCollection([]),this.list.itemRenderer=PKMonsterStateItem},e.prototype.onDieFinish=function(){PKData.getInstance().actionRecord.push(PKData.getInstance().actionTime),PKData.getInstance().actionRecord.push("die_mv_remove|"+(this.data&&this.data.id)),this.needRemove=!0},e.prototype.cleanAllState=function(){for(var t in this.stateMV)MyTool.removeMC(this.stateMV[t])},e.prototype.renewState=function(){var t=this.data;if(99!=t.mid){for(var e in this.stateMV)this.stateMV[e].parent&&parseInt(e)!=PKConfig.STATE_MIANSHANG&&(parseInt(e)!=PKConfig.STATE_MODUN?t.currentState[e]||this.stateMV[e].remove():t.manaHp<=0&&this.stateMV[PKConfig.STATE_MODUN].remove());var i=[];for(var e in t.currentState){var n=parseInt(e);n!=PKConfig.STATE_MIANSHANG&&n!=PKConfig.STATE_MOMIAN&&n!=PKConfig.STATE_NOBEATK&&n!=PKConfig.STATE_DIE&&n!=PKConfig.STATE_SOUL&&(n>100?i.push(n):this.initStateMV(e))}this.renewBuff(i),t.manaHp>0&&this.initStateMV(PKConfig.STATE_MODUN),this.alpha=t.currentState[PKConfig.STATE_SOUL]?.5:1}},e.prototype.renewBuff=function(t){var e={};e[PKConfig.STATE_ILL]="ill",e[PKConfig.STATE_REBORN]="reborn";for(var i=0;i<t.length;i++)if(t[i]=e[t[i]],!t[i])throw new Error("9999");this.stateDataArr&&(this.stateDataArr.source=t,this.stateDataArr.refresh())},e.prototype.initStateMV=function(t){var e=(this.data,parseInt(t));if(!this.stateMV[e]){var i=new PKState;this.stateMV[e]=i,i.data=e}this.stateMV[e].parent||(this.addChild(this.stateMV[e]),this.stateMV[e].show(this))},e.prototype.showMianShang=function(){this.initStateMV(PKConfig.STATE_MIANSHANG)},e.prototype.showAddStateMV=function(t){for(var e=0;e<t.length;e++){var i=PKAddState.createItem();this.addStateList.push(i),this.addChild(i),i.y=this.barGroup.y,i.x=50+.5*(Math.random()*this.data.getVO().width-this.data.getVO().width/2),i.show(t[e],this,200*e)}},e.prototype.removeAddState=function(t){var e=this.addStateList.indexOf(t);-1!=e&&this.addStateList.splice(e,1),PKAddState.freeItem(t)},e.prototype.changeSkin=function(t){this.monsterMV.load(t),this.monsterMV.reset()},e.prototype.dataChanged=function(){var t=this.data;this.needRemove=!1,this.monsterMV.load(t.mid),this.monsterMV.stand(),this.alpha=1,this.cleanAllState(),this.x=t.x,this.setRota(-t.atkRota,!0),this.barGroup.visible=!1,this.barGroup.alpha=1,this.barGroup.y=300-t.getVO().height-20,this.teamMC.y=this.barGroup.y-5,this.teamMC.visible=99!=t.mid,this.renewHp(),this.setTeam()},e.prototype.setRota=function(t,e){if(e||this.monsterMV.scaleX!=t){this.monsterMV.scaleX=t,this.list.x=1==t?50+this.data.getVO().width/2:50-this.data.getVO().width/2-30;var i=this.data;this.barGroup.horizontalCenter=i.getVO().headoff*t}},e.prototype.setRota2=function(t){this.x!=t&&this.setRota(this.x>t?1:-1)},e.prototype.run=function(t){t+=100*(PKData.getInstance().playSpeed-1);var e=this.data;this.monsterMV.speed!=t&&(this.monsterMV.speed=t),this.monsterMV.state!=MonsterMV.STAT_RUN&&this.monsterMV.run(),e.x!=this.x&&(this.setRota(this.x>e.x?1:-1),this.x=e.x)},e.prototype.stand=function(){this.monsterMV.state!=MonsterMV.STAT_STAND&&this.monsterMV.stand()},e.prototype.die=function(){this.monsterMV.speed=100*(PKData.getInstance().playSpeed-1),this.monsterMV.die(),this.bar.width=0,this.barGroup.visible=!0;var t=egret.Tween.get(this.barGroup);t.to({alpha:0},300)},e.prototype.atk=function(t){this.monsterMV.speed=t+100*(PKData.getInstance().playSpeed-1),this.monsterMV.atk()},e.prototype.setTeam=function(){var t=this.data;this.bar.fillColor=t.atkRota==PKConfig.ROTA_LEFT?255:16711680;t.getVO().width/2;this.teamMC.source=t.atkRota==PKConfig.ROTA_LEFT?"card_battle2_png":"card_battle_png"},e.prototype.renewHp=function(){var t=this.data;99!=t.mid&&(t.hp<t.maxHp&&(this.barGroup.visible=!0,this.teamMC.visible=!1),this.bar.width=40*t.getHpRate())},e.prototype.winRemove=function(){var t=egret.Tween.get(this);t.to({alpha:0},500).call(function(){this.needRemove=!0,PKData.getInstance().actionRecord.push("win_mv_remove|"+(this.data&&this.data.id))},this)},e.prototype.remove=function(){for(this.needRemove=!0,PKData.getInstance().actionRecord.push("just_mv_remove|"+(this.data&&this.data.id)),egret.Tween.removeTweens(this),egret.Tween.removeTweens(this.barGroup),MyTool.removeMC(this),this.monsterMV.stop();this.addStateList.length>0;)PKAddState.freeItem(this.addStateList.pop());this.stateDataArr&&(this.stateDataArr.source.length=0,this.stateDataArr.refresh())},e.pool=[],e}(game.BaseItem);__reflect(PKMonsterItem.prototype,"PKMonsterItem");var PKMonsterMV=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.createItem=function(){var t=this.pool.pop();return t||(t=new e,t.touchChildren=t.touchEnabled=!1),t},e.freeItem=function(t){t&&(t.remove(),-1==this.pool.indexOf(t)&&this.pool.push(t))},Object.defineProperty(e.prototype,"speed",{get:function(){return this.currentMV.speed},set:function(t){this.currentMV.speed=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this.currentMV.state},enumerable:!0,configurable:!0}),e.prototype.remove=function(){this.stop(),MyTool.removeMC(this),this.talkItm&&(PKTalkItem.freeItem(this.talkItm),this.talkItm=null)},e.prototype.showHeight=function(){return MonsterVO.getObject(this.id).height},e.prototype.load=function(t){this.id=t;MonsterVO.getObject(t);this.currentMV&&this.currentMV.stop(),MyTool.removeMC(this.currentMV),this.monsterMV||(this.monsterMV=new MonsterMV,this.monsterMV.addEventListener("mv_die",this.fireDie,this)),this.currentMV=this.monsterMV,this.addChild(this.monsterMV),this.monsterMV.load(t)},e.prototype.fireDie=function(){this.dispatchEventWith("mv_die")},e.prototype.reset=function(){this.currentMV.reset()},e.prototype.play=function(){this.currentMV.play()},e.prototype.stop=function(){this.currentMV&&this.currentMV.stop()},e.prototype.run=function(){this.currentMV.run()},e.prototype.stand=function(){this.currentMV.stand()},e.prototype.atk=function(){this.currentMV.atk()},e.prototype.die=function(){this.currentMV.die()},e.prototype.talk=function(){this.talkItm=PKTalkItem.createItem(),this.talkItm.setData(this),this.addChildAt(this.talkItm,0)},e.pool=[],e}(eui.Group);__reflect(PKMonsterMV.prototype,"PKMonsterMV");var PKMonsterStateItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="PKMonsterStateItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){PKAddState.fillStateMC(this.mc,this.data)},e}(game.BaseItem);__reflect(PKMonsterStateItem.prototype,"PKMonsterStateItem");var PKSkillItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="PKSkillItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchChildren=this.touchEnabled=!1,this.img.hideType=!0},e.prototype.dataChanged=function(){},e.prototype.remove=function(){MyTool.removeMC(this),egret.Tween.removeTweens(this)},e}(game.BaseItem);__reflect(PKSkillItem.prototype,"PKSkillItem");var PKState=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){this.data==PKConfig.STATE_YUN?(this.initAtkMV(),this.atkMV.load("effect2_png",0,154,39,2)):this.data==PKConfig.STATE_DIE?(this.initImg(),this.stateMC.source="effect5_png",this.stateMC.anchorOffsetX=15):this.data==PKConfig.STATE_MODUN?(this.initAtkMV(),this.atkMV.load("effect1_png",0,440,128,4)):this.data==PKConfig.STATE_MIANSHANG&&(this.initImg(),this.stateMC.source="effect3_png",this.stateMC.anchorOffsetX=26)},e.prototype.initImg=function(){this.stateMC||(this.stateMC=new eui.Image,this.addChild(this.stateMC))},e.prototype.initAtkMV=function(){this.atkMV||(this.atkMV=new MonsterAtkMV,this.addChild(this.atkMV),this.atkMV.visible=!0,this.atkMV.addEventListener("mv_end",this.onAtkMVEnd,this))},e.prototype.onAtkMVEnd=function(){},e.prototype.remove=function(){clearTimeout(this.timer),MyTool.removeMC(this),this.atkMV&&this.atkMV.stop()},e.prototype.show=function(t){var e=this,i=t.data;switch(clearTimeout(this.timer),parseInt(this.data)){case PKConfig.STATE_YUN:this.atkMV.play(),this.x=11.5,this.y=300-i.getVO().height-35;break;case PKConfig.STATE_DIE:this.x=50,this.y=300-i.getVO().height-50;break;case PKConfig.STATE_MODUN:this.atkMV.play();var n=(i.getVO().height+20)/128;this.x=50-55*n,this.y=300-i.getVO().height-20,this.atkMV.scaleX=this.atkMV.scaleY=n;break;case PKConfig.STATE_MIANSHANG:this.scaleX=t.monsterMV.scaleX,1==t.monsterMV.scaleX?this.x=50-i.getVO().width/2+10:this.x=50+i.getVO().width/2-10,this.y=300-i.getVO().height-30,this.timer=setTimeout(function(){e.remove()},100)}},e}(game.BaseItem);__reflect(PKState.prototype,"PKState");var PKTalkItem=function(t){function e(){var e=t.call(this)||this;return e.active=!1,e.h=110,e.w=161,e.skinName="PKTalkItemSkin",e}return __extends(e,t),e.createItem=function(){var t=this.pool.pop();return t||(t=new e),t},e.freeItem=function(t){t&&(t.remove(),this.pool.push(t))},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchChildren=this.touchEnabled=!1,this.anchorOffsetY=110},e.prototype.setData=function(t){this.active=!0,this.text.text=PKManager.getInstance().pkWord[Math.floor(Math.random()*PKManager.getInstance().pkWord.length)],this.relateItem=t,this.x=0,this.relateItem.scaleX>0?(this.bg.scaleX=-1,this.anchorOffsetX=.4*this.w):(this.bg.scaleX=1,this.anchorOffsetX=.6*this.w),this.y=.9*-t.showHeight(),egret.Tween.removeTweens(this),this.scaleX=0,this.scaleY=0,this.alpha=1;var e=egret.Tween.get(this);e.to({scaleX:1,scaleY:1},200).to({scaleX:.9,scaleY:.9},200).wait(2500).to({scaleX:0,scaleY:0},100).call(function(){this.remove()},this)},e.prototype.remove=function(){egret.Tween.removeTweens(this),this.active=!1,MyTool.removeMC(this),this.relateItem.talkItm=null},e.pool=[],e}(game.BaseContainer);__reflect(PKTalkItem.prototype,"PKTalkItem");var PKTotem=function(t){function e(){var e=t.call(this)||this;return e.skinName="PKTotemSkin",e}return __extends(e,t),e.createItem=function(){var t=this.pool.pop();return t||(t=new e),t},e.freeItem=function(t){t&&(t.remove(),this.pool.push(t))},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.anchorOffsetY=80,this.anchorOffsetX=15;var e=this.tw=egret.Tween.get(this.topMC,{loop:!0});this.topMC.bottom=58,e.to({bottom:63},500,egret.Ease.sineInOut).to({bottom:58},500,egret.Ease.sineInOut),this.tw.setPaused(!0)},e.prototype.dataChanged=function(){this.topMC.source="totem_"+this.data+"_png",this.tw.setPaused(!1)},e.prototype.remove=function(){MyTool.removeMC(this),this.tw.setPaused(!0)},e.pool=[],e}(game.BaseItem);__reflect(PKTotem.prototype,"PKTotem");var PKVideoCon=function(t){function e(){var e=t.call(this)||this;return e.itemArr=[],e.totemArr=[],e.txtPool=[],e.txtArr=[],e.monsterY=400,e.lastTalk={1:0,"-1":0},e.skinName="PKVideoConSkin",e}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.width=PKConfig.floorWidth+2*PKConfig.appearPos,PKData.getInstance().addEventListener("video",this.onVideoEvent,this)},e.prototype.init=function(t){this.bg.visible=!this.isHang,this.bg.visible&&(this.bg.source=PKManager.getInstance().getPKBG(t)),this.remove()},e.prototype.remove=function(){for(;this.itemArr.length;){var t=this.itemArr.pop();PKData.getInstance().actionRecord.push("mv_remove2|"+(t.data&&t.data.id)),PKMonsterItem.freeItem(t)}for(;this.txtArr.length;){var t=this.txtArr.pop();this.freeTxt(t)}for(;this.totemArr.length;){var t=this.totemArr.pop();PKTotem.freeItem(t)}},e.prototype.resetView=function(){this.remove();for(var t=PKData.getInstance(),e=0;e<t.monsterList.length;e++){var i=PKMonsterItem.createItem();i.y=this.monsterY+(-30+60*Math.random()),this.con.addChildAt(i,this.getIndexByY(i.y)),i.data=t.monsterList[e],this.itemArr.push(i),i.stand()}},e.prototype.createTxt=function(){var t=this.txtPool.pop();return t||(t=new eui.Label,t.size=20,t.stroke=2,t.width=160,t.textAlign="center",t.anchorOffsetX=80),t.alpha=1,t},e.prototype.freeTxt=function(t){t&&(egret.Tween.removeTweens(t),MyTool.removeMC(t),this.txtPool.push(t))},e.prototype.getItemByID=function(t){for(var e=0;e<this.itemArr.length;e++){var i=this.itemArr[e];if(i.data.id==t)return i}var n="",a=PKData.getInstance().getMonsterByID(t);return n=a?a.die?"monster die and not find:"+t+"|"+PKData.getInstance().monsterID:"not die but not find:"+t+"|"+PKData.getInstance().monsterID:"can not find monster:"+t+"|"+PKData.getInstance().monsterID,alert(n),null},e.prototype.getIndexByY=function(t){for(var e,i=0;i<this.itemArr.length;i++){var n=this.itemArr[i];n.y>t||(!e||e.y<n.y)&&(e=n)}return e?this.con.getChildIndex(e)+1:1},e.prototype.onVideoEvent=function(t){var e,i=t.data,n=i.user;switch(i.type){case PKConfig.VIDEO_MONSTER_ADD:e=PKMonsterItem.createItem(),e.y=this.monsterY+n.y,this.con.addChildAt(e,this.getIndexByY(e.y)),e.data=n,this.itemArr.push(e),PKData.getInstance().actionRecord.push("mv_add|"+n.id),e.stand(),99==n.mid&&e.run(50);break;case PKConfig.VIDEO_MONSTER_MOVE:e=this.getItemByID(n.id),e&&e.run(n.addSpeed);break;case PKConfig.VIDEO_MONSTER_ATK:e=this.getItemByID(n.id),i.target&&e.setRota2(i.target.x),e.atk(n.addSpeed);break;case PKConfig.VIDEO_MONSTER_DOUBLE:if(n.die)break;e=this.getItemByID(n.id),this.playDoubleHit(e,i.value);break;case PKConfig.VIDEO_MONSTER_MISS:e=this.getItemByID(n.id),this.playMiss(e);break;case PKConfig.VIDEO_MONSTER_HPCHANGE:e=this.getItemByID(n.id),e.renewHp();break;case PKConfig.VIDEO_MONSTER_WIN:e=this.getItemByID(n.id),e.winRemove();break;case PKConfig.VIDEO_MONSTER_ADD_STATE:e=this.getItemByID(n.id),e.showAddStateMV(i.keys);break;case PKConfig.VIDEO_MONSTER_DIE:e=this.getItemByID(n.id),e.die();break;case PKConfig.VIDEO_MONSTER_STAND:e=this.getItemByID(n.id),e.stand();break;case PKConfig.VIDEO_MONSTER_STATE_CHANGE:e=this.getItemByID(n.id),e.renewState();break;case PKConfig.VIDEO_MONSTER_NOHIT:e=this.getItemByID(n.id),e.showMianShang();break;case PKConfig.VIDEO_MANAHP_CHANGE:e=this.getItemByID(n.id),e.renewState();break;case PKConfig.VIDEO_MONSTER_CHANGE_TEAM:e=this.getItemByID(n.id),e.setTeam();break;case PKConfig.VIDEO_TOTEM_ADD:var a=PKTotem.createItem();a.y=this.monsterY+i.y,a.x=i.x,this.con.addChildAt(a,this.getIndexByY(a.y)),a.data=i.totemType,a.owner=i.user,this.totemArr.push(a);break;case PKConfig.VIDEO_TOTEM_REMOVE:for(var r=0;r<this.totemArr.length;r++){var o=this.totemArr[r];if(o.owner==i.user){PKTotem.freeItem(o),this.totemArr.splice(r,1),r--;break}}break;case PKConfig.VIDEO_MONSTER_CHANGE_SKIN:e=this.getItemByID(n.id),e.changeSkin(i.skin)}},e.prototype.action=function(){for(var t,e=0;e<this.itemArr.length;e++)t=this.itemArr[e],t.needRemove&&(PKMonsterItem.freeItem(t),this.itemArr.splice(e,1),PKData.getInstance().actionRecord.push("mv_remove|"+(t.data&&t.data.id)),e--);PKBulletManager.getInstance().actionAll()},e.prototype.playAniBetween=function(t,e,i){var n=this.getItemByID(t),a=this.getItemByID(e);if(!n||!a)throw new Error("XXX");var r=AniManager.getInstance();if(r.preLoadMV(i)){var o=MyTool.getMiddleXY(n,a);o.y-=a.data.getVO().height/2;var s=this.con.getChildIndex(n),h=this.con.getChildIndex(a);r.playOnItem(i,s>h?n:a,o)}},e.prototype.playAniOn=function(t,e){if(PKData.getInstance().quick)return null;var i=this.getItemByID(t);if(!i)throw new Error("XXX");var n=Math.max(1,i.data.getVO().height/70),a=AniManager.getInstance(),r=a.playOnItem(e,i);return r&&(r.scaleX=r.scaleY=n),r},e.prototype.playAniIn=function(t,e){if(PKData.getInstance().quick)return null;var i=this.getItemByID(t);if(!i)throw new Error("XXX");var n=Math.max(1,i.data.getVO().height/70),a=AniManager.getInstance(),r=a.playInItem(e,i);return r&&(r.scaleX=r.scaleY=n),r},e.prototype.dropOn=function(t,e){if(PKData.getInstance().quick)return null;var i=this.getItemByID(t);if(!i)throw new Error("XXX");var n=AniManager.getInstance();return n.drop(e,i)},e.prototype.playDoubleHit=function(t,e){var i=this.createTxt();i.textColor=16711680,i.text="!"+Math.ceil(e),i.x=t.x,i.y=t.y-t.data.getVO().height-30,this.con.addChildAt(i,t.parent.getChildIndex(t)+1),this.txtArr.push(i);var n=egret.Tween.get(i);n.to({y:i.y-20},300).wait(200).call(function(){ArrayUtil.removeItem(this.txtArr,i),this.freeTxt(i)},this)},e.prototype.playMiss=function(t){var e=this.createTxt();e.textColor=16777215,e.text="miss",e.x=t.x,e.y=t.y-t.data.getVO().height-30,this.con.addChildAt(e,t.parent.getChildIndex(t)+1),this.txtArr.push(e);var i=egret.Tween.get(e);i.to({y:e.y-20},300).to({alpha:0},300).call(function(){ArrayUtil.removeItem(this.txtArr,e),this.freeTxt(e)},this)},e.prototype.randomTalk=function(){if(!(Math.random()>.02)){var t=this.itemArr[Math.floor(this.itemArr.length*Math.random())];if(t&&!t.talkItm){if(egret.getTimer()<this.lastTalk[t.data.atkRota])return;t.talk(),this.lastTalk[t.data.atkRota]=egret.getTimer()+3e3+Math.floor(2e3*Math.random())}}},e}(game.BaseContainer);__reflect(PKVideoCon.prototype,"PKVideoCon");var PKCardInfoItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="PKCardInfoItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.onClick=function(){},e.prototype.dataChanged=function(){this.barMC.visible=!1;var t=[1,4,5,8];-1!=t.indexOf(this.data.index)?this.currentState="stat1":this.currentState="stat2",this.icon.source=this.data.icon,this.icon.scaleX=this.icon.scaleY=this.data.iconScale,this.data.title?(this.rect.visible=!0,this.setHtml(this.text,this.createHtml(this.data.title,16757116)+"："+this.data.value+(this.data.valueAdd?this.createHtml(" +"+this.data.valueAdd,16757116):""))):(this.rect.visible=!1,this.text.text=""),this.data.rate&&(this.barMC.visible=!0,this.barMC.width=205*this.data.rate)},e}(game.BaseItem);__reflect(PKCardInfoItem.prototype,"PKCardInfoItem");var PKCardInfoUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="PKCardInfoSkin",e}return __extends(e,t),e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.img.hideType=!0,this.list1.itemRenderer=PKCardInfoItem,this.list2.itemRenderer=PKCardInfoItem},e.prototype.show=function(t){GameManager.container.addChild(this),GameManager.stage.once(egret.TouchEvent.TOUCH_END,this.hide,this,!0),GameManager.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),this.stageX=GameManager.stageX,this.stageY=GameManager.stageY;var e=560;this.x=Math.min(Math.max(GameManager.stageX-e/2,0),640-e),this.renew(t);var i=0;GameManager.stageY<GameManager.stage.stageHeight/2?(i=GameManager.stageY+50,t.target&&(i=t.target.localToGlobal(0,0).y+t.target.height+50),this.y=Math.min(i,GameManager.stage.stageHeight-this.height)):(i=GameManager.stageY-50-this.height,t.target&&(i=t.target.localToGlobal(0,0).y-50-this.height),this.y=Math.max(i,0))},e.prototype.onMove=function(t){(Math.abs(this.stageX-t.stageX)>20||Math.abs(this.stageY-t.stageY)>20)&&this.hide()},e.prototype.hide=function(){game.BaseUI.setStopEevent(),GameManager.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),MyTool.removeMC(this)},e.prototype.renew=function(t){this.dataIn=t;var e=CM.getCardVO(this.dataIn.mid);this.img.data=e.id,this.bg.source=e.getBG(),this.nameText.text=e.name,this.type.source=e.getTypeIcon(),this.dataIn.rota?(this.teamIcon.source=this.dataIn.rota==PKConfig.ROTA_LEFT?"card_battle2_png":"card_battle_png",this.teamIcon.visible=!0):this.teamIcon.visible=!1;var i=(CM.getCardVO(this.dataIn.mid).getAdd(this.dataIn.force),CM.getCardVO(this.dataIn.mid).getAdd(this.dataIn.force,this.dataIn.type));this.setHtml(this.desText,e.getDes(i,!0)),console.log(i);var n=e.isMonster?"传送":"施法",a=[{index:1,icon:"icon_cost_png",iconScale:1,title:n+"费用",value:e.cost,valueAdd:0}];e.isMonster?(a.push({index:2,icon:"icon_times_png",iconScale:1,title:"传送次数",value:e.num||1,valueAdd:0}),a.push({index:3,icon:"icon_clock_png",iconScale:1,title:n+"间隔",value:MyTool.toFixed(e.cd/1e3,1)+"秒",valueAdd:0})):0==e.num?a.push({index:2,icon:"icon_clock2_png",iconScale:1,title:"持续时间",value:MyTool.toFixed(e.cd/1e3,1)+"秒",valueAdd:0}):1==e.num?a.push({index:2,icon:"icon_clock_png",iconScale:1,title:"技能次数",value:"单次",valueAdd:0}):e.num>1&&(a.push({index:2,icon:"icon_clock_png",iconScale:1,title:"持续时间",value:MyTool.toFixed((e.num-1)*e.cd/1e3,1)+"秒",valueAdd:0}),a.push({index:3,icon:"icon_clock_png",iconScale:1,title:n+"间隔",value:MyTool.toFixed(e.cd/1e3,1)+"秒",valueAdd:0})),MyTool.removeMC(this.line),MyTool.removeMC(this.list2),e.isMonster?(this.type.scaleX=this.type.scaleY=.6,this.addMonsterList(e)):(this.type.scaleX=this.type.scaleY=1,e.mid&&this.addMonsterList(CM.getCardVO(e.mid))),a.length%2==1&&a.push({index:4,icon:"",iconScale:1,title:"",value:"",valueAdd:0}),this.list1.dataProvider=new eui.ArrayCollection(a)},e.prototype.addMonsterList=function(t){var e=CM.getCardVO(this.dataIn.mid).getAdd(this.dataIn.force),i=CM.getCardVO(this.dataIn.mid).getAdd(this.dataIn.force,this.dataIn.type);this.group.addChild(this.line),this.group.addChild(this.list2);var n=Math.floor(t.atk*e),a=Math.floor(t.hp*e),r=t.def,o=Math.floor(t.atk*i),s=Math.floor(t.hp*i),h=r+(this.dataIn.teamDef||0),c=[{index:1,icon:"icon_love_png",iconScale:.6,title:"血量",value:a,valueAdd:s-a}];n&&(c.push({index:2,icon:"icon_atk_png",iconScale:1,title:"攻击力",value:n,valueAdd:o-n}),c.push({index:5,icon:"icon_atkcd_png",iconScale:1,title:"攻击间隔",value:MyTool.toFixed(t.atkcd/1e3,1)+"秒",valueAdd:0}),c.push({index:6,icon:"icon_rage_png",iconScale:1,title:"攻击距离",value:t.isNearAtk()?"近战":t.atkrage,valueAdd:0})),c.push({index:3,icon:"icon_def1_png",iconScale:.4,title:"防御",value:r,valueAdd:h-r}),c.push({index:4,icon:"icon_speed_png",iconScale:1,title:"移动速度",value:t.speed,valueAdd:0}),c.push({index:4,icon:"icon_atkhp_png",iconScale:1,title:"队伍伤害",value:t.atk2,valueAdd:0}),c.push({index:7,icon:"icon_pos_png",iconScale:1,title:"需要人口",value:t.space,valueAdd:0}),t.skillcd>0&&c.push({index:0,icon:"icon_clock_png",iconScale:1,title:"技能间隔",value:MyTool.toFixed(t.skillcd/1e3,1)+"秒",valueAdd:0}),c.length%2==1&&c.push({index:0,icon:"",iconScale:1,title:"",value:"",valueAdd:0});for(var l=0;l<c.length;l++)c[l].index=l+1;this.list2.dataProvider=new eui.ArrayCollection(c)},e}(game.BaseContainer);__reflect(PKCardInfoUI.prototype,"PKCardInfoUI");var CacheManager=function(){function t(){this.registerData={},this.table={},this.cacheLoad={},this.register(MonsterVO)}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.register=function(t){this.registerData[t.dataKey]=t},t.prototype.initData=function(t){for(var e in t)if(this.table[e]||(this.table[e]={}),this.registerData[e]){var i=this.registerData[e],n=i.key,a=t[e];for(var r in a){var o=new i;o.fill(a[r]),this.table[e][o[n]]=o}}},t.prototype.initFinish=function(){},t.prototype.getCardVO=function(t){return MonsterVO.getObject(t)},t.prototype.loadCache=function(t,e){return this.cacheLoad[t]?void(e&&e()):(GameManager.container.touchChildren=GameManager.container.touchEnabled=!1,void RES.getResAsync(t,function(){GameManager.container.touchChildren=GameManager.container.touchEnabled=Net.getInstance().modeNum<=0,this.cacheLoad[t]=!0,this.initData(RES.getRes(t)),e&&e()},this))},t}();__reflect(CacheManager.prototype,"CacheManager");var DebugManager=function(){function t(){this.stop=0,this.winCardArr=[],this.finishFun=function(){return!1},this.printDetail=!1,this.winMonster={},this.winUseCard=[],this.outPut=[],this.testNum=0}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.randomList=function(t){var e=[];for(var i in MonsterVO.data){var n=MonsterVO.data[i];e.push(n)}for(var a=0,r=[];100>a&&t>0;){var o=ArrayUtil.randomOne(e);o.cost<=t&&(t-=o.cost,r.push(o.id)),a++}return ArrayUtil.random(r),r.join(",")},t.prototype.test=function(){var t=this;this.testNum=0,this.stop=0,this.winMonster={},this.winUseCard=[],this.outPut=[],setTimeout(function(){t.testRound()},1)},t.prototype.printResult=function(t){var e=[];for(var i in MonsterVO.data)e.push({id:i,num:this.winMonster[i]||0});ArrayUtil.sortByField(e,["num"],[1]);for(var n=0;n<e.length;n++){var a=e[n].id;e[n].rate=e[n].num*Math.pow(CM.getCardVO(a).cost,.8),console.log(n+1+"	id:"+a+"		num:"+e[n].num+"		cost:"+CM.getCardVO(a).cost+"		name:"+CM.getCardVO(a).name+"		type:"+CM.getCardVO(a).type)}console.log("\n\n======================================================================\n\n"),ArrayUtil.sortByField(e,["rate"],[1]);for(var n=0;n<e.length;n++){var a=e[n].id;e[n].rate=e[n].num*CM.getCardVO(a).cost,console.log(n+1+"	id:"+a+"		rate:"+e[n].rate+"		cost:"+CM.getCardVO(a).cost+"		name:"+CM.getCardVO(a).name+"		type:"+CM.getCardVO(a).type+"		num:"+e[n].num)}},t.prototype.testRound=function(){this.testNum++;for(var t=[],e=1024,i=30+Math.floor(20*Math.random()),n=0;e>n;n++)t.push(this.randomList(i));this.testArr(t,0,e,egret.getTimer())},t.prototype.testArr=function(t,e,i,n,a){var r=this;if(t.length>2&&(t=t.concat(this.testOne(t.shift(),t.shift())),e++,i+2>e))return void(e%50==0?egret.callLater(function(){console.log("runing"),r.testArr(t,e,i,n,a)},this):this.testArr(t,e,i,n,a));var o={list1:t[0],list2:t[1]};t=this.testOne(t.shift(),t.shift()),PKData.getInstance().isDraw()||this.outPut.push(o);for(var s=0;s<t.length;s++){for(var h=t[s].split(","),c=0;c<h.length;c++){var l=h[c];this.winMonster[l]?this.winMonster[l]++:this.winMonster[l]=1}this.winCardArr.push(t[s])}if(console.log(this.testNum+":"+(egret.getTimer()-n)),!this.finishFun())if(this.stop){if(this.printResult(a),2==this.stop){for(var s=0;s<this.outPut.length;s++)this.outPut[s]=this.format(this.outPut[s]);egret.localStorage.setItem("mapData",this.outPut.join("\n"))}}else egret.callLater(this.testRound,this)},t.prototype.format=function(t){var e=Math.floor(1e11*Math.random());return t.seed=e,JSON.stringify(t)},t.prototype.testOne=function(t,e,i){void 0===i&&(i=10);var n=PKData.getInstance(),a={seed:TM.now()+Math.floor(1e8*Math.random()),players:[{id:1,gameid:"test1",team:1,autolist:t,force:1e4,type:0,hp:1},{id:2,gameid:"test2",team:2,autolist:e,force:1e4,type:0,hp:1}]};return n.init(a),n.quick=!0,n.start(),PKCode.getInstance().onStep(),n.isWin()?[t]:n.isDraw()?[t,e]:[e]},t.prototype.getCost=function(t){for(var e=t.split(","),i=0,n=0;n<e.length;n++)i+=MonsterVO.getObject(e[n]).cost;console.log(i)},t.cd=0,t}();__reflect(DebugManager.prototype,"DebugManager");var EventManager=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.dispatch=function(t,i){e.getInstance().dispatchEventWith(t,!1,i)},e.prototype.addEvent=function(t,i,n){e.getInstance().addEventListener(t,i,n)},e.prototype.removeEvent=function(t,i,n){e.getInstance().removeEventListener(t,i,n)},e}(egret.EventDispatcher);__reflect(EventManager.prototype,"EventManager");var GameManager=function(){function t(){this.timeE=new MyTimer(1e3/60),this.timeID=new egret.Timer(1e3),this.timeID.addEventListener(egret.TimerEvent.TIMER,this.timerun,this),this.timeID.start(),this.timeE.addEventListener(egret.TimerEvent.TIMER,this.onTimeE,this),this.timeE.start()}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},Object.defineProperty(t,"uiHeight",{get:function(){return Math.min(1136,this.stage.stageHeight)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"uiWidth",{get:function(){return this.stage.stageWidth},enumerable:!0,configurable:!0}),t.prototype.isWebGL=function(){return"webgl"==egret.Capabilities.renderMode
},t.prototype.init=function(){t.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),t.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this)},t.prototype.stopTimer=function(){this.timeID.stop(),this.timeE.stop()},t.prototype.onTimeE=function(){EM.dispatch(GameEvent.client.timerE)},t.prototype.onTouchMove=function(e){t.stageX=e.stageX,t.stageY=e.stageY},t.prototype.onTouchBegin=function(e){this.lastTouchMC=e.target,t.stageX=e.stageX,t.stageY=e.stageY,this.lastTouchTime=egret.getTimer()},t.prototype.timerun=function(){var t=TM.now();return this.lastTime?(DateUtil.isSameDay(this.lastTime,t)||EM.dispatch(GameEvent.client.pass_day),EM.dispatch(GameEvent.client.timer),void(this.lastTime=t)):void(this.lastTime=t)},t.prototype.getZeroCD=function(){var t=DateUtil.timeToChineseDate(TM.now());return t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),t.setHours(24),Math.floor(t.getTime()/1e3)-TM.now()},t}();__reflect(GameManager.prototype,"GameManager");var App=function(){function t(){}return Object.defineProperty(t,"isMobile",{get:function(){return egret.MainContext.deviceType==egret.MainContext.DEVICE_MOBILE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isAndroid",{get:function(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("android")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isIOS",{get:function(){var t=navigator.userAgent.toLowerCase();return/ip(ad|hone|od)/.test(t)},enumerable:!0,configurable:!0}),t.touchEvent=egret.TouchEvent.TOUCH_TAP,t}();if(__reflect(App.prototype,"App"),window.wx){window.TeamUI=TeamUI,window.MainPKUI=MainPKUI;var wx=window.wx;wx.onHide(function(t){GameManager.stage&&(PKManager.getInstance().callSendCost(),SoundManager.getInstance().stopBgSound(),GameManager.stage.dispatchEventWith(egret.Event.DEACTIVATE),console.log("hide"))}),wx.onShow(function(t){GameManager.stage&&(SoundManager.getInstance().playSound("bg"),GameManager.stage.dispatchEventWith(egret.Event.ACTIVATE),console.log("show"))}),wx.onShareAppMessage(function(t){return{title:"这个游戏很好玩，推荐一下",imageUrl:Config.localResRoot+"share_img_2.jpg"}}),window.wx.setKeepScreenOn&&window.wx.setKeepScreenOn({keepScreenOn:!0})}var SharedObjectManager=function(){function t(){}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.getUserSign=function(){return UM.gameid},t.prototype.setMyValue=function(t,e){t=this.getUserSign()+"_"+t,this.setValue(t,e)},t.prototype.getMyValue=function(t){return t=this.getUserSign()+"_"+t,this.getValue(t)},t.prototype.removeMyValue=function(t){t=this.getUserSign()+"_"+t,egret.localStorage.removeItem(t)},t.prototype.setValue=function(t,e){var i={};i.data=e,i=JSON.stringify(i),egret.localStorage.setItem(t,i)},t.prototype.getValue=function(t){var e=egret.localStorage.getItem(t);if(!e)return null;var i=JSON.parse(e);return i.data},t}();__reflect(SharedObjectManager.prototype,"SharedObjectManager");var SoundManager=function(){function t(){this._soundPlaying=!1,this._bgPlaying=!1,this._openShake=!0,this._isPlayMovie=!0,this._isMessage=!0,this.isLoad=!1,this.pkKey=[],this.effectKey=[],this.init()}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.init=function(){this._soundPlaying=!0,this._bgPlaying=!0;var t=SharedObjectManager.getInstance();void 0!=t.getValue("sound")&&(this._soundPlaying=t.getValue("sound")),void 0!=t.getValue("bgsound")&&(this._bgPlaying=t.getValue("bgsound")),void 0!=t.getValue("openShake")&&(this._openShake=t.getValue("openShake")),void 0!=t.getValue("playMovie")&&(this._isPlayMovie=t.getValue("playMovie")),void 0!=t.getValue("showMessage")&&(this._isMessage=t.getValue("showMessage")),this.isLoad=this._soundPlaying},Object.defineProperty(t.prototype,"soundPlaying",{get:function(){return this._soundPlaying},set:function(t){this._soundPlaying!=t&&SharedObjectManager.getInstance().setValue("sound",t),this._soundPlaying=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bgPlaying",{get:function(){return this._bgPlaying},set:function(t){this._bgPlaying!=t&&SharedObjectManager.getInstance().setValue("bgsound",t),this._bgPlaying=t,t?this.playSound("bg"):this.stopBgSound()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openShake",{get:function(){return this._openShake},set:function(t){this._openShake!=t&&SharedObjectManager.getInstance().setValue("openShake",t),this._openShake=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlayMovie",{get:function(){return this._isPlayMovie},set:function(t){this._isPlayMovie!=t&&SharedObjectManager.getInstance().setValue("playMovie",t),this._isPlayMovie=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMessage",{get:function(){return this._isMessage},set:function(t){this._isMessage!=t&&SharedObjectManager.getInstance().setValue("showMessage",t),this._isMessage=t},enumerable:!0,configurable:!0}),t.prototype.addBtnClickEffect=function(t){t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){this.playBtn()},this)},t.prototype.playBtn=function(){this.playEffect("btn")},t.prototype.stopBgSound=function(){this.lastBGKey=this.bgKey,this.bgKey=null;try{egret.clearTimeout(this.playTime),this.currentChannel&&(egret.Tween.removeTweens(this.currentChannel),this.currentChannel.stop()),this.onSoundComplete()}catch(t){}},t.prototype.playEffect=function(t,e,i){if(this.soundPlaying){var n="resource/sound/"+t+".mp3",a=new egret.URLLoader;a.dataFormat=egret.URLLoaderDataFormat.SOUND,a.once(egret.Event.COMPLETE,function(){var t=a.data,n=t.play(0,1);e&&n.once(egret.Event.SOUND_COMPLETE,e,i)},this),a.load(new egret.URLRequest(n))}},t.prototype.resumeSound=function(){this.lastBGKey&&this.playSound(this.lastBGKey)},t.prototype.playSound=function(t,e){if(void 0===e&&(e=9999),this.bgPlaying&&this.bgKey!=t){this.bgKey=t;var i="resource/sound/"+t+".mp3";if(this.currentKey!=i){this.currentKey=i;try{this.tempLoop=e;var n=new egret.URLLoader;n.dataFormat=egret.URLLoaderDataFormat.SOUND,n.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),n.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this),n.load(new egret.URLRequest(i))}catch(a){}}}},t.prototype.onLoadComplete=function(t){function e(){var t=i.data,e=t.play(0,n.tempLoop);n.currentChannel=e,e.addEventListener(egret.Event.SOUND_COMPLETE,n.onSoundComplete,n)}egret.clearTimeout(this.playTime);var i=t.target,n=this;try{if(this.onLoadError(t),this.currentKey&&i.data.url!=this.currentKey||!this._bgPlaying)return;if(this.currentChannel){if(n.currentChannel.stop(),n.currentChannel=null,!n._bgPlaying)return}else e()}catch(a){}},t.prototype.onSoundComplete=function(t){this.currentChannel=null,this.currentKey=null},t.prototype.onLoadError=function(t){var e=t.target;e.removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onLoadError,this)},t}();__reflect(SoundManager.prototype,"SoundManager");var TimeManager=function(){function t(){this.timeDiff=0}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.init=function(t){this.timeDiff=Math.floor(Date.now()/1e3-t)},t.prototype.now=function(){return Math.floor(Date.now()/1e3)-this.timeDiff},t.prototype.nowMS=function(){return Date.now()-1e3*this.timeDiff},t.prototype.getLastDayOfWeekDate=function(t,e){e=e||5;var i=new Date(1e3*t),n=i.getDay(),a=e>n?e-n:7-(n-e);return new Date(i.getTime()+24*a*3600*1e3)},t.prototype.offsetDate=function(){var t=-21600,e=this.now();return e+=t,DateUtil.timeToChineseDate(e)},t.prototype.chineseDate=function(){return DateUtil.timeToChineseDate(this.now())},t.prototype.getNextDateTime=function(){return DateUtil.getNextDateTimeByHours(6)},t}();__reflect(TimeManager.prototype,"TimeManager");var UserManager=function(){function t(){this.coin=999,this.lastGuess={},this.isScope=!1}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.fill=function(t){this.dbid=t._id,this.coin=t.coin||999,this.lastGuess=t.lastGuess},t.prototype.renewInfo=function(t){this.isScope=!0,this.nick=t.nickName,this.head=t.avatarUrl,this.gender=t.gender||1},t.prototype.addCoin=function(t){t&&(this.coin+=t,this.coin<0&&(this.coin=0),EM.dispatch(GameEvent.client.COIN_CHANGE))},t.prototype.getUserInfo=function(t){var e=this,i=window.wx;return i?void i.cloud.callFunction({name:"getInfo",complete:function(i){console.log(i),e.gameid=i.result.openid,e.loginUser(t)}}):(this.fill(this.orginUserData()),void(t&&t()))},t.prototype.loginUser=function(t){var e=this,i=window.wx,n=i.cloud.database();n.collection("user").where({_openid:this.gameid}).get({success:function(i){return 0==i.data.length?void e.onNewUser(t):(e.fill(i.data[0]),void(t&&t()))}})},t.prototype.testAddInvite=function(){var t=window.wx,e=t.getLaunchOptionsSync().query;"1"==e.type&&t.cloud.callFunction({name:"onShareIn",data:{other:e.from,skinid:e.skinid},complete:function(t){}})},t.prototype.onNewUser=function(t){var e=this,i=window.wx,n=i.cloud.database(),a=this.orginUserData();n.collection("user").add({data:a,success:function(i){a._id=i._id,e.fill(a),t&&t()}}),this.testAddInvite()},t.prototype.orginUserData=function(){return{coin:200,lastGuess:this.getGuessInitData(0)}},t.prototype.getGuessInitData=function(t){return{isDeal:0,key:t,cost1:0,cost2:0,teamCost1:0,teamCost2:0}},t}();__reflect(UserManager.prototype,"UserManager");var DebugWXGameAD=function(){function t(){this.con=new eui.Rect}return t.prototype.createBannerAd=function(t,e,i){this.con.x=t,this.con.y=e,this.con.width=i,this.con.height=.35*i},t.prototype.hide=function(){MyTool.removeMC(this.con)},t.prototype.show=function(){GameManager.stage.addChild(this.con)},t.prototype.destroy=function(){this.hide()},t.prototype.offLoad=function(){},t.prototype.offError=function(){},t.prototype.setY=function(t){this.con.y=t},t}();__reflect(DebugWXGameAD.prototype,"DebugWXGameAD");var ADUI=function(){function t(){}return t.getADID=function(t){return this.adids[t]},Object.defineProperty(t,"isEnabled",{get:function(){return window.wx&&window.wx.createBannerAd?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){if(!t.isEnabled)return!1;try{var e=t.wx_banner_openids;if(e&&this.adindex)return e.indexOf(this.adindex)>=0}catch(i){}return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availWidth",{get:function(){return screen.availWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"availHeight",{get:function(){return screen.availHeight},enumerable:!0,configurable:!0}),t.prototype.getDefault=function(e,i){void 0===i&&(i=540),this.adindex=e;var n=this.adid=t.adids[e]||t.wx_bannerCode,a=this.availWidth/640;300>i*a&&(i=300/a);var r=GameManager.uiHeight-i/640*224;return{id:n,btnw:i,btnx:(640-i)/2,btny:r}},t.prototype.addBannerBg=function(){this.bannerAdBg=new DebugWXGameAD},t.prototype.initSameAD=function(e,i,n){if(this.adindex=e,this.parentUI=i,t.bannerAd&&void 0!=n){var a=screen.availHeight/GameManager.stage.stageHeight;t.bannerAd.style.top=a*n}},t.prototype.init=function(e,i){if(this.isEnabled){this.parentUI=e;var n=i.btnw,a=i.btnx,r=i.btny,o=this.availWidth/640,s=this.availHeight/GameManager.stage.stageHeight,h=o*a,c=s*r,l=o*n;this.style={left:Math.floor(h),top:Math.floor(c),width:Math.floor(l)},t.bannerAd||this.createAD(i.id,h,c,l),this.autoChange=i.autoChange,this.isUI=i.isUI}},t.prototype.startChange=function(){},t.prototype.hide=function(){if(t.bannerAd&&(this.bannerAdBg&&this.bannerAdBg.hide(),t.bannerAd.now==this.parentUI))try{t.bannerAd.hide()}catch(e){console.log("error:",e)}},t.prototype.createAD=function(e,i,n,a){var r=this.availWidth/640,o=this.availHeight/GameManager.stage.stageHeight;this.bannerAdBg&&this.bannerAdBg.createBannerAd(i/r,n/o,a/r),t.bannerAd=window.wx.createBannerAd({adUnitId:e,style:{left:Math.floor(i),top:Math.floor(n),width:Math.ceil(a)}}),this.initTime=Date.now()},t.prototype.show=function(e){if(void 0===e&&(e=!1),this.isEnabled&&((e||this.initTime&&Date.now()-this.initTime>1e3*(t.wx_refushAD_time||30))&&(this.destroy(),this.createAD(this.adid,this.style.left,this.style.top,this.style.width)),t.bannerAd&&(t.bannerAd.show(),this.bannerAdBg&&this.bannerAdBg.show(),this.startChange(),t.bannerAd.now=this.parentUI,this.isUI))){t.bannerAd.style.top=this.style.top}},t.prototype.destroy=function(){if(t.bannerAd){try{t.bannerAd.destroy()}catch(e){console.log("error2:",e)}t.bannerAd=null,this.bannerAdBg&&this.bannerAdBg.destroy()}},t.prototype.checkShow=function(e){var i=e.data;if(i===!0||i!=this.parentUI){if(!t.bannerAd)return;if(t.bannerAd.now!=this.parentUI)return;try{t.bannerAd.hide()}catch(e){}this.bannerAdBg&&this.bannerAdBg.hide()}},t.prototype.checkHide=function(e){if(this.parentUI){var i=this.parentUI.parent;if(this.parentUI.stage&&i.getChildIndex(this.parentUI)==i.numChildren-1){if(!t.bannerAd)return;t.bannerAd.show(),this.bannerAdBg&&this.bannerAdBg.show(),t.bannerAd.now!=this.parentUI&&(t.bannerAd.now=this.parentUI),this.isUI&&this.show()}}},t.adids={},t}();__reflect(ADUI.prototype,"ADUI");var ShareTool=function(){function t(){}return t.share=function(t,e,i,n){var a=window.wx;console.log(t),console.log(e),console.log(ObjectUtil.join(i)),a.shareAppMessage({title:t,imageUrl:e,query:ObjectUtil.join(i)})},t.openGDTV=function(t,e,i,n){if(window.wx.createRewardedVideoAd||MyWindow.Alert("暂不支持视频广告"),!window.wx.isPlayAD){window.wx.isPlayAD=!0;var a=ADUI.getADID(i),r=window.wx.createRewardedVideoAd({adUnitId:a});r.load().then(function(){return r.show()})["catch"](function(e){r.offClose(o),t&&t(),window.wx.isPlayAD=!1});var o=function(i){!i||i.isEnded?t&&t():e&&e(),r.offClose(o),window.wx.isPlayAD=!1};r.onClose(o)}},t.canOpenGDTV=function(t){return window.wx&&null!=window.wx.createRewardedVideoAd},t.SHARE_KEYS=["ACT_TYPE","FROM_SERVER","FROM_USER","ACT_ITEMID","ACT_MODE","CHANGE_S"],t}();__reflect(ShareTool.prototype,"ShareTool");var ArrayUtil=function(){function t(){}return t.sortByField=function(t,e,i){function n(t,n){if(null!=t&&null!=n)for(e=a.slice(),i=r.slice();e.length>0;){if(t[e[0]]<n[e[0]])return 0==i[0]||-1==i[0]?-1:1;if(t[e[0]]>n[e[0]])return 0==i[0]||-1==i[0]?1:-1;e.shift(),i.shift()}return 0}if(t&&e&&i&&e.length==i.length){var a=e.slice(),r=i.slice();t.sort(n)}return t},t.randomOne=function(t,e){void 0===e&&(e=!1);var i=Math.floor(t.length*Math.random()),n=t[i];return e&&t.splice(i,1),n},t.removeItem=function(t,e){var i=t.indexOf(e);return-1==i?!1:(t.splice(i,1),!0)},t.random=function(t,e){function i(){return Math.random()>.5?-1:1}for(void 0===e&&(e=1);e--;)t.sort(i)},t.disposeList=function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];i.parent&&i.parent.removeChild(i),i.dispose()}t=[]},t.indexOfByKey=function(t,e,i){if(t){for(var n=0;n<t.length;n++){var a=t[n];if(a[e]==i)return n}return-1}return-1},t.indexOf=function(t,e,i){for(var n=0;n<t.length;n++)if(i){if(t[n][i]==e)return n}else if(t[n]==e)return n;return-1},t}();__reflect(ArrayUtil.prototype,"ArrayUtil");var Base64=function(){function t(){}return t.encode=function(e){var i,n,a,r,o,s,h,c="",l=0;for(e=t._utf8_encode(e);l<e.length;)i=e.charCodeAt(l++),n=e.charCodeAt(l++),a=e.charCodeAt(l++),r=i>>2,o=(3&i)<<4|n>>4,s=(15&n)<<2|a>>6,h=63&a,isNaN(n)?s=h=64:isNaN(a)&&(h=64),c=c+t._keyStr.charAt(r)+t._keyStr.charAt(o)+t._keyStr.charAt(s)+t._keyStr.charAt(h);return c},t.decode=function(e){var i,n,a,r,o,s,h,c="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)r=t._keyStr.indexOf(e.charAt(l++)),o=t._keyStr.indexOf(e.charAt(l++)),s=t._keyStr.indexOf(e.charAt(l++)),h=t._keyStr.indexOf(e.charAt(l++)),i=r<<2|o>>4,n=(15&o)<<4|s>>2,a=(3&s)<<6|h,c+=String.fromCharCode(i),64!=s&&(c+=String.fromCharCode(n)),64!=h&&(c+=String.fromCharCode(a));return c=t._utf8_decode(c)},t._utf8_encode=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},t._utf8_decode=function(t){for(var e="",i=0,n=0,a=0,r=0;i<t.length;)n=t.charCodeAt(i),128>n?(e+=String.fromCharCode(n),i++):n>191&&224>n?(a=t.charCodeAt(i+1),e+=String.fromCharCode((31&n)<<6|63&a),i+=2):(a=t.charCodeAt(i+1),r=t.charCodeAt(i+2),e+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&r),i+=3);return e},t._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t}();__reflect(Base64.prototype,"Base64");var DateUtil=function(){function t(){}return t.isSameWeek=function(e,i){return 0==Boolean(i)&&(i=TimeManager.getInstance().now()),0==t.getWeekDec(e,i)},t.timeToChineseDate=function(t){var e=new Date(1e3*t);return e.setMinutes(e.getMinutes()+480+e.getTimezoneOffset()),e},t.isSameDay=function(e,i,n){void 0===n&&(n=-1);var a=t.offsetTime;-1!=n&&(a=n),0==Boolean(i)&&(i=TimeManager.getInstance().now()),e-=a,i-=a;var r=t.timeToChineseDate(e),o=t.timeToChineseDate(i);return r.getDate()==o.getDate()&&r.getMonth()==o.getMonth()&&r.getFullYear()==o.getFullYear()?!0:!1},t.getDayDes=function(e,i){var n=t.offsetTime;i&&(n=0);var a=e+n,r=TimeManager.getInstance().now()+n,o=t.timeToChineseDate(a),s=t.timeToChineseDate(r);return a>=r?t.datediff(o,s):-t.datediff(s,o)},t.isThisDate=function(e){e+=t.offsetTime;var i=t.timeToChineseDate(e),n=t.timeToChineseDate(TimeManager.getInstance().now());return i.getDate()==n.getDate()},t.isThisMonth=function(e){var i=t.timeToChineseDate(e),n=t.timeToChineseDate(TimeManager.getInstance().now());return i.getMonth()==n.getMonth()},t.getStringBySecond=function(t){0>t&&(t=0);var e=Math.floor(t/3600),i=Math.floor(t%3600/60),n=Math.floor(t%60),a="",r=""+e;r.length<2&&(r="0"+r),a+=r;var o="0"+i;o=o.substr(o.length-2,2),a+=":"+o;var s="0"+n;return s=s.substr(s.length-2,2),a+=":"+s},t.datediff=function(t,e){if(null==t||null==e)return 0;var i=8+(new Date).getTimezoneOffset()/60;return t.setHours(0-i),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),e.setHours(0-i),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),(t.getTime()-e.getTime())/864e5},t.getWeekDec=function(e,i){function n(t,e,i,n,a){t.setDate(e),t.setHours(i),t.setMinutes(n),t.setSeconds(a)}var a=Math.min(e,i),r=Math.max(e,i),o=t.timeToChineseDate(a),s=t.timeToChineseDate(r),h=8+(new Date).getTimezoneOffset()/60,c=(o.getDay()||7)-1;n(o,o.getDate()-c,-h,0,0);var c=(s.getDay()||7)-1;return n(s,s.getDate()-c,-h,0,0),(s.getTime()-o.getTime())/24/3600/1e3/7},t.getNextDateTimeByHours=function(t){var e=TimeManager.getInstance().now(),i=new Date(1e3*e),n=-480-i.getTimezoneOffset(),a=60*(t-i.getHours())+n,r=a;return 0>=a&&(r+=1440),-1440>=a&&(r+=1440),i.setMinutes(r),i.setSeconds(0),Math.floor(i.getTime()/1e3)},t.getNextChineseDateByHours=function(t,e){return e=e||TimeManager.getInstance().chineseDate(),e.getHours()>=t&&e.setDate(e.getDate()+1),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e},t.getStringBySeconds=function(e,i,n,a){0>e&&(e=0),i=i||!1,n=n||0,a=a||0;var r=e%60,o=Math.floor(e/60),s=Math.floor(o/1440),h=Math.floor(o/60)%24,c=o%60,l="";if(0!=s&&(l+=s+a+"天",i))return l;if(0!=h){if(l+=h+a+"小时",i)return l;if(2==n&&0!=s)return l}if(0!=c){if(i)return l+=c+a+"分钟";if(l+=c+a+"分",2==n&&0!=h)return l}if(0==s&&0==h||3==n){if(i&&1==n)return l=t.getStringBySecond(e),l.substr(-5);if(l+=r+"秒",i||3==n)return l;if(2==n&&0!=c)return l}return 0>r?"":l},t.getMonthWeek=function(t){var e=this.timeToChineseDate(t),i=e.getDay(),n=e.getDate();return Math.ceil((n+6-i)/7)},t.getStringByDate=function(t,e){if(1==e){var i=""+t.getFullYear(),n="0"+(t.getMonth()+1),a="0"+t.getDate();return i+"-"+n.substr(n.length-2,2)+"-"+a.substr(a.length-2,2)}var i="0"+t.getHours(),n="0"+t.getMinutes(),a="0"+t.getSeconds();return i.substr(i.length-2,2)+":"+n.substr(n.length-2,2)+":"+a.substr(a.length-2,2)},t.StringToDate=function(t){if(null==t||""==t)return new Date;var e=t.split(" ");if(2!=e.length)return new Date;var i=e[0].split("-");if(3!=i.length)return new Date;var n=e[1].split(":");if(3!=n.length)return new Date;var a=new Date(i[0],i[1]-1,i[2],n[0],n[1],n[2]);return a},t.getTimestampByChineseDate=function(e){var i=t.StringToDate(e),n=-480-i.getTimezoneOffset();return i.setMinutes(i.getMinutes()-n),Math.floor(i.getTime()/1e3)},t.formatDate=function(t,e){var i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in i)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return t},t.offsetTime=0,t}();__reflect(DateUtil.prototype,"DateUtil");var LoadingFile=function(){function t(){this.groupData={},this._loadingView=new LoadingUI}return t.getInstance=function(){return this.instance||(this.instance=new t),this.instance},t.prototype.loadGroup=function(t,e,i,n,a){this.loadtimer=egret.getTimer(),a=a||{},a.start=this.loadtimer,this.loadFiles=t,this.callBack=e,this.loadCount=t.length,this.callBack=e,this.callBackTarget=i,this.loadingData=a,this.loadingView=n||this._loadingView,this.loadingView.show(a),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),this.groupData={};for(var r=0;r<t.length;r++)this.groupData[t[r]]={current:0,total:RES.getGroupByName(t[r]).length},RES.loadGroup(t[r])},t.prototype.onResourceLoadComplete=function(t){if(-1!=this.loadFiles.indexOf(t.groupName)&&(this.loadCount--,0==this.loadCount)){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this);var e=egret.getTimer()-this.loadtimer;this.loadingData.min&&e<this.loadingData.min?egret.setTimeout(function(){this.loadingView.hide(),this.callBack.call(this.callBackTarget)},this,this.loadingData.min-e):(this.loadingView.hide(),this.callBack.call(this.callBackTarget))}},t.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load")},t.prototype.onResourceProgress=function(t){if(-1!=this.loadFiles.indexOf(t.groupName)){this.groupData[t.groupName].current=t.itemsLoaded;var e=0,i=0;for(var n in this.groupData)e+=this.groupData[n].current,i+=this.groupData[n].total;this.loadingView.setProgress(e,i)}},t}();__reflect(LoadingFile.prototype,"LoadingFile");var LoadingQueue=function(){function t(){this.loadCount=0,this.loaderList=[],this.loadReuslt=new Object}return t.prototype.load=function(t,e,i){this.loadFiles=t,this.callBack=e,this.callBack=e,this.callBackTarget=i,this.startLoad()},t.prototype.startLoad=function(){for(;this.loaderList.length<3&&this.loadCount<this.loadFiles.length;)this.loaderList.push(this.createLoader(this.loadFiles[this.loadCount])),this.loadCount++},t.prototype.createLoader=function(t){var e,i=new egret.URLLoader,n=t.substring(t.lastIndexOf(".")+1,t.length);switch(n){case"json":e=egret.URLLoaderDataFormat.TEXT;break;default:e=egret.URLLoaderDataFormat.TEXTURE}i.dataFormat=e,i.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var a=new egret.URLRequest(t);return i.load(a),i},t.prototype.onLoadComplete=function(t){var e=t.currentTarget,i=e._request.url,n=i.substring(i.lastIndexOf(".")+1,i.length);switch(n){case"json":this.loadReuslt[i]=JSON.parse(e.data);break;default:this.loadReuslt[i]=e.data}for(var a in this.loaderList)this.loaderList[a]==t.currentTarget&&this.loaderList[a].removeEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var r=ObjectUtil.objLength(this.loadReuslt);r==this.loadFiles.length?this.callBack.apply(this.callBackTarget,[this.loadReuslt]):this.startLoad()},t}();__reflect(LoadingQueue.prototype,"LoadingQueue");var md5=function(){function t(){this.hexcase=0,this.b64pad=""}return t.incode=function(e){return this.instance||(this.instance=new t),this.instance.hex_md5(e)},t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var n=Array(16),a=Array(16),r=0;16>r;r++)n[r]=909522486^i[r],a[r]=1549556828^i[r];var o=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(a.concat(o),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",a="",r=0;r<t.length;r++)i=t.charCodeAt(r),a+=n.charAt(i>>>4&15)+n.charAt(15&i);return a},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",a=t.length,r=0;a>r;r+=3)for(var o=t.charCodeAt(r)<<16|(a>r+1?t.charCodeAt(r+1)<<8:0)|(a>r+2?t.charCodeAt(r+2):0),s=0;4>s;s++)n+=8*r+6*s>8*t.length?this.b64pad:i.charAt(o>>>6*(3-s)&63);return n},t.prototype.rstr2any=function(t,e){var i,n,a,r,o,s=e.length,h=Array(Math.ceil(t.length/2));for(i=0;i<h.length;i++)h[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),l=Array(c);for(n=0;c>n;n++){for(o=Array(),r=0,i=0;i<h.length;i++)r=(r<<16)+h[i],a=Math.floor(r/s),r-=a*s,(o.length>0||a>0)&&(o[o.length]=a);l[n]=r,h=o}var u="";for(i=l.length-1;i>=0;i--)u+=e.charAt(l[i]);return u},t.prototype.str2rstr_utf8=function(t){for(var e,i,n="",a=-1;++a<t.length;)e=t.charCodeAt(a),i=a+1<t.length?t.charCodeAt(a+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),a++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.prototype.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.prototype.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,n=-271733879,a=-1732584194,r=271733878,o=0;o<t.length;o+=16){var s=i,h=n,c=a,l=r;i=this.md5_ff(i,n,a,r,t[o+0],7,-680876936),r=this.md5_ff(r,i,n,a,t[o+1],12,-389564586),a=this.md5_ff(a,r,i,n,t[o+2],17,606105819),n=this.md5_ff(n,a,r,i,t[o+3],22,-1044525330),i=this.md5_ff(i,n,a,r,t[o+4],7,-176418897),r=this.md5_ff(r,i,n,a,t[o+5],12,1200080426),a=this.md5_ff(a,r,i,n,t[o+6],17,-1473231341),n=this.md5_ff(n,a,r,i,t[o+7],22,-45705983),i=this.md5_ff(i,n,a,r,t[o+8],7,1770035416),r=this.md5_ff(r,i,n,a,t[o+9],12,-1958414417),a=this.md5_ff(a,r,i,n,t[o+10],17,-42063),n=this.md5_ff(n,a,r,i,t[o+11],22,-1990404162),i=this.md5_ff(i,n,a,r,t[o+12],7,1804603682),r=this.md5_ff(r,i,n,a,t[o+13],12,-40341101),a=this.md5_ff(a,r,i,n,t[o+14],17,-1502002290),n=this.md5_ff(n,a,r,i,t[o+15],22,1236535329),i=this.md5_gg(i,n,a,r,t[o+1],5,-165796510),r=this.md5_gg(r,i,n,a,t[o+6],9,-1069501632),a=this.md5_gg(a,r,i,n,t[o+11],14,643717713),n=this.md5_gg(n,a,r,i,t[o+0],20,-373897302),i=this.md5_gg(i,n,a,r,t[o+5],5,-701558691),r=this.md5_gg(r,i,n,a,t[o+10],9,38016083),a=this.md5_gg(a,r,i,n,t[o+15],14,-660478335),n=this.md5_gg(n,a,r,i,t[o+4],20,-405537848),i=this.md5_gg(i,n,a,r,t[o+9],5,568446438),r=this.md5_gg(r,i,n,a,t[o+14],9,-1019803690),a=this.md5_gg(a,r,i,n,t[o+3],14,-187363961),n=this.md5_gg(n,a,r,i,t[o+8],20,1163531501),i=this.md5_gg(i,n,a,r,t[o+13],5,-1444681467),r=this.md5_gg(r,i,n,a,t[o+2],9,-51403784),a=this.md5_gg(a,r,i,n,t[o+7],14,1735328473),n=this.md5_gg(n,a,r,i,t[o+12],20,-1926607734),i=this.md5_hh(i,n,a,r,t[o+5],4,-378558),r=this.md5_hh(r,i,n,a,t[o+8],11,-2022574463),a=this.md5_hh(a,r,i,n,t[o+11],16,1839030562),n=this.md5_hh(n,a,r,i,t[o+14],23,-35309556),i=this.md5_hh(i,n,a,r,t[o+1],4,-1530992060),r=this.md5_hh(r,i,n,a,t[o+4],11,1272893353),a=this.md5_hh(a,r,i,n,t[o+7],16,-155497632),n=this.md5_hh(n,a,r,i,t[o+10],23,-1094730640),i=this.md5_hh(i,n,a,r,t[o+13],4,681279174),r=this.md5_hh(r,i,n,a,t[o+0],11,-358537222),a=this.md5_hh(a,r,i,n,t[o+3],16,-722521979),n=this.md5_hh(n,a,r,i,t[o+6],23,76029189),i=this.md5_hh(i,n,a,r,t[o+9],4,-640364487),r=this.md5_hh(r,i,n,a,t[o+12],11,-421815835),a=this.md5_hh(a,r,i,n,t[o+15],16,530742520),n=this.md5_hh(n,a,r,i,t[o+2],23,-995338651),i=this.md5_ii(i,n,a,r,t[o+0],6,-198630844),r=this.md5_ii(r,i,n,a,t[o+7],10,1126891415),a=this.md5_ii(a,r,i,n,t[o+14],15,-1416354905),n=this.md5_ii(n,a,r,i,t[o+5],21,-57434055),i=this.md5_ii(i,n,a,r,t[o+12],6,1700485571),r=this.md5_ii(r,i,n,a,t[o+3],10,-1894986606),a=this.md5_ii(a,r,i,n,t[o+10],15,-1051523),n=this.md5_ii(n,a,r,i,t[o+1],21,-2054922799),i=this.md5_ii(i,n,a,r,t[o+8],6,1873313359),r=this.md5_ii(r,i,n,a,t[o+15],10,-30611744),a=this.md5_ii(a,r,i,n,t[o+6],15,-1560198380),n=this.md5_ii(n,a,r,i,t[o+13],21,1309151649),i=this.md5_ii(i,n,a,r,t[o+4],6,-145523070),r=this.md5_ii(r,i,n,a,t[o+11],10,-1120210379),a=this.md5_ii(a,r,i,n,t[o+2],15,718787259),n=this.md5_ii(n,a,r,i,t[o+9],21,-343485551),i=this.safe_add(i,s),n=this.safe_add(n,h),a=this.safe_add(a,c),r=this.safe_add(r,l)}return[i,n,a,r]},t.prototype.md5_cmn=function(t,e,i,n,a,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,r)),a),i)},t.prototype.md5_ff=function(t,e,i,n,a,r,o){return this.md5_cmn(e&i|~e&n,t,e,a,r,o)},t.prototype.md5_gg=function(t,e,i,n,a,r,o){return this.md5_cmn(e&n|i&~n,t,e,a,r,o)},t.prototype.md5_hh=function(t,e,i,n,a,r,o){return this.md5_cmn(e^i^n,t,e,a,r,o)},t.prototype.md5_ii=function(t,e,i,n,a,r,o){return this.md5_cmn(i^(e|~n),t,e,a,r,o)},t.prototype.safe_add=function(t,e){var i=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(i>>16);return n<<16|65535&i},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();__reflect(md5.prototype,"md5");var NumberUtil=function(){function t(){}return t.addNumSeparator=function(t,e){void 0===e&&(e=0);var i=String(t),n="";for(i.length<=3&&(n=i);i.length>3;)n=""==n?i.substr(-3):i.substr(-3)+","+n,i=i.substr(0,i.length-3),i.length<=3&&(n=i+","+n);if(e>0){var a=n.split(",");if(a.length>e){var r=a.length-e;a.length=e,n=a.join(",")+["K","M","G","T"][r-1]}}return n},t.numberWithCommas=function(t){if(t>=1e4)return t/1e4+"万";var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e.join(".")},t.formatStrNum=function(t){if(1e4>t)return""+t;for(var e,i=["K","M","G","T"],n=0;n<i.length;n++)if(e=t/Math.pow(1e3,n+1),1e3>e)return Math.floor(100*e)/100+i[n];return"999.9T+"
},t}();__reflect(NumberUtil.prototype,"NumberUtil");var ObjectUtil=function(){function t(){}return t.join=function(t,e){void 0===e&&(e="&");var i=[];for(var n in t)i.push(n+"="+t[n]);return i.join(e)},t.arrayToObj=function(t,e,i){e=e||"key",i=i||"value";var n={};for(var a in t){var r=t[a];"@whole"==i?n[r[e]]=r:n[r[e]]=r[i]}return n},t.objToArray=function(t){var e=[];for(var i in t)e.push(t[i]);return e},t.objLength=function(t,e){var i=0;for(var n in t)(!e||t[n])&&i++;return i},t.clone=function(t){return JSON.parse(JSON.stringify(t))},t.addClickEvent=function(t,e,i){if(t){var n,a,r=function(e){n=e.stageX,a=e.stageY,t.addEventListener(egret.TouchEvent.TOUCH_END,o,i)},o=function(r){t.removeEventListener(egret.TouchEvent.TOUCH_END,o,i);var s,h;s=r.stageX,h=r.stageY,Math.abs(h-a)>10||Math.abs(s-n)>10||e&&e.apply(i,[r])};t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,r,i),t.clickFun_touchBegin=r,t.clickFun_touchEnd=o}},t.removeClickEvent=function(t,e,i){t&&(t.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,t.clickFun_touchBegin,i),t.removeEventListener(egret.TouchEvent.TOUCH_END,t.clickFun_touchEnd,i))},t.swapKey=function(t,e,i){var n=t[e];t[e]=t[i],t[i]=n},t}();__reflect(ObjectUtil.prototype,"ObjectUtil");var PopUpManager=function(){function t(){}return t.movieChange=function(t,e,i){this.removeShape(),e.x=640*i,t.visible=!0,e.visible=!0,egret.Tween.removeTweens(t),egret.Tween.removeTweens(e);var n=egret.Tween.get(t);n.to({x:640*-i},300).call(function(){t.hide()},this);var n=egret.Tween.get(e);n.to({x:0},300)},t.removeShape=function(){MyTool.removeMC(this.shape)},t.addPopUp=function(t,e,i){function n(){t.removeEventListener(egret.Event.ENTER_FRAME,n,this);var e=(r-t.width)/2,s=(o-t.height)/2,h=(r-1.1*t.width)/2,c=(o-1.1*t.height)/2;if(t.alpha=1,t.visible=!0,i||a)t.scaleX=1,t.scaleY=1,t.x=e,t.y=s;else{t.alpha=0,t.scaleX=.6,t.scaleY=.6,t.x=(r-.6*t.width)/2,t.y=(o-.6*t.height)/2;var l=egret.Tween.get(t);l.to({alpha:1,scaleX:1.1,scaleY:1.1,x:h,y:c},150).to({scaleX:1,scaleY:1,x:e,y:s},150).call(function(){t.showFinish&&t.showFinish()})}}var a=t.stage&&t.visible,r=GameManager.container.width,o=GameManager.container.height;this.shape||(this.shape=new eui.Rect,this.shape.width=640,this.shape.fillColor=0,this.shape.fillAlpha=.8,this.shape.top=0,this.shape.bottom=0,this.shape.touchEnabled=!0,this.shape.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this));var s=this.shape;GameManager.container.addChild(s),GameManager.container.addChild(t),this.testVisible(),e&&(a||(t.alpha=0),t.addEventListener(egret.Event.ENTER_FRAME,n,this))},t.setMiddle=function(t){var e=GameManager.container.width,i=GameManager.container.height,n=(e-t.width)/2,a=(i-t.height)/2;t.x=n,t.y=a},t.onTap=function(){var t=this.shape.parent.getChildAt(this.shape.parent.numChildren-1);t.canBGClose&&t.hide()},t.removePopUp=function(t){if(t.parent){t.parent.getChildIndex(t);t.parent.removeChild(t),this.testShape(),this.testVisible()}},t.testShape=function(t){if(this.shape.parent||t){MyTool.removeMC(this.shape);for(var e=GameManager.container.numChildren-1;e>=0;e--){var i=GameManager.container.getChildAt(e);if(i instanceof game.BaseWindow)return void GameManager.container.addChildAt(this.shape,e)}}},t.testVisible=function(){for(var t=!1,e=GameManager.container.numChildren-1;e>=0;e--){var i=GameManager.container.getChildAt(e);if(i instanceof game.BaseUI){var n=i.visible;t?i.visible=!1:(i.visible=!0,!i.isWindow&&i.hideBehind&&(t=!0)),n!=i.visible&&i.onVisibleChange()}}},t.showToMain=function(){for(;;)for(var t=GameManager.container.numChildren-1;t>=0;t--){var e=GameManager.container.getChildAt(t);if(e instanceof game.BaseUI){e.hide();break}}},t.hideAll=function(){for(;;){for(var t=!1,e=GameManager.container.numChildren-1;e>=0;e--){var i=GameManager.container.getChildAt(e);if(i instanceof game.BaseUI){t=!0,i.hide();break}}if(!t)return}},t}();__reflect(PopUpManager.prototype,"PopUpManager");var StringUtil=function(){function t(){}return t.getString=function(t,e,i){if(void 0===i&&(i=!0),t&&e){var n=new eui.Label;n.size=e.size;var a=e.width;if(n.text=t,n.textWidth>a){n.text="";for(var r=0,o=t.length;o>r;r++){var s=t.substr(r,1);if(n.appendText(s),n.textWidth>a)return 0==i?t.substr(0,r):r>=2?t.substr(0,r-2)+"...":t}}}return t},t.getStringLength=function(t){return t.replace(/[^\x00-\xff]/g,"aa").length},t.getStringByLength=function(e,i){i=2*i;for(var n=1;n<=e.length;n++){var a=e.substr(0,n);if(t.getStringLength(a)>i)return e.substr(0,n-1)}return e},t.numToStr=function(t){return["零","一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十","二十一","二十二","二十三","二十四","二十五","二十六","二十七","二十八","二十九","三十","三十一","三十二","三十三","三十四","三十五","三十六","三十七","三十八","三十九","四十","四十一","四十二","四十三","四十四","四十五","四十六","四十七","四十八","四十九","五十","五十一","五十二","五十三","五十四","五十五","五十六","五十七","五十八","五十九","六十","六十一","六十二","六十三","六十四","六十五","六十六","六十七","六十八","六十九"][t]||t},t}();__reflect(StringUtil.prototype,"StringUtil"),window.Main=Main;